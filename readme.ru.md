## Документация для phpMussel (Русский)

### Содержание
- 1. [ПРЕДИСЛОВИЕ](#SECTION1)
- 2. [ИНСТАЛЛЯЦИЯ](#SECTION2)
- 3. [ИСПОЛЬЗОВАНИЕ](#SECTION3)
- 4. [УПРАВЛЕНИЕ ФРОНТЕНД](#SECTION4)
- 5. [CLI (СПОСОБ КОМАНДНЫХ СТРОК)](#SECTION5)
- 6. [СОДЕРЖАНИЕ ПАКЕТА ФАЙЛОВ](#SECTION6)
- 7. [НАСТРОЙКИ](#SECTION7)
- 8. [ФОРМАТ СИГНАТУРЕЙ](#SECTION8)
- 9. [ИЗВЕСТНЫЕ ПРОБЛЕМЫ СОВМЕСТИМОСТИ](#SECTION9)
- 10. [ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ (FAQ)](#SECTION10)
- 11. [ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ](#SECTION11)

*Примечание по поводу переводов: В случае ошибок (например, расхождения между переводами, опечаток, и т.д.), Английская версия README считается оригиналом и официальной версией. Если Вы обнаружите какие-либо ошибки, ваша помощь в исправлении их будет приветствоваться.*

---


### 1. <a name="SECTION1"></a>ПРЕДИСЛОВИЕ

Большое спасибо всем, кто пользуется данным phpMussel-пособием. PHP-руководство позволяет обнаружить вирусы, троянские кони и другие вредоносные программы, проникающие в ваш компьютер, имеющие код ClamAV и другие.

[PHPMUSSEL](https://phpmussel.github.io/) авторское право 2013 года, а также GNU/GPLv2, созданный [Caleb M (Maikuolan)](https://github.com/Maikuolan).

Это руководство находится в свободном доступе. Вы можете его передавать и/или модифицировать на условиях GNU General Public License, как публикует Фонд свободного программного обеспечения (Free Software Foundation); либо под второй версией лицензии, либо любой другой более поздней версией (по вашему выбору). Пособие публикуется не в целях увеличения прибыли или создания себе рекламы, а лишь в надежде принести пользу, правда, без всякой гарантии. Подробности Вы можете узнать на странице GNU General Public License в разделе `LICENSE.txt`, а также на страницах:
- <https://www.gnu.org/licenses/>.
- <https://opensource.org/licenses/>.

За вдохновение по созданию этого руководства я говорю большое спасибо [ClamAV](https://www.clamav.net/). Также я благодарю всех, кто пользуется этим руководством. Без вас оно, вероятно, никогда не существовало бы или ценность его была бы не очень большой.

Также большую благодарность выражаю SourceForge, Bitbucket, и GitHub за созданные ими хостадреса проектов; Подписчикам [PhishTank](https://www.phishtank.com/), [NLNetLabs](https://nlnetlabs.nl/), [Malware.Expert](https://malware.expert/) и другим. Особая благодарность тем, кто поддержит этот проект, а также всем неназванным мною людям, в том чисте и Вам за то, что пользуетесь этим пособием.

Этот документ с относящимися к нему пакетом файлов можно бесплатно скачать на страницах:
- [GitHub](https://github.com/phpMussel/phpMussel).
- [Bitbucket](https://bitbucket.org/Maikuolan/phpmussel).
- [SourceForge](https://sourceforge.net/projects/phpmussel/).

---


### 2. <a name="SECTION2"></a>ИНСТАЛЛЯЦИЯ

#### 2.0 ИНСТАЛЛЯЦИЯ ВРУЧНУЮ (СЕРВЕР)

1) Скачайте архив на свой компьютер и откройте его. На хост-компьютере или в системе управления содержимым (CMS) создайте регистр, куда Вы хотите загрузить содержимое этого пакета. Такой регистр, как `/public_html/phpmussel/`, будет вполне достаточным, пока он отвечает вашим требованиям к защите или личным предпочтениям.

2) Переименовать `config.ini.RenameMe` в `config.ini` (расположенный внутри `vault`), и если Вы хотите (рекомендуются для опытных пользователей, имеющих соответствующие знания), открой это (этот файл содержит все параметры конфигурации для phpMussel; краткие комментарии описывают задачи каждой параметры). Измените величины в соответствии с Вашими потребностями. Сохраните файл и закройте.

3) Скачайте всё содержимое (phpMussel и файлы) в указанный в пункте 1 регистр, кроме файлов `*.txt`/`*.md`.

4) Право доступа `vault`-регистра поменяйте на «755» (если есть проблемы, Вы можете попробовать «777»; это менее безопасно, хотя). Права доступа вышестоящего папка, в котором находится содержание (папка в который Вы наметили занести файлы) могут остаться прежними, но всё же лучше проверить доступ, если случились проблемы с доступом (обычно должно быть «755» в стандарта). Вкратце: Чтобы пакет работал правильно, PHP должен иметь возможность читать и писать файлы в каталоге `vault`. Многие вещи (обновление, ведение журнала, и т.д.) не будут возможны, если PHP не может писать в каталог `vault`, и пакет не будет работать вообще, если PHP не может читать из каталога `vault`. Однако для обеспечения оптимальной безопасности каталог `vault` НЕ должен быть общедоступным (конфиденциальная информация, такая как информация, содержащаяся в файле `config.ini` или `frontend.dat`, может быть обнаружена потенциальными злоумышленниками, если каталог `vault` является общедоступным).

5) Установите любые сигнатуры, которые вам понадобятся. *Видеть: [ИНСТАЛЛЯЦИЯ СИГНАТУРЕЙ](#INSTALLING_SIGNATURES).*

6) Скрепите phpMussel с Вашей системой или с системой управления содержимым (CMS). Для этого есть много способов. Самым простым является способ, когда phpMussel-руководство является началом главного файла, который будет загружаться всякий раз, когда будут заходить на ваш интернет-сайт. Этот файл нужно связать с Вашей системой или с системой управления содержимым (CMS) при помощи `require` или `include` команд. Обычно такой файл обозначается в регистре как `/includes`, `/assets` или `/functions`, и часто называется `init.php`, `common_functions.php`, `functions.php`. Вы должны найти тот файл, который соответствует Вашим требованиям. Если это трудно для Вас, то посетите форумы phpMussel или страница вопросов phpMussel на GitHub. Возможно я или кто-то другой уже имеет опыт работы с CMS, которую используете вы, и сможет дать Вам совет (обязательно сообщите, какой CMS Вы пользуетесь). Введите прямо в начало этого файла следующий код:

`<?php require '/user_name/public_html/phpmussel/loader.php'; ?>`

Строку между кавычками замените локальным путём файла в формате `loader.php`, без HTTP-адреса (подобно пути для `vault`-регистра). Сохраните файл и закройте его; Загрузите его заново.

-- АЛЬТЕРНАТИВА --

Если у Вас Apache HTTP-сервер и доступ к нему в формате `php.ini` или похожем формате, Вы можете воспользоваться `auto_prepend_file`-директивой, установя приоритет phpMussel, когда последует PHP-запрос. Примерно так:

`auto_prepend_file = "/user_name/public_html/phpmussel/loader.php"`

Или в `.htaccess` файлом:

`php_value auto_prepend_file "/user_name/public_html/phpmussel/loader.php"`

7) На этом инсталляционный процесс заканчивается. Теперь Вам необходимо протестировать программу на правильность функционирования. Для этого Вам нужно имеющиеся в пакете тестовые файлы `_testfiles` загрузить на Вашу веб-страницу любым способом, который позволяет Ваш браузер. (Убедитесь, что вы включили файлы сигнатуры `phpmussel*.*db` в директиву конфигурации `active` для запуска тестовых файлов). При нормальном функционировании программы появится сообщение от phpMussel, что загрузка/уплоад была успешно блокирована. Если такое сообщение не появилось, то программа функционирует неправильно. Воспользуйтесь другими расширенными функциями или всевозможными сканированными видами этой программы. Вы должны тестировать до тех пор, пока не убедитесь в нормальном функционировании программы.

#### 2.1 ИНСТАЛЛЯЦИЯ ВРУЧНУЮ (CLI; СПОСОБ КОМАНДНЫХ СТРОК)

1) Скачайте архив на свой компьютер, поместив его в регистр, соответствующего Вашим требованиям к защите или личным предпочтениям. Откройте папку.

2) Чтобы действовать, phpMussel нужна PHP-среда. В случае, если Вы не имеете PHP, то инсталлируте её, пожалуйста, следуя указаниям PHP-инсталлятора.

3) Дополнительные опции (рекомендуются для опытных пользователей, имеющих соответствующие знания). Откройте файл `config.ini` в `vault`-регистре. Этот файл содержит все функциональные опции phpMussel. Краткие комментарии описывают задачи каждой опции. Измените величины в соответствии с Вашими потребностями. Сохраните файл и закройте.

4) Дополнительные опции. Старт phpMussel можно упростить, если вместе с файлом пакетной обработки PHP автоматически загрузить и phpMussel. Откройте простую программу обработки текста, такую как Editor или Notepad++. Внесите полный путь доступа к Вашему `php.exe`-файлу в регистр PHP-инсталлятора. Потом сделайте пробел. За ним = полный путь к `loader.php`-файлу в регистре phpMussel-инсталлятора. Внесите этот файл в память компьютера в формате `.bat` в то место, где Вы всегда сможете его легко найти и открыть двойным щелчком мышки.

5) Установите любые сигнатуры, которые вам понадобятся. *Видеть: [ИНСТАЛЛЯЦИЯ СИГНАТУРЕЙ](#INSTALLING_SIGNATURES).*

6) На этом процесс инсталляции завершён. Теперь Вам нужно проверить как работает программа. Для тестирования запустите phpMussel и попытайтесь просканировать `_testfiles`-регистр, содержащийся в инсталляционном пакете.

#### 2.2 ИНСТАЛЛЯЦИЯ С ПОМОЩЬЮ COMPOSER

[phpMussel зарегистрирован в Packagist](https://packagist.org/packages/phpmussel/phpmussel), и так, если Вы знакомы с Composer, Вы можете использовать Composer для инсталляция phpMussel (Вам все равно нужно будет подготовить конфигурацию, разрешения, сигнатуры и крючки; См. «инсталляция вручную (сервер)», шаги 2, 4, 5, и 6).

`composer require phpmussel/phpmussel`

#### <a name="INSTALLING_SIGNATURES"></a>2.3 ИНСТАЛЛЯЦИЯ СИГНАТУРЕЙ

Поскольку v1.0.0, сигнатуры не включены в пакет phpMussel. Сигнатуры требуются phpMussel для обнаружения конкретных угроз. Существует три основных метода установки сигнатурей:

1. Установите автоматически, используя страницу обновления в фронтенд.
2. Создавайте сигнатуры с помощью «SigTool» и установите вручную.
3. Загрузите сигнатуры из «phpMussel/Signatures» и установите вручную.

##### 2.3.1 Установите автоматически, используя страницу обновления в фронтенд.

В первую очередь, вам нужно убедиться, что фронтенд включен. *Видеть: [УПРАВЛЕНИЕ ФРОНТЕНД](#SECTION4).*

Затем все, что вам нужно сделать, это перейти на страницу обновлений фронтенд, найти необходимые файлы сигнатур и использовать параметры, представленные на странице, установить их и активировать их.

##### 2.3.2 Создавайте сигнатуры с помощью «SigTool» и установите вручную.

*Видеть: [Документация SigTool](https://github.com/phpMussel/SigTool#documentation).*

##### 2.3.3 Загрузите сигнатуры из «phpMussel/Signatures» и установите вручную.

В первую очередь, перейти к [phpMussel/Signatures](https://github.com/phpMussel/Signatures). Репозиторий содержит различные файлы сигнатур, сжатые GZ. Загрузите нужные вам файлы, распакуйте их и скопируйте распакованные файлы в регистр `/vault/signatures`, чтобы установить их. Перечислите имена скопированных файлов в директиву `active` в вашей конфигурации phpMussel для их активации.

---


### 3. <a name="SECTION3"></a>ИСПОЛЬЗОВАНИЕ

#### 3.0 ИСПОЛЬЗОВАНИЕ (СЕРВЕР)

phpMussel функционирует полностью в автономном режиме, то есть, Вам вообще ничего не надо делать. Ваша задача: инсталлировать программу, а работать она будет сама.

Сканирование файлов загрузки унифицировано и запускается автоматически. Вам больше ничего не нужно делать.

Тем не менее у вас есть возможность отдать распоряжение phpmussel сканировать файлы, папки или архивы, указанные вами конкретно. для этого убедитесь, что данная структура имеет формат `config.ini` (`cleanup` должен быть деактивирован), создайте PHP-файл, интегрированный в phpmussel, со следующей функцией:

`$phpMussel['Scan']($what_to_scan, $output_type, $output_flatness);`

- `$what_to_scan` является строкой или матрицей, указывающей на файл, регистр или матрицу файлов и/или регистров, которые подлежат сканированию.
- `$output_type` это целое число (Integer), указывающее на формат, который должен получиться в результате. Нулевое значение задаёт функцию выдать результат в виде целого числа (Integer). Единица задает функцию, выдать результат в форме читаемого текста. Двойка задаёт функцию получения результата в двух видах: в виде читаемого текста, и экспорт в глобальную переменную. Глобальная переменная является необязательной, её стандартная величина 0. Ниже описываются целочисленные результаты:

| Результаты | Описание |
|---|---|
| -4 | Указывает на то, что данные не могут быть отсканированы из-за шифрования. |
| -3 | Указывает на то, что имеются проблемы с файлом сигнатуры phpMussel. |
| -2 | Показывает, что повреждённые файлы найдены, но сканирование не закончено. |
| -1 | Означает, что для сканирования необходимы отсутствующие PHP-расширения или дополнения, поэтому сканирование не завершено. |
| 0 | Говорит о том, что цель не существует, а следовательно не может быть и проверена. |
| 1 | Означает, что цель успешно проверена и проблем не найдено. |
| 2 | Цель успешно проверена, но имеются проблемы. |

- `$output_flatness` это логическое значение, требующее выдать результат в виде дополнения или строки. Если цель состоит из нескольких элементов как, например, регистры или матрицы, то результатом операции будет матрица (со стандартным числом 0). Единица вызывает функцию, результатом которой будет сцепленная строка. Эта переменная является необязательной, её стандартная величина 0.

Например:

```PHP
 $results = $phpMussel['Scan']('/user_name/public_html/my_file.html', true, true);
 echo $results;
```

А вот как это выглядит в виде строки:

```
 Wed, 16 Sep 2013 02:49:46 +0000 Начало работы.
 > Проверить '/user_name/public_html/my_file.html':
 -> Проблемы не найдены.
 Wed, 16 Sep 2013 02:49:47 +0000 Готово.
```

Полный список используемых phpMussel сигнатурей, а также порядок их обработки, Вы найдёте в разделе [ФОРМАТ СИГНАТУРЕЙ](#SECTION8).

При возникновении каких-либо тревожных сигналов, при обнаружении того, что по Вашему мнению должно быть заблокировано, или что-то не функционирует с подписями, просьба сообщить об этом автору, дабы можно было внести изменения и исправить ситуацию. *(Видеть: [Что такое «ложноположительный»?](#WHAT_IS_A_FALSE_POSITIVE)).*

Чтобы отключить определенные сигнатуры, включенные в phpMussel (например, если Вы испытываете ложноположительный, что для ваших целей обычно не следует удалять с магистрали), добавьте имена конкретной сигнатуры, подлежащей отключению, в файл «greylist» сигнатурей (`/vault/greylist.csv`), разделенных запятыми.

*Смотрите также: [Как получить доступ к конкретным сведениям о файлах при их сканировании?](#SCAN_DEBUGGING)*

#### 3.1 ИСПОЛЬЗОВАНИЕ (CLI; СПОСОБ КОМАНДНЫХ СТРОК)

Пожалуйста, обратитесь к разделу «ИНСТАЛЛЯЦИЯ ВРУЧНУЮ (CLI; СПОСОБ КОМАНДНЫХ СТРОК)» этого файла README.

Кроме того необходимо иметь ввиду, что phpMussel является сканер *по требованию*; Это *НЕ* сканер *по доступу* (кроме как для загрузки файлов, в момент загрузки); Это не может заменить полноценное антивирусное программное обеспечение (это не проверяет рабочую память компьютера)! Это будет только обнаружить вирусы, содержащиеся на загрузки файлов, и на конкретные файлы которые Вы сказать что это для сканирования.

---


### 4. <a name="SECTION4"></a>УПРАВЛЕНИЕ ФРОНТЕНД

#### 4.0 ЧТО ЯВЛЯЕТСЯ ФРОНТЕНД.

Фронтенд обеспечивает удобный и простой способ для поддержания, управления и обновить инсталляция phpMussel. Вы можете просматривать, обмениваться и скачать лог-файлы через страницу для лог-файлы, Вы можете изменить конфигурацию с помощью страницы конфигурации, Вы можете устанавливать и удалять компоненты через страницу обновления, и вы можете загрузить, скачать, и изменять файлы в вашем vault с помощью файл менеджер.

Фронтенд по умолчанию отключена в целях предотвращения несанкционированного доступа (несанкционированного доступа может иметь серьезные последствия для вашего веб-сайта и его безопасности). Инструкции по включению его включены ниже этого пункта.

#### 4.1 КАК ВКЛЮЧИТЬ ФРОНТЕНД.

1) Найдите директиву `disable_frontend` внутри `config.ini`, и установить его на `false` (это будет `true` по умолчанию).

2) Перейти на `loader.php` из вашего браузера (например, `http://localhost/phpmussel/loader.php`).

3) Войти с именем пользователя и паролем по умолчанию (admin/password).

Заметка: После того, как Вы вошли в первый раз, в целях предотвращения несанкционированного доступа к фронтенд, Вы должны немедленно изменить имя пользователя и пароль! Это очень важно, потому что это можно загрузить произвольный PHP код на свой веб-сайт через фронтенд.

Кроме того, для обеспечения оптимальной безопасности настоятельно рекомендуется включить «двухфакторную аутентификацию» для всех учетных записей фронтенд (инструкции приведены ниже).

#### 4.2 КАК ИСПОЛЬЗОВАТЬ ФРОНТЕНД.

Инструкции предоставляются на каждой странице в фронтенд, чтобы объяснить правильный способ использовать его и его целевое назначение. Если Вам нужна дополнительная объяснение или любой специальный помощь, обратитесь в поддержки. Дополнительно, есть некоторые видео доступны на YouTube, которые могли бы помочь путем демонстрации.

#### 4.3 ДВУХФАКТОРНАЯ АУТЕНТИФИКАЦИЯ

Возможно сделать фронтенд более безопасным, включив двухфакторную аутентификацию («2FA»). При входе в учетную запись с поддержкой 2FA, электронное письмо отправляется на адрес электронной почты, связанный с этой учетной записью. Это электронное письмо содержит «код 2FA», который затем должен ввести пользователь в дополнение к имени пользователя и паролю, чтобы иметь возможность войти в систему, используя эту учетную запись. Это означает, что получить пароль учетной записи будет недостаточно для того, чтобы любой хакер или потенциальный злоумышленник могли войти в эту учетную запись, потому что им также необходимо будет иметь доступ к адресу электронной почты, связанному с этой учетной записью, чтобы иметь возможность получать и использовать код 2FA, связанный с сеансом, что делает фронтенд более безопасным.

Во-первых, чтобы включить двухфакторную аутентификацию, используя страницу обновлений фронтенда, установите компонент PHPMailer. phpMussel использует PHPMailer для отправки электронных писем. Следует отметить, что хотя phpMussel, сам по себе, совместим с PHP >= 5.4.0, PHPMailer требует PHP >= 5.5.0, поэтому означает, что включение двухфакторной аутентификации для фронтенда phpMussel будет невозможно для пользователей PHP 5.4.

После того, как Вы установили PHPMailer, вам нужно будет заполнить директивы конфигурации для PHPMailer через страницу конфигурации phpMussel или файл конфигурации. Более подробная информация об этих директивах конфигурации содержится в разделе конфигурации этого документа. После того, как Вы заполнили директивы конфигурации PHPMailer, установите `enable_two_factor` в `true`. На этом этапе должна быть включена двухфакторная аутентификация.

Затем вам нужно связать адрес электронной почты с учетной записью, чтобы phpMussel знал, куда отправлять коды 2FA при входе в эту учетную запись. Для этого используйте адрес электронной почты в качестве имени пользователя для учетной записи (например, `foo@bar.tld`), или указать адрес электронной почты как часть имени пользователя так же, как при отправке письма обычно (например, `Foo Bar <foo@bar.tld>`).

Заметка: Особенно важна защита вашего vault от несанкционированного доступа (например, посредством укрепления безопасности вашего сервера и ужесточение разрешений общего доступа), поскольку несанкционированный доступ к вашему конфигурационному файлу (который хранится в вашем vault), может подвергнуть риску выставлять исходящие настройки SMTP (это включает имя пользователя и пароль SMTP). Вы должны убедиться, что ваше vault правильно защищено, прежде чем включить двухфакторную аутентификацию. Если Вы не можете этого сделать, то, по крайней мере, Вы должны создать новую учетную запись электронной почты, предназначенную для этой цели, чтобы уменьшить риски, связанные с открытыми параметрами SMTP.

---


### 5. <a name="SECTION5"></a>CLI (СПОСОБ КОМАНДНЫХ СТРОК)

В Windows системах phpMussel может быть использована как интерактивный сканер в CLI-модусе. Для этого прочитайте раздел «ИНСТАЛЛЯЦИЯ (CLI; СПОСОБ КОМАНДНЫХ СТРОК)».

Для получения доступа к имеющимся в распоряжении CLI-командам, внесите в командную строку «с» (ANSI/ASCII) и подтвердите свою команду, нажав «Enter».

Дополнительно, для тех кто заинтересован, видео-учебник о том как использовать phpMussel в CLI-модусе доступна здесь:
- <https://youtu.be/H-Pa740-utc>

---


### 6. <a name="SECTION6"></a>СОДЕРЖАНИЕ ПАКЕТА ФАЙЛОВ

```
https://github.com/phpMussel/phpMussel>v2
│   .gitattributes
│   .gitignore
│   .travis.php
│   .travis.yml
│   Changelog-v2.txt
│   composer.json
│   CONTRIBUTING.md
│   crowdin.yml
│   LICENSE.txt
│   loader.php
│   PEOPLE.md
│   README.md
│   SECURITY.md
│   web.config
│
├───.github
│       ISSUE_TEMPLATE.md
│
├───vault
│   │   .htaccess
│   │   channels.yaml
│   │   cli.php
│   │   components.dat
│   │   config.ini.RenameMe
│   │   config.php
│   │   config.yaml
│   │   event_handlers.php
│   │   frontend.php
│   │   frontend_functions.php
│   │   functions.php
│   │   greylist.csv
│   │   lang.php
│   │   plugins.dat
│   │   shorthand.yaml
│   │   signatures.dat
│   │   template_custom.html
│   │   template_default.html
│   │   themes.dat
│   │   upload.php
│   │
│   ├───cache
│   ├───classes
│   │   │   ArchiveHandler.php
│   │   │   CompressionHandler.php
│   │   │   TemporaryFileHandler.php
│   │   │
│   │   └───Maikuolan
│   │           Cache.php
│   │           ComplexStringHandler.php
│   │           DelayedIO.php
│   │           Demojibakefier.php
│   │           Events.php
│   │           L10N.php
│   │           NumberFormatter.php
│   │           YAML.php
│   │
│   ├───fe_assets
│   │       frontend.css
│   │       frontend.html
│   │       icons.php
│   │       pips.php
│   │       scripts.js
│   │       _2fa.html
│   │       _accounts.html
│   │       _accounts_row.html
│   │       _cache.html
│   │       _config.html
│   │       _config_row.html
│   │       _files.html
│   │       _files_edit.html
│   │       _files_rename.html
│   │       _files_row.html
│   │       _home.html
│   │       _login.html
│   │       _logs.html
│   │       _nav_complete_access.html
│   │       _nav_logs_access_only.html
│   │       _quarantine.html
│   │       _quarantine_row.html
│   │       _siginfo.html
│   │       _siginfo_row.html
│   │       _statistics.html
│   │       _updates.html
│   │       _updates_row.html
│   │       _upload_test.html
│   │
│   ├───lang
│   │       lang.ar.fe.yaml
│   │       lang.ar.yaml
│   │       lang.bn.fe.yaml
│   │       lang.bn.yaml
│   │       lang.de.fe.yaml
│   │       lang.de.yaml
│   │       lang.en.fe.yaml
│   │       lang.en.yaml
│   │       lang.es.fe.yaml
│   │       lang.es.yaml
│   │       lang.fr.fe.yaml
│   │       lang.fr.yaml
│   │       lang.hi.fe.yaml
│   │       lang.hi.yaml
│   │       lang.id.fe.yaml
│   │       lang.id.yaml
│   │       lang.it.fe.yaml
│   │       lang.it.yaml
│   │       lang.ja.fe.yaml
│   │       lang.ja.yaml
│   │       lang.ko.fe.yaml
│   │       lang.ko.yaml
│   │       lang.lv.fe.yaml
│   │       lang.lv.yaml
│   │       lang.nl.fe.yaml
│   │       lang.nl.yaml
│   │       lang.no.fe.yaml
│   │       lang.no.yaml
│   │       lang.pl.fe.yaml
│   │       lang.pl.yaml
│   │       lang.pt.fe.yaml
│   │       lang.pt.yaml
│   │       lang.ru.fe.yaml
│   │       lang.ru.yaml
│   │       lang.sv.fe.yaml
│   │       lang.sv.yaml
│   │       lang.th.fe.yaml
│   │       lang.th.yaml
│   │       lang.tr.fe.yaml
│   │       lang.tr.yaml
│   │       lang.ur.fe.yaml
│   │       lang.ur.yaml
│   │       lang.vi.fe.yaml
│   │       lang.vi.yaml
│   │       lang.zh-tw.fe.yaml
│   │       lang.zh-tw.yaml
│   │       lang.zh.fe.yaml
│   │       lang.zh.yaml
│   │
│   ├───plugins
│   ├───quarantine
│   └───signatures
│           switch.dat
│
└───_testfiles
        ascii_standard_testfile.txt
        coex_testfile.rtf
        exe_standard_testfile.exe
        general_standard_testfile.txt
        graphics_standard_testfile.gif
        html_standard_testfile.html
        md5_testfile.txt
        ole_testfile.ole
        pdf_standard_testfile.pdf
        pe_sectional_testfile.exe
        swf_standard_testfile.swf
```

---


### 7. <a name="SECTION7"></a>НАСТРОЙКИ

Ниже представлен список переменных данных в файле конфигурации `config.ini`, а также краткое описание их функций.

```
Configuration (v2)
│
├───general
│       cleanup
│       scan_log
│       scan_log_serialized
│       scan_kills
│       error_log
│       truncate
│       log_rotation_limit
│       log_rotation_action
│       timezone
│       time_offset (v1: timeOffset)
│       time_format (v1: timeFormat)
│       ipaddr
│       enable_plugins
│       forbid_on_block
│       delete_on_sight
│       lang
│       lang_override
│       numbers
│       quarantine_key
│       quarantine_max_filesize
│       quarantine_max_usage
│       quarantine_max_files
│       honeypot_mode
│       scan_cache_expiry
│       disable_cli
│       disable_frontend
│       max_login_attempts
│       frontend_log (v1: FrontEndLog)
│       disable_webfonts
│       maintenance_mode
│       default_algo
│       statistics
│       disabled_channels
│
├───signatures
│       active (v1: Active)
│       fail_silently
│       fail_extensions_silently
│       detect_adware
│       detect_joke_hoax
│       detect_pua_pup
│       detect_packer_packed
│       detect_shell
│       detect_deface
│       detect_encryption
│
├───files
│       max_uploads
│       filesize_limit
│       filesize_response
│       filetype_whitelist
│       filetype_blacklist
│       filetype_greylist
│       check_archives
│       filesize_archives
│       filetype_archives
│       max_recursion
│       block_encrypted_archives
│       max_files_in_archives
│
├───attack_specific
│       chameleon_from_php
│       can_contain_php_file_extensions
│       chameleon_from_exe
│       chameleon_to_archive
│       chameleon_to_doc
│       chameleon_to_img
│       chameleon_to_pdf
│       archive_file_extensions
│       block_control_characters
│       corrupted_exe
│       decode_threshold
│       scannable_threshold
│       allow_leading_trailing_dots
│       block_macros
│
├───compatibility
│       ignore_upload_errors
│       only_allow_images
│
├───heuristic
│       threshold
│
├───virustotal
│       vt_public_api_key
│       vt_suspicion_level
│       vt_weighting
│       vt_quota_rate
│       vt_quota_time
│
├───urlscanner
│       lookup_hphosts
│       google_api_key
│       maximum_api_lookups
│       maximum_api_lookups_response
│       cache_time
│
├───legal
│       pseudonymise_ip_addresses
│       privacy_policy
│
├───template_data
│       theme
│       magnification (v1: Magnification)
│       css_url
│
├───PHPMailer
│       event_log (v1: EventLog)
│       skip_auth_process (v1: SkipAuthProcess)
│       enable_two_factor (v1: Enable2FA)
│       host (v1: Host)
│       port (v1: Port)
│       smtp_secure (v1: SMTPSecure)
│       smtp_auth (v1: SMTPAuth)
│       username (v1: Username)
│       password (v1: Password)
│       set_from_address (v1: setFromAddress)
│       set_from_name (v1: setFromName)
│       add_reply_to_address (v1: addReplyToAddress)
│       add_reply_to_name (v1: addReplyToName)
│
└───supplementary_cache_options
        enable_apcu
        enable_memcached
        enable_redis
        enable_pdo
        memcached_host
        memcached_port
        redis_host
        redis_port
        redis_timeout
        pdo_dsn
        pdo_username
        pdo_password
```

#### «general» (Категория)
Генеральная конфигурация от phpMussel.

##### «cleanup»
- После исполнения стирает переменные величины данного руководства и очищает кэш-память. Если Вы не используете скрипт для чего-либо, кроме сканирования загрузок, Вам следует установить значение `true`, чтобы минимизировать использование памяти. В противном случае Вам следует установить значение `false`, чтобы сохранить в памяти данные, необходимые для выполнения phpMussel без необходимости его перезагрузки.
- Не воздействует на CLI-модус.

##### «scan_log»
- Название файла, в который записываются результаты всех контрольных проверок. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «scan_log_serialized»
- Название файла, в который записываются результаты всех контрольных проверок (сериализовано Формат). Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «scan_kills»
- Название файла, в который записываются все заблокированные загрузки. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

*Полезный совет: Если Вы хотите, Вы можете добавить информацию о дате/времени к именам файлов журналов путем включения их во имя: `{yyyy}` для полный год, `{yy}` для сокращенный год, `{mm}` для месяц, `{dd}` для день, `{hh}` для час.*

*Примеры:*
- *`scan_log='scan_log.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_log_serialized='scan_log_serialized.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_kills='scan_kills.{yyyy}-{mm}-{dd}-{hh}.txt'`*

##### «error_log»
- Файл для регистрации обнаруженных нефатальных ошибок. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «truncate»
- Усекать лог-файлы, когда они достигают определенного размера? Значение это максимальный размер в Б/КБ/МБ/ГБ/ТБ, до которого файл журнала может увеличиться до усечения. Стандартное значение 0КБ отключает усечение (лог-файлы может расти неограниченно). Примечание: относится к отдельным лог-файлы! Размер файлов журнала не учитывается совместно.

##### «log_rotation_limit»
- Лог вращения ограничивает количество журнальных лог-файлов, которые должны существовать в любой момент времени. Когда создаются новые лог-файлы, если общее количество лог-файлов превышает указанный предел, указанное действие будет выполнено. Здесь Вы можете указать желаемый лимит. Значение 0 отключит вращение лог.

##### «log_rotation_action»
- Лог вращения ограничивает количество журнальных лог-файлов, которые должны существовать в любой момент времени. Когда создаются новые лог-файлы, если общее количество лог-файлов превышает указанный предел, указанное действие будет выполнено. Здесь Вы можете указать желаемое действие. Delete = Удалите самые старые лог-файлы, пока лимит больше не будет превышен. Archive = Сначала архивируйте, а затем удалите самые старые лог-файлы, пока лимит больше не будет превышен.

*Техническое разъяснение: В этом контексте, «самые старые» означает наименее недавно измененный.*

##### «timezone»
- Это используется, чтобы указать, какой часового пояса phpMussel должен использовать для операций даты/времени. Если вам это не нужно, игнорируйте его. Возможные значения определяются PHP. Обычно рекомендуется вместо того, чтобы настроить директиву о зоне времени в файле `php.ini`, но иногда (например, при работе с общими хостинг-провайдеров, которые ограничены) это не всегда возможно, и так, эта опция представлена здесь.

##### «time_offset»
- *v1: «timeOffset»*
- Если ваш сервер времени не соответствует вашему местному времени, Вы можете указать смещение здесь для корректировки информации о дате/времени генерируется от phpMussel в соответствии с вашими потребностями. Обычно рекомендуется вместо того, чтобы настроить директиву о зоне времени в файле `php.ini`, но иногда (например, при работе с общими хостинг-провайдеров, которые ограничены) это не всегда возможно, и так, эта опция представлена здесь. Смещение описывается как минут.
- Пример (добавить один час): `time_offset=60`

##### «time_format»
- *v1: «timeFormat»*
- Формат нотации даты, используемый phpMussel. Стандарт = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

##### «ipaddr»
- Место IP-адреса актуального соединения в общем потоке данных (полезно для Cloud-сервиса). Стандарт = REMOTE_ADDR. Внимание! Изменяйте это значение только в том случае, если Вы уверены в своих действиях!

Рекомендуемые значения для «ipaddr»:

Значения | Контекст
---|---
`HTTP_INCAP_CLIENT_IP` | Incapsula обратный прокси-сервер.
`HTTP_CF_CONNECTING_IP` | Cloudflare обратный прокси-сервер.
`CF-Connecting-IP` | Cloudflare обратный прокси-сервер (альтернатива; если вышеуказанное не работает).
`HTTP_X_FORWARDED_FOR` | Cloudbric обратный прокси-сервер.
`X-Forwarded-For` | [Squid обратный прокси-сервер](http://www.squid-cache.org/Doc/config/forwarded_for/).
*Определяется конфигурацией сервера.* | [Nginx обратный прокси-сервер](https://www.nginx.com/resources/admin-guide/reverse-proxy/).
`REMOTE_ADDR` | Не обратный прокси-сервер (стандартное значение).

##### «enable_plugins»
- Включить поддержку phpMussel плагинов? False = Нет; True = Да [Стандарт].

##### «forbid_on_block»
- Возвращённый 403-HTTP-заголовок при заблокированной загрузке данных. False = Нет (200); True = Да (403) [Стандарт].

##### «delete_on_sight»
- Эта опция позволяет в течение сканирования немедленно удалять файлы при наличии в них опознавательных признаков, содержащихся в сигнатуры или других методах. При этом не будут затрагиваться файлы, идентифицированные как неинфицированные. Если в архиве будет инфицирован хотя бы один файл, то будет удалён весь архив. Во время загрузки файлов эту функцию активировать не обязательно, так как PHP после исполнения удаляет содержимое кэш-памяти. Это означает, что PHP удалит каждый скаченный через сервер файл, если он не перемещён, не скопирован или не удалён. Эта опция, как дополнительная мера, была введена для большей безопасности, но в основном для систем, в которых PHP ведёт себя по-другому. False = После проверки файл останется нетронутым [Стандарт]; True = После проверки инфицированный файл будет немедленно удалён.

##### «lang»
- Задаёт phpMussel стандарт языка.

##### «lang_override»
- Локализовать в соответствии с HTTP_ACCEPT_LANGUAGE, когда это возможно? True = Да [Стандарт]; False = Нет.

##### «numbers»
- Указывает, как отображать числа.

Поддерживаемые значения:

Значение | Производит | Описание
---|---|---
`NoSep-1` | `1234567.89`
`NoSep-2` | `1234567,89`
`Latin-1` | `1,234,567.89` | Значение по умолчанию.
`Latin-2` | `1 234 567.89`
`Latin-3` | `1.234.567,89`
`Latin-4` | `1 234 567,89`
`Latin-5` | `1,234,567·89`
`China-1` | `123,4567.89`
`India-1` | `12,34,567.89`
`India-2` | `१२,३४,५६७.८९`
`India-3` | `૧૨,૩૪,૫૬૭.૮૯`
`India-4` | `੧੨,੩੪,੫੬੭.੮੯`
`India-5` | `೧೨,೩೪,೫೬೭.೮೯`
`India-6` | `౧౨,౩౪,౫౬౭.౮౯`
`Arabic-1` | `١٢٣٤٥٦٧٫٨٩`
`Arabic-2` | `١٬٢٣٤٬٥٦٧٫٨٩`
`Arabic-3` | `۱٬۲۳۴٬۵۶۷٫۸۹`
`Arabic-4` | `۱۲٬۳۴٬۵۶۷٫۸۹`
`Bengali-1` | `১২,৩৪,৫৬৭.৮৯`
`Burmese-1` | `၁၂၃၄၅၆၇.၈၉`
`Khmer-1` | `១.២៣៤.៥៦៧,៨៩`
`Lao-1` | `໑໒໓໔໕໖໗.໘໙`
`Thai-1` | `๑,๒๓๔,๕๖๗.๘๙`
`Thai-2` | `๑๒๓๔๕๖๗.๘๙`

*Заметка: Эти значения нигде не стандартизируются и, вероятно, не будут иметь значения за пределами пакета. Кроме того, поддерживаемые значения могут измениться в будущем.*

##### «quarantine_key»
- phpMussel способна держать на карантине попытки загрузить файл, если это будет Вам нужно. Эту функцию должны деактивировать те пользователи, которые хотят лишь защитить свои интернет-сайты или окружение своего хоста, но дальнейший контроль выделенных файлов им не интересен. Активировать эту функцию должны те пользователи, которые хотят анализировать изолированные файлы на вредоносность или тому подобное. Изоляция выделенных файлов иногда может использоваться для поиска ошибки при частом появлении сигнала тревоги. Чтобы деактивировать функцию карантина, не заполняйте `quarantine_key`, и удалите содержание строки, если она заполнена. Для активирования функции карантина задайте значение. `quarantine_key` = Это важный элемент карантинной функции, способная защитить функцию карантина от атак вредоносных программ, и предотвратить запуск удерживаемых на карантине файлов. Значение `quarantine_key` Вы должны хранить втайне от всех, как и пароли. Оптимально в сочетании с `delete_on_sight`.

##### «quarantine_max_filesize»
- Максимально допустимый объём файлов, которые могут быть изолированы в карантине. В карантинном регистре НЕ будет сохраняться файлы, объём которых больше указанного значения. Эта команда важна тем, что затрудняет потенциальному агрессору наводнить нежелательными данными ваш карантинный регистр, а также кэш-память вашего хост-сервера. Стандарт = 2МБ.

##### «quarantine_max_usage»
- Максимально допустимая загрузка карантина. Когда общий объём файлов на карантине достигает этого значения, то начинают удаляться старые файлы пока не будет достигнуто необходимое значение. Эта команда важна тем, что затрудняет потенциальному агрессору наводнить нежелательными данными ваш карантинный регистр, а также кэш-память вашего хост-сервера. Стандарт = 64МБ.

##### «quarantine_max_files»
- Максимальное количество файлов, которые могут существовать в карантине. Когда новые файлы добавляются в карантин, если этот номер будет превышен, старые файлы будут удалены до тех пор, пока остаток больше не будет превышать этот номер. Стандарт = 100.

##### «honeypot_mode»
- При активированном Honeypot-модуса phpMussel изолирует каждый загружаемый файл без всякой проверки, не обращая внимание на сигнатуры. Эта функция предназначена исключительно для исследования вирусов и вредоносных программ. Мы рекомендуем использовать эту функцию phpMussel исключительно для «Honeypotting», а не для проверки загружаемых файлов или других целей. В стандартной комплектации эта функция деактивирована. False = Деактивировано [стандартное значение]; True = Активировано.

##### «scan_cache_expiry»
- Как долго должна phpMussel хранить результаты сканирования в буфере? Значение измеряется секундами. Стандартное значение 21600 секунд (6 часов). Значение равное 0 деактивирует временную память результатов сканирования.

##### «disable_cli»
- Деактивировать ли CLI-модус? Обычно CLI-модус активирован. Однако иногда он может отрицательно влиять на определённые тестовые программы (например на PHPUnit) и другие приложения, базирующиеся на CLI. Если CLI-модус нельзя деактивировать, то эту команду нужно игнорировать. False = CLI-модус активирован [Стандарт]; True = CLI-модус деактивирован.

##### «disable_frontend»
- Деактивировать доступ к фронтенд? Доступ к фронтенд может сделать phpMussel более управляемым, но также может быть потенциальный риск безопасности. Рекомендуется чтобы управлять phpMussel через бэкенд когда возможно, но доступ к фронтенд предоставлен для того когда это не возможно. Держите его деактивирована за исключением того если Вам это нужно. False = Активировать доступ к фронтенд; True = Деактивировать доступ к фронтенд [Стандарт].

##### «max_login_attempts»
- Максимальное количество попыток входа в систему фронтенда. Стандарт = 5.

##### «frontend_log»
- *v1: «FrontEndLog»*
- Файл для запись всех попыток входа в фронтенд. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «disable_webfonts»
- Отключить веб-шрифты? True = Да [Стандарт]; False = Нет.

##### «maintenance_mode»
- Включить режим обслуживания? True = Да; False = Нет [Стандарт]. Отключает все, кроме фронтенд. Иногда полезно при обновлении CMS, фреймворков и т.д.

##### «default_algo»
- Определяет, какой алгоритм использовать для всех будущих паролей и сеансов. Опции: PASSWORD_DEFAULT (стандарт), PASSWORD_BCRYPT, PASSWORD_ARGON2I (требует PHP >= 7.2.0).

##### «statistics»
- Отслеживать статистику использования phpMussel? True = Да; False = Нет [Стандарт].

##### «disabled_channels»
- Это можно использовать для предотвращения использования phpMussel определенных каналов при отправке запросов (например, при обновлении, при извлечении метаданных компонента, и т.д.).

#### «signatures» (Категория)
Конфигурация подписями.

##### «active»
- *v1: «Active»*
- Список активных файлов сигнатур, разделенных запятыми.

*Заметка:*
- *Сначала необходимо установить файлы сигнатуры, прежде чем вы сможете их активировать.*
- *Чтобы тестовые файлы работали правильно, файлы сигнатуры должны быть установлены и активированы.*
- *Значение этой директивы кэшируется. После его изменения, чтобы изменения вступили в силу, вам может потребоваться удалить кеш.*

##### «fail_silently»
- Реакция phpMussel на отсутсвие сигнатурей или дефект в них. Когда `fail_silently` деактивирована, то в течение сканирования будет сообщаться об отсутствии сигнатуры или изъянах в ней. В случае если `fail_silently` активирована, то отсутствующие или дефектные сигнатуры будут игнорироваться, не сообщая о проблемах. Эта опция должна оставаться такой, если только Вы не ожидаете отказа системы или чего-то подобного. False = Деактивировано; True = Активировано [Стандарт].

##### «fail_extensions_silently»
- Должна phpMussel сообщать, что отсутствует расширение файла? Если `fail_extensions_silently` деактивирована, то при сканировании придёт сообщение об отсутствии расширения файла, если же `fail_extensions_silently` активирована, то файлы с отсутствующим расширением будут игнорироваться, и при сканировании придёт сообщение, что с этими файлами всё в порядке. Деактивация или активация могут повысить Вашу безопасность, однако способствовать увеличению ложных сообщений. False = Деактивировано; True = Активировано [Стандарт].

##### «detect_adware»
- Интерпретировать сигнатурей для обнаружить рекламное программное? False = Нет; True = Да [Стандарт].

##### «detect_joke_hoax»
- Интерпретировать сигнатурей для обнаружить шутка вредоносные/вирусы программы? False = Нет; True = Да [Стандарт].

##### «detect_pua_pup»
- Интерпретировать сигнатурей для обнаружить PUAs/PUPs (потенциально нежелательных программы/приложений)? False = Нет; True = Да [Стандарт].

##### «detect_packer_packed»
- Интерпретировать сигнатурей для обнаружить упаковщики и упакованные данные? False = Нет; True = Да [Стандарт].

##### «detect_shell»
- Интерпретировать сигнатурей для обнаружить веб-шелл скрипты? False = Нет; True = Да [Стандарт].

##### «detect_deface»
- Интерпретировать сигнатурей для обнаружить дифейсмент/обезображивание программы? False = Нет; True = Да [Стандарт].

##### «detect_encryption»
- Должен ли phpMussel обнаруживать и блокировать зашифрованные файлы? False = Нет; True = Да [Стандарт].

#### «files» (Категория)
Файл обработки конфигурации.

##### «max_uploads»
- Максимально разрешённое количество проверяемых файлов в течение одной загрузки файлов. Если количество скачиваемых файлов превышает это значение, то, прежде чем сканирование прекратится, пользователь будет об этом проинформирован. Эта опция защищает от теоретической DDoS-атаки на вашу систему или CMS, тем что, пока агрессор перегружает phpMussel, останавливается PHP-процесс. Рекомендуется установить число 10. В зависимости от мощности вашего устройства Вы можете повышать или уменьшать это значение. Внимание! Это значение не учитывает содержание архивов.

##### «filesize_limit»
- Ограничение объема файла в килобайтах. 65536 = 64MB [Стандарт]; 0 = без ограничений (устанавливается для «серого листа»), принимается любое (положительное) цифровое значение. Это полезно, если PHP-конфигурация Вашей системы в каждом процессе ограничивает использование имеющейся памяти или ограничивает объём загружаемого файла.

##### «filesize_response»
- Обработка файлов, превышающих ограничение объёма файлов (если указано). False = Добавить к белому списку; True = Добавить к чёрному списку [Стандарт].

##### «filetype_whitelist», «filetype_blacklist», «filetype_greylist»
- Если ваша система позволяет или полностью запрещает загружать специальные файлы, то, отсортировав их на белый, чёрный или серый список, программа ускоряет процесс сканирования, пропуская эти типы файлов. Формат CSV (comma separated values, отделяемые запятой величины). Если Вы хотите подвергнуть проверке всё, то оставьте переменные величины пустыми, это деактивирует белый, чёрный и серый списки.
- Логичная последовательность обработки:
  - Файл, занесённый с белый список, сканирует не блокируя; файл из белого или серого списка не проверяет.
  - Файл из чёрного списка не сканирует, но всё же блокирует; файл из серого списка не проверяет.
  - Если файл относится к типу файлов, занесённых в серый список, то независимо от того пуст или заполнен серый список, программа будет сканировать файл как обычно и, базируясь на сканировании, определит должен ли он блокироваться или нет; если серый список заполнен и тип файла не значится в сером списке, то программа поступит с ним так, как будто он занесён в чёрный список, т.е. не сканирует его, но всё равно блокирует.

##### «check_archives»
- Нужно ли проверять содержимое архивов? False = Нет (никакой проверки); True = Да (будет проверяться) [Стандарт].

Формат | Может читать | Может читать рекурсивно | Может обнаруживать шифрование | Заметки
---|---|---|---|---
Zip | ✔️ | ✔️ | ✔️ | Требует [libzip](https://secure.php.net/manual/en/zip.requirements.php) (обычно в комплекте с PHP в любом случае). Также поддерживается (использует формат zip): ✔️ Обнаружение объекта OLE. ✔️ Обнаружение макросов Office.
Tar | ✔️ | ✔️ | ➖ | Никаких особых требований. Формат не поддерживает шифрование.
Rar | ✔️ | ✔️ | ✔️ | Требуется расширение [rar](https://pecl.php.net/package/rar) (когда это расширение не установлено, phpMussel не может читать файлы rar).
Phar | ❌ | ❌ | ❌ | Поддержка чтения файлов phar была удалена в v1.6.0, и больше не будет добавлена из-за проблем с безопасностью.

*Если кто-то может и хочет помочь реализовать поддержку чтения других форматов архивов, такая помощь будет приветствоваться.*

##### «filesize_archives»
- Должен ли объём файла чёрного/белого списка быть перенесён на содержание архива? False = Нет (всё поместить в серый лист); True = Да [Стандарт].

##### «filetype_archives»
- Должен ли тип файла чёрного/белого списка быть перенесён на содержание архива? False = Нет (всё поместить в серый лист) [Стандарт]; True = Да.

##### «max_recursion»
- Максимальная граница рекурсионной глубины архивов. Стандарт = 3.

##### «block_encrypted_archives»
- Нужно ли узнавать и блокировать зашифрованные архивы? phpMussel не может сканировать зашифрованные архивы. Не исключена вероятность того, что кодировка архива используется агрессором, чтобы избежать phpMussel, антивирусных сканеров и других подобных защитных программ. Умение phpMussel блокировать зашифрованные архиВы может быть поможет уменьшить риски, связанные с этой возможностью. False = Нет; True = Да [Стандарт].

##### «max_files_in_archives»
- Максимальное количество файлов для сканирования из архивов перед прекращением сканирования. Стандарт = 0 (не максимум).

#### «attack_specific» (Категория)
Атака конкретных директив.

Определение атаки хамелеона: False = Деактивировано; True = Активировано.

##### «chameleon_from_php»
- Поиск PHP-заголовков в файлах, которые не были опознаны ни как PHP-файлы, ни как архивы.

##### "can_contain_php_file_extensions"
- Список расширений файлов позволяет содержать PHP-код, разделенный запятыми. Если обнаружение атаки хамелеона PHP включено, файлы, содержащие PHP-код, которые имеют расширения, которые не входят в этот список, будут обнаружены как атаки хамелеона PHP.

##### «chameleon_from_exe»
- Поиск способных загрузиться заголовков в файлах, которые нельзя ни загрузить, ни определить как архив; поиск способных загрузиться файлов, чьи заголовки не соответствуют требованиям.

##### «chameleon_to_archive»
- Обнаружение неправильных заголовков в архивах и сжатых файлах. Поддерживаются: BZ/BZIP2, GZ/GZIP, LZF, RAR, ZIP.

##### «chameleon_to_doc»
- Поиск офисных документов с некорректными заголовками (поддерживаются: DOC, DOT, PPS, PPT, XLA, XLS, WIZ).

##### «chameleon_to_img»
- Поиск графиков с некорректными заголовками (поддерживаются: BMP, DIB, PNG, GIF, JPEG, JPG, XCF, PSD, PDD, WEBP).

##### «chameleon_to_pdf»
- Поиск PDF-файлов с некорректными заголовками.

##### «archive_file_extensions»
- Опознаёт расширение архива или файла (CSV-формат; включать или удалять только при проблемах; удаление без нужны может вызвать для архива сигнал тревоги; включение без нужды может внести в белый список то, что раньше определялось как возможная атака; изменяйте список очень осторожно; помните, что программа не влияет на функцию архива и не может анализировать содержание). Этот список содержит форматы архивов, наиболее часто используемых большинством систем и CMS, однако он не завершён, но сделано это намеренно.

##### «block_control_characters»
- Должны ли файлы, содержащие командные сигналы (отличные от Newline/конец строки), быть блокированными (`[\x00-\x08\x0b\x0c\x0e\x1f\x7f]`)? При загрузке только «голого» текста Вы можете активировать эту опцию, чтобы усилить защиту своей системы. Но когда она активирована, а Вы хотите загрузить не только текст, то программа подаст Вам ложный сигнал тревоги. False = Не блокировать [Стандарт]; True = Блокировать.

##### «corrupted_exe»
- Дефектные файлы и разобрать ошибки. False = Игнорировать; True = Блокировать [Стандарт]. Должны ли потенциально дефектные файлы при загрузке проверяться и блокироваться? В случае когда определённые аспекты PE-файла повреждены или могут быть неправильно обработаны, то часто (однако не всегда) они идентифицируются как инфицированные файлы. Многие антивирусные программы используют различные методы по опознанию вирусов в таких файлах. Программисты вирусов, зная об этом, прилагают много усилий к тому, чтобы вирус остался неопознанным.

##### «decode_threshold»
- Порог числа исходных данных, которые должны узнаваться командой декодирования (если во время процесса сканирования не возникнут ощутимые проблемы производительности). Стандартная установка 512КБ. Ноль или нулевое значение деактивирует ограничение (все такие ограничения нужно устранять, ориентируясь на величину файла).

##### «scannable_threshold»
- Порог числа исходных данных, которые phpMussel должна прочитать и просканировать (если во время процесса сканирования возникнут ощутимые проблемы производительности). Стандартная установка 32МБ. Ноль или нулевое значение деактивирует ограничения. Основное правило: это значение должно быть меньше среднего объёма загружаемых файлов, которые Вы хотите скачать на свой сервер или веб-страницу, не больше нормы filesize_limit, и не превышать пятой части общей PHP-памяти `php.ini` файлов конфигурации. Эти правила не дают phpMussel использовать слишком большой объём памяти (что препятствовало бы phpMussel успешно сканировать файлы, превышающие определенную величину).

##### «allow_leading_trailing_dots»
- Разрешить точки в начале и конце имен файлов? Иногда это может быть использовано для скрытия файлов или для обмана некоторых систем для разрешения обхода каталога. False = Не разрешать [Стандарт]. True = Разрешать.

##### «block_macros»
- Попробуйте заблокировать любые файлы, содержащие макросы? Некоторые типы документов и таблиц могут содержать исполняемые макросы, что создает опасный потенциальный вредоносный вектор. False = Не блокировать [Стандарт]; True = Блокировать.

#### «compatibility» (Категория)
ДиректиВы совместимости для phpMussel.

##### «ignore_upload_errors»
- Как правило, эта директива находится в положении False/Деактивировано, если только нет потребности в ней для правильного функционирования phpMussel на вашей системе. При находящейся в положении False/Деактивировано директиве phpMussel, опознав нѐкий элемент в `$_FILES` array(), начинает проверять файлы, представляющие этот элемент. В случае если файлы окажутся пустыми, phpMussel подаёт сигнал тревоги. Это нормальная реакция phpMussel. Однако некоторые CMS нормальными считают пустые элементы в `$_FILES`, и сигнал тревоги подаётся в случае отсутствия пустых элементов. В этой ситуации возникает конфликт между нормальным поведением phpMussel и CMS. Если это касается вашей CMS, то Вам необходимо переключить опцию в позицию True/Активировано, тогда phpMussel не будет искать пустые элементы, а найдя будет их игнорировать, не сообщая об ошибке. Сигнал запроса страницы, таким образом, может продолжаться. False = Деактивировано; True = Активировано.

##### «only_allow_images»
- Ожидая загрузку на Вашу систему или CMS только графических изображений, или Вы желаете, чтобы загружались только графические изображения и больше никакие другие файлы, то эта директива должна быть активирована (ON), во всех остальных случаях она остаётся деактивированной (OFF). Активация этой директиВы заставит phpMussel блокировать все попытки загрузить файлы, не относящиеся к графикам, не сканируя их. Эта директива поможет сократить время обработки и улучшить использование памяти, когда будут загружаться файлы, не относящиеся к графическим изображениям. False = Деактивировано; True = Активировано.

#### «heuristic» (Категория)
Эвристические-директиВы для phpMussel.

##### «threshold»
- phpMussel имеет определённые сигнатуры, с помощью которых она идентифицирует подозрительные и потенциально вредоносные свойства загружаемых файлов, не проверяя при этом сами файлы на вредоносность. При помощи этой директиВы phpMussel определяет степень опасности подозрительных и потенциально вредоносных файлов, прежде чем назвать их вредоносными. В этой связи, определение степени опасности = это общее количество подозрительных и потенциально вредоносных свойств. Стандартное значение равняется 3. Значение меньше 3, как правило, ведёт к увеличению ложных сигналов тревоги и опознанию большего числа вредных файлов; значение больше 3 вызывает меньшее количество ложных сигналов тревоги и метиться как вредные будет незначительное количество файлов. Оставив это значение таким, Вы должны осознавать проблемы, которые будут вызваны этой установкой.

#### «virustotal» (Категория)
VirusTotal.com директивы.

##### «vt_public_api_key»
- Для большей защиты от вирусов, троянов, вредоносных программ и других угроз phpMussel может сканировать файлы с Virus Total API. Стандартная установка = опция Virus Total API деактивирована. Для активизации нужно воспользоваться API-ключом от Virus Total. Эта опция даёт много преимуществ, поэтому рекомендуется её активировать. Важно осознавать: для использования Virus Total API, необходимо согласиться со всеми условиями пользования и соблюдать все директивы, описанные в документах Virus Total! Эту функцию интеграции нельзя применять КРОМЕ:
  - Вы прочитали инструкцию по использованию Virus Total и API и согласен с ней. Инструкцию по использованию Virus Total и API можно найти [Здесь](https://www.virustotal.com/en/about/terms-of-service/).
  - Как минимум, Вы прочитали предисловие к Virus Total Public API документации и понял о чём речь (всё после „VirusTotal Public API v2.0“ но до „Contents“). Документацию Virus Total публичная API можно найти [Здесь](https://www.virustotal.com/en/documentation/public-api/).

Примечание: Когда сканирование файлов с Virus Total API деактивировано, то нет нужды проверять директиВы этой категории (`virustotal`), потому что нельзя проверить то, что деактивировано. Для получения Virus Total API ключа, нужно пойти на их веб-страницу и вверху справа найти ссылку «Вступить в сообщество». Указав все требуемые данные, кликните в «Зарегистрироваться». Выполнив все указания, Вы получите открытые API-ключи, скопируйте их и введите API-ключ в `vt_public_api_key` директиву `config.ini` файла конфигурации.

##### «vt_suspicion_level»
- Допуская файлы к сканированию Virus Total API, phpMussel будет ограничиваться только теми файлами, которые рассматриваются «опасными». Опционально Вы можете регулировать эти ограничения, изменив значение `vt_suspicion_level` директивы.
- `0`: Файлы будут рассматриваться подозрительными только тогда, когда через сканирование собственными подписями phpMussel присвоит им эвристическую степень опасности. Можно считать, что Virus Total API используется как второе мнение в случае, когда phpMussel подозревает, что файл повреждён, и нельзя полностью исключить, что он потенциально безвреден. Обычно такой файл не будет блокироваться или метиться как вредный.
- `1`: Файлы будут восприниматься подозрительными, когда через сканирование собственными подписями phpMussel присвоит им эвристическую степень опасности; когда они являются файлами, которые можно загружать, такие как PE файлы, Mach-O файлы, ELF/Linux файлы и др., или имеют формат макрос, DOC/DOCX, файлы архивов как RAR, ZIP и др. Это нормальная и рекомендуемая степень подозрительности. В случае когда предположительно опасный файл phpMussel не признаёт вредоносным или противоречивым и, следовательно, не блокирует его и не маркирует как опасный, тогда Virus Total API будет использоваться для второго мнения.
- `2`: Virus Total API должна просканировать все файлы, так как все они будет рассматриваться как подозрительные. Я не советую применять эту степень подозрительности, потому что при ней API-лимит достигается намного быстрее, чем обычно. Правда, есть определённые обстоятельства, когда эта степень подозрительности была бы уместной, например, веб-мастер или хост-мастер мало доверяют загружаемому содержанию пользователя. При этой степени подозрительности все файлы, которые обычно не блокируются и не маркируются как вредоносные, будут сканироваться Virus Total API. Помни! phpMussel не будет использовать Virus Total API, если достигнут API-лимит, не зависимо от степени подозрительности. API-лимит, скорее всего, будет достигнут намного быстрее, если использовать эту степень подозрительности.

Примечание: Независимо от степени подозрительности файлы находящиеся в белом или чёрном списке будут проверятся не phpMussel, а с помощью Virus Total API. Так как эти файлы, просканированные по-другому, перед этим уже были задекларированы как вредные или безвредные, то дополнительное сканирование не требуется. Совместное сканирование файлов phpMussel и Virus Total API предусмотрено для увеличения доверия независимо от ситуации, когда phpMussel не доверяет сам себе в определении вреден ли файл или безвреден.

##### «vt_weighting»
- Должна phpMussel использовать результаты сканирования с Virus Total API в качестве опознания или как определение степени доверия? Существование этой директиВы объясняется тем, что сканирование файла со многими ядрами должно быть более тщательным (как это делает Virus Total) и, следовательно, будет найдено большее количество вредоносных файлов, что может привести к большему количеству ложных тревог. Есть ситуации, когда результаты сканирования бывают выше степени доверия, и тогда применяется однозначный результат. Применение значения 0 означает, что результаты сканирования будут применяться как опознание. В этом случае phpMussel будет рассматривать файл как вредоносный, если какие-то используемые в сканировании ядра файлов Virus Total обозначил опасными. При установке другого значения, результаты сканирования с Virus Total API будут использоваться как определение степени доверия. Количество используемых Virus Total ядер, обозначающих файл как вредоносный, будет служить степенью доверия (или определением степени доверия). Используемое значение будет определять, какую степень доверия (минимальную или требуемую) примет phpMussel во внимание, чтобы признать сканируемый файл вредоносным или безвредным. Стандартное значение = 0.

##### «vt_quota_rate» и «vt_quota_time»
- Согласно Virus Total API-документации «Лимит времени, за которое должны обрабатываться 4 любых запроса, составляет 1 минуту. Используя Honeyclient, Honeypot или какую-либо другую активную систему, которая содействует VirusTotal, и не только вызывает сообщения, то Вы имеете право на более высокий лимит времени». phpMussel будет строго придерживаться этого лимита. Для его повышения даны эти две директивы, указывающие phpMussel на какой лимит она должна ориентироваться. Рекомендуется без необходимости это значение не повышать. С возникновением проблем по достижению лимита, уменьшение этого значения должно немного помочь. Твой лимит будет установлен как `vt_quota_rate` запросы любого типа в каждом `vt_quota_time` минутном промежутке времени.

#### «urlscanner» (Категория)
В phpMussel есть URL сканер, способен обнаружить вредоносные URL-адреса изнутри данных или файлов отсканированных.

Примечание: Если URL сканер деактивирован, то нет нужды проверять директиВы этой категории (`urlscanner`).

URL сканер API конфигурация.

##### «lookup_hphosts»
- Активировать [hpHosts](https://hosts-file.net/) API интеграция если `true`. hpHosts не нужен API ключ для API интеграция.

##### «google_api_key»
- Активировать Google Safe Browsing API интеграция если необходимое API ключ вводится. Google Safe Browsing API нужен API ключ для API интеграция, Вы можете получить [Здесь](https://console.developers.google.com/).
- Примечание: cURL расширение требуется для того, чтобы использовать эту функцию.

##### «maximum_api_lookups»
- Максимально допустимая количество API звонков, которые проводятся в каждом сессии сканирования. Потому каждый дополнительный API запрос, увеличивает время для сессии сканирования, Вы мог бы хотите, чтобы указать предел при определенных обстоятельствах чтобы ускорить процесс сканирования по всему. Если 0 установлен, нет предела применяется. Стандарт, значение установленов 10.

##### «maximum_api_lookups_response»
- Что должно произойти, если максимальное число допустимых API запросов будет достигнута? False = Не делайте ничего (Продолжить обработку) [Стандарт]; True = Отметить/блокировки файла.

##### «cache_time»
- Как долго (в секундах) результаты API вызовов, которые должны быть в кэше? Стандарт 3600 секунд (1 час).

#### «legal» (Категория)
Конфигурация, относящаяся к требованиям законодательства.

*Для получения дополнительной информации о правовых требованиях и о том, как это может повлиять на ваши требования к конфигурации, обратитесь к разделу «[ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ](#SECTION11)» документации.*

##### «pseudonymise_ip_addresses»
- Псевдонимный IP-адреса при записи файлов журнала? True = Да [Стандарт]; False = Нет.

##### «privacy_policy»
- Адрес соответствующей политики конфиденциальности, отображаемый в нижнем колонтитуле любых сгенерированных страниц. Укажите URL-адрес, или оставьте пустым для отключения.

#### «template_data» (Категория)
Директивы/Переменные для шаблоны и темы.

Шаблонный данных относится к HTML-вывода, используемый для генерации «Загрузить Отказано» сообщения отображается для пользователей когда/на загрузки/уплоад файлов блокируются. Если Вы используете персонализированные темы для phpMussel, HTML-выход получены из `template_custom.html` файл, а в противном случае, HTML-выход получены из `template.html` файл. Переменные, записанные в этом разделе файл конфигурации обрабатываются на HTML-выход в виде заменой любой имена переменных в окружении фигурных скобках найденный в HTML-вывода с соответствующей переменных данных. Например, где `foo="bar"`, любое вхождение `<p>{foo}</p>` найденный в HTML-вывода станет `<p>bar</p>`.

##### «theme»
- Стандартная тема для phpMussel.

##### «magnification»
- *v1: «Magnification»*
- Увеличение шрифта. Стандарт = 1.

##### «css_url»
- Шаблонный файл для персонализированные темы использует внешние CSS свойства и шаблонный файл для стандарт тема использует внутренние CSS свойства. Поручить phpMussel использовать персонализированные темы шаблонный файл, указать адрес публичного HTTP в CSS файлов вашей темы используя `css_url` переменная. Если оставить это переменная пустым, phpMussel будет использовать шаблонный файл для стандарт тема.

#### «PHPMailer» (Категория)
Конфигурация PHPMailer.

В настоящее время phpMussel использует PHPMailer только для двухфакторной аутентификации на фронтенд. Если вы не используете фронтенд, или если вы не используете двухфакторную аутентификацию для фронтенд, вы можете игнорировать эти директивы.

##### «event_log»
- *v1: «EventLog»*
- Файл для регистрации всех событий в отношении PHPMailer. Задайте имя файлу, или оставьте пустым чтобы деактивировать опцию.

##### «skip_auth_process»
- *v1: «SkipAuthProcess»*
- Установка этой директивы на `true` указывает PHPMailer пропустить обычный процесс проверки подлинности, который обычно возникает при отправке электронной почты через SMTP. Этого следует избегать, поскольку пропуская этот процесс может выдать исходящую электронную почту для атак MITM, но может потребоваться в тех случаях, когда этот процесс препятствует подключению PHPMailer к SMTP-серверу.

##### «enable_two_factor»
- *v1: «Enable2FA»*
- Эта директива включает/отключает использование 2FA для фронтенд счетов.

##### «host»
- *v1: «Host»*
- Хост SMTP используется для исходящей электронной почты.

##### «port»
- *v1: «Port»*
- Номер порта для исходящей электронной почты. Стандарт = 587.

##### «smtp_secure»
- *v1: «SMTPSecure»*
- Протокол для при отправке электронной почты через SMTP (TLS или SSL).

##### «smtp_auth»
- *v1: «SMTPAuth»*
- Эта директива включает/отключает аутентификацию сессия SMTP (обычно ее следует оставить в покое).

##### «username»
- *v1: «Username»*
- Имя пользователя для отправки электронной почты через SMTP.

##### «password»
- *v1: «Password»*
- Пароль для отправки электронной почты через SMTP.

##### «set_from_address»
- *v1: «setFromAddress»*
- Адрес отправителя для отправки электронной почты через SMTP.

##### «set_from_name»
- *v1: «setFromName»*
- Имя отправителя для отправки электронной почты через SMTP.

##### «add_reply_to_address»
- *v1: «addReplyToAddress»*
- Адрес ответа для отправки электронной почты через SMTP.

##### «add_reply_to_name»
- *v1: «addReplyToName»*
- Имя ответа для отправки электронной почты через SMTP.

#### «supplementary_cache_options» (Категория)
Дополнительные параметры кеша.

*В настоящее время, это чрезвычайно экспериментально, и может вести себя не так, как ожидалось! На данный момент я рекомендую игнорировать это.*

##### «enable_apcu»
- Указывает, использовать ли APCu для кэширования. Стандарт = False.

##### «enable_memcached»
- Указывает, использовать ли Memcached для кэширования. Стандарт = False.

##### «enable_redis»
- Указывает, использовать ли Redis для кэширования. Стандарт = False.

##### «enable_pdo»
- Указывает, использовать ли PDO для кэширования. Стандарт = False.

##### «memcached_host»
- Значение хоста Memcached. Стандарт = «localhost».

##### «memcached_port»
- Значение порта Memcached. Стандарт = «11211».

##### «redis_host»
- Значение хоста Redis. Стандарт = «localhost».

##### «redis_port»
- Значение порта Redis. Стандарт = «6379».

##### «redis_timeout»
- Значение тайм-аута Redis. Стандарт = «2.5».

##### «pdo_dsn»
- Значение DSN PDO. Стандарт = «`mysql:dbname=phpmussel;host=localhost;port=3306`».

##### «pdo_username»
- Имя пользователя PDO.

##### «pdo_password»
- Пароль PDO.

---


### 8. <a name="SECTION8"></a>ФОРМАТ СИГНАТУРЕЙ

*Смотрите также:*
- *[Что такое «сигнатур»?](#WHAT_IS_A_SIGNATURE)*

Первые 9 байтов `[x0-x8]` файла сигнатуры phpMussel: `phpMussel`. Это действует как «магическое число» (magic number), чтобы идентифицировать их как файлы сигнатуры (это помогает предотвратить случайное использование файлов, которые не являются сигнатурными файлами). Следующий байт `[x9]` определяет тип файла сигнатуры, который phpMussel должен знать, чтобы иметь возможность правильно интерпретировать файл сигнатуры. Признаются следующие типы файлов сигнатур:

Тип | Байт | Описание
---|---|---
`General_Command_Detections` | `0?` | Для файлов сигнатуры CSV (с разделителями-запятыми). Значения (сигнатуры) представляют собой строки с шестнадцатеричным кодированием для поиска внутри файлов. Сигнатуры здесь не имеют никаких имен или других деталей.
`Filename` | `1?` | Для сигнатуры имен файлов.
`Hash` | `2?` | Для сигнатуры хэш.
`Standard` | `3?` | Для файлов сигнатуры, которые работают непосредственно с содержимым файла.
`Standard_RegEx` | `4?` | Для файлов сигнатуры, которые работают непосредственно с содержимым файла. Сигнатуры могут содержать регулярные выражения.
`Normalised` | `5?` | Для файлов сигнатуры, которые работают с ANSI-нормализованным содержимым файла.
`Normalised_RegEx` | `6?` | Для файлов сигнатуры, которые работают с ANSI-нормализованным содержимым файла. Сигнатуры могут содержать регулярные выражения.
`HTML` | `7?` | Для файлов сигнатуры, которые работают с HTML-нормализованным содержимым файла.
`HTML_RegEx` | `8?` | Для файлов сигнатуры, которые работают с HTML-нормализованным содержимым файла. Сигнатуры могут содержать регулярные выражения.
`PE_Extended` | `9?` | Для файлов сигнатуры, которые работают с метаданными PE (кроме метаданных секторов PE).
`PE_Sectional` | `A?` | Для файлов сигнатуры, которые работают с метаданных секторов PE.
`Complex_Extended` | `B?` | Для файлов сигнатуры, которые работают с различными правилами на основе расширенных метаданных, сгенерированных phpMussel.
`URL_Scanner` | `C?` | Для файлов сигнатуры, которые работают с URL-адресами.

Следующий байт: `[x10]`. Это символ новой строки, `[0A]`. На этом завершается заголовок файла сигнатуры phpMussel.

Каждая непустая строка после этого является сигнатурой или правилом. Каждая сигнатур или правило занимает одну строку. Поддерживаемые форматы сигнатуры описаны ниже.

#### *СИГНАТУРЫ НАЗВАНИЙ ФАЙЛОВ*
Все сигнатуры названий файлов имеют следующий формат:

`NAME:FNRX`

NAME = Название сигнатуры; FNRX = Regex-образец опознания для сравнения (декодированных) названий файлов.

#### *СИГНАТУРЫ ХЭШ*
Все сигнатуры хэш имеют следующий формат:

`HASH:FILESIZE:NAME`

HASH = Это хэш (обычно MD5) всего файла; FILESIZE = Это общий объём файла; NAME = Название сигнатуры.

#### *PE-СЕКЦИОННЫЕ СИГНАТУРЫ*
Все PE-секционные сигнатуры имеют следующий формат:

`SIZE:HASH:NAME`

HASH = Это MD5-Hash одной PE-секции файла; FILESIZE = Общий объём PE-секции; NAME = Название сигнатуры.

#### *PE РАСШИРЕННЫХ СИГНАТУРЕЙ*
Все PE расширенных сигнатурей имеют следующий формат:

`$VAR:HASH:SIZE:NAME`

Where $VAR is the name of the PE variable to match against, HASH is the MD5 hash of that variable, SIZE is the total size of that variable and NAME is the name to cite for that signature.

#### *КОМПЛЕКС РАСШИРЕННЫХ СИГНАТУРЕЙ*
Сигнатуры, входящие в комплекс расширенных сигнатурей, сильно отличаются от других видов возможных сигнатурей phpMussel. По многим критериям они не согласуются с тем, что специфицируют сигнатуры. Критерии соответствия разделяются между собой «;». Тип и данные каждой критерии соответствия отделяются друг от друга «:». Формат этой сигнатуры выглядит примерно так:

`$variable1:SOMEDATA;$variable2:SOMEDATA;SignatureName`

#### *ВСЕ ПРОЧИЕ СИГНАТУРЫ*
Все прочие сигнатуры имеют следующий формат:

`NAME:HEX:FROM:TO`

NAME = Название сигнатуры; HEX = Сегмент файла, закодированный в шестнадцатеричный системе счисления (hexadecimal), который будет проверяться вместе с данной подписью. FROM и TO = Опциональный параметры, задающие для проверки старт и конечный пункт в исходных данных.

#### *REGEX (REGULAR EXPRESSIONS)*
Каждая форма регулярных выражений, понятных и правильно загружаемых PHP, должна также пониматься и phpMussel, чтобы правильно загружать сигнатуры. Будьте крайне осторожны в написании новых сигнатурей, базирующихся на регулярных выражениях. Неумелые действия могут привести к неправильным и/или неожиданным результатам. Если у вас нет абсолютной уверенности, то посмотрите исходный текст phpMussel, описывающий процесс обработки регулярных выражений. Помните, что все поисковые образцы, кроме названия файлов, архива метаданных и MD5-проверочных образцов, должны быть закодированы в шестнадцатеричный системе счисления (за исключением синтаксис, естественно)!

---


### 9. <a name="SECTION9"></a>ИЗВЕСТНЫЕ ПРОБЛЕМЫ СОВМЕСТИМОСТИ

#### PHP и PCRE
- Чтобы phpMussel могла загрузиться, ей необходимы PHP и PCRE. Без PHP и её PCRE-расширений phpMussel или вообще не сможет загрузиться, или загрузится ненадлежащим образом. Прежде чем скачивать и инсталлировать phpMussel убедитесь, что ваша система имеет PHP и PCRE.

#### СОВМЕСТИМОСТЬ С АНТИВИРУСНЫМ ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ

За редким исключением phpMussel хорошо совмещается с большинством антивирусных программ. Но были случаи, когда пользователи испытывали трудности. VirusTotal.com собрала информацию, описывающую какими тревожными сигналами phpMussel реагируют на разные антивирусные программы. Эта информация не гарантирует, что установленное на Вашей системе антивирусное программное обеспечение не совмещается с phpMussel. Если phpMussel причислила Ваше антивирусное программное обеспечение к проблематичному, то Вам нужно его или отключать перед использованием phpMussel, или решить эту проблему как-то по-другому.

Последний раз эта информация обновлялась 2018.10.09 года и считается актуальной для всех опубликованных на данный момент phpMussel и обеих её дополнительных версий (v1.5.0-v1.6.0).

*Эта информация относится только к основному пакету. Результаты могут варьироваться в зависимости от установленных файлов сигнатур, плагинов и других периферийных компонентов.*

| Сканер | Результаты |
|---|---|
| Bkav | Сообщает «VEX.Webshell» |

---


### 10. <a name="SECTION10"></a>ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ (FAQ)

- [Что такое «сигнатур»?](#WHAT_IS_A_SIGNATURE)
- [Что такое «ложноположительный»?](#WHAT_IS_A_FALSE_POSITIVE)
- [Как часто обновляются сигнатуры?](#SIGNATURE_UPDATE_FREQUENCY)
- [Я столкнулся с проблемой при использовании phpMussel, и я не знаю, что с этим делать! Пожалуйста помоги!](#ENCOUNTERED_PROBLEM_WHAT_TO_DO)
- [Я хочу использовать phpMussel (до v2) с версией PHP ниже 5.4.0; Вы можете помочь?](#MINIMUM_PHP_VERSION)
- [Я хочу использовать phpMussel (v2) с версией PHP ниже 7.2.0; Вы можете помочь?](#MINIMUM_PHP_VERSION_V2)
- [Могу ли я использовать одну установку phpMussel для защиты нескольких доменов?](#PROTECT_MULTIPLE_DOMAINS)
- [Я не хочу возиться с установкой этого и заставить его работать с моим сайтом; Могу я просто заплатить вам за все это?](#PAY_YOU_TO_DO_IT)
- [Могу ли я нанять вас или любого из разработчиков этого проекта для частной работы?](#HIRE_FOR_PRIVATE_WORK)
- [Мне нужны модификации специалиста, настройки и т.д; Вы можете помочь?](#SPECIALIST_MODIFICATIONS)
- [Я разработчик, веб-дизайнер, или программист. Могу ли я принять или предложить работу, связанную с этим проектом?](#ACCEPT_OR_OFFER_WORK)
- [Я хочу внести свой вклад в проект; Я могу сделать это?](#WANT_TO_CONTRIBUTE)
- [Как получить доступ к конкретным сведениям о файлах при их сканировании?](#SCAN_DEBUGGING)
- [Могу ли я использовать cron для автоматического обновления?](#CRON_TO_UPDATE_AUTOMATICALLY)
- [Может ли phpMussel сканировать файлы без имен ANSI?](#SCAN_NON_ANSI)
- [Черные списки – Белые списки – Серые списки – Каковы они и как их использовать?](#BLACK_WHITE_GREY)
- [Когда я активирую или деактивирую файлы сигнатуры на странице обновлений, он сортирует их по алфавиту в конфигурации. Могу ли я изменить способ сортировки?](#CHANGE_COMPONENT_SORT_ORDER)

#### <a name="WHAT_IS_A_SIGNATURE"></a>Что такое «сигнатур»?

В контексте phpMussel, «сигнатур» относится к данным, которые служат идентификатор/индикатором того, что мы ищем, обычно в виде какого-то очень маленького, отчетливого, безобидного сегмента чего-то большего и в противном случае вредного, как вирус или троянец, или в виде контрольной суммы файла, хэша или другого аналогично идентифицирующего индикатора, и обычно включает ярлык, И некоторые другие данные, чтобы помочь предоставить дополнительный контекст, который может быть использован phpMussel для определения наилучшего способа продолжения, когда он встречает то, что мы ищем.

#### <a name="WHAT_IS_A_FALSE_POSITIVE"></a>Что такое «ложноположительный»?

Термин «ложноположительный» (*альтернативно: «ложноположительными ошибка»; «ложная сигнализация»*; Английский: *false positive*; *false positive error*; *false alarm*), описал очень просто, и в обобщенном контексте, используется при проверке условия, для ссылаясь на результаты этого теста, когда результаты будут положительный (то есть, условия определяется будут «положительный», или «истинно»), но как ожидается будет (или должно было) отрицательный (то есть, условие, в действительности, является «отрицательный», или «ложно»). Термин «ложноположительный» можно было бы считать аналогом «плачет волк» (английский идиома в которой условие проверяется является ли там волк возле стада, условие является «ложно» в том, что нет никакого волка возле стада, и условие сообщается «положительный» посредством пастух путем кричать «волк, волк»), или аналогично ситуации в медицинском тестировании в которой пациент диагностирован как какую-то болезнь, когда в действительности, у них нет болезни.

Связанные результаты при проверке условия можно описать с использование терминов «истинноположительный», «истинноотрицательный» и «ложноотрицательный». «Истинноположительный» описывает когда результаты испытаний и фактическое состояние условия оба являются истинными (или положительные), и «истинноотрицательный» описывает когда результаты испытаний и фактическое состояние условия оба являются ложными (или отрицательные); «Истинноположительный» или «истинноотрицательный» рассматриваются как «правильный вывод». Противоположностью «ложноположительный» является «ложноотрицательный»; «Ложноотрицательный» описывает когда результаты испытаний отрицательные (то есть, условие определяется как отрицательные, или ложными), но как ожидается будет (или должно было) положительные (то есть, условие, в действительности, является «положительный», или «истинно»).

В контексте phpMussel, эти термины относятся к сигнатур phpMussel и файлы которые они блокируют. Когда phpMussel блокирует файл из-за плохой, устаревшей или неправильной сигнатур, но не должно быть сделано, или когда он делает это по неправильным причинам, мы называем это событие как «ложноположительный». Когда phpMussel не удается блокировать файл, который должен был быть заблокированы, из-за непредвиденных угроз, недостающие сигнатур или недостатки в своих сигнатурей, мы называем это событие как «обнаружение не удалось» (аналогична «ложноотрицательный»).

Это может быть суммированы в таблице ниже:

&nbsp; | phpMussel *НЕ* должны блокировать файл | phpMussel *ДОЛЖНЫ* блокировать файл
---|---|---
phpMussel *НЕ* блокирует файл | Истинноотрицательный (правильный вывод) | Обнаружение не удалось (аналогична ложноотрицательный)
phpMussel *ДЕЛАЕТ* блокирует файл | __Ложноположительный__ | Истинноположительный (правильный вывод)

#### <a name="SIGNATURE_UPDATE_FREQUENCY"></a>Как часто обновляются сигнатуры?

Частота обновления зависит от файлов сигнатур. Предпринята попытка обновить файлов сигнатур в максимально возможной степени, но, потому всех нас есть различные другие обязательства, наша жизнь вне проекта, и мы не получаем материальной компенсации (т.е., оплата) за наши усилия по проекту, точный график обновления не может быть гарантирован. В общем, обновления происходят, когда есть время. Помощь всегда приветствуется, если Вы готовы предложить любую.

#### <a name="ENCOUNTERED_PROBLEM_WHAT_TO_DO"></a>Я столкнулся с проблемой при использовании phpMussel, и я не знаю, что с этим делать! Пожалуйста помоги!

- Используете ли Вы последнюю версию программного обеспечения? Используете ли Вы последние версии ваших файлов сигнатуры? Если ответ на любой из этих двух вопросов отрицательный, попробуйте сначала обновить все, и попытайтесь решить проблема. Если оно сохраняется, продолжайте чтение.
- Вы проверили всю документацию? Если нет, сделайте это. Если проблема не может быть решена с помощью документации, продолжите чтение.
- Вы проверили **[странице «issues»](https://github.com/phpMussel/phpMussel/issues)**, чтобы узнать упоминалась ли эта проблема ранее? Если это было уже упоминалось, проверить были ли предоставлены какие-либо предложения, идеи и/или решения, и следуйте по необходимости чтобы попытаться решить проблема.
- Если проблема не решена, пожалуйста, обратитесь за помощью, создав новую «issue» на странице «issues».

#### <a name="MINIMUM_PHP_VERSION"></a>Я хочу использовать phpMussel (до v2) с версией PHP ниже 5.4.0; Вы можете помочь?

Нет. PHP >= 5.4.0 является минимальным требованием для phpMussel < v2.

#### <a name="MINIMUM_PHP_VERSION_V2"></a>Я хочу использовать phpMussel (v2) с версией PHP ниже 7.2.0; Вы можете помочь?

Нет. PHP >= 7.2.0 является минимальным требованием для phpMussel v2.

*Смотрите также: [Графики Совместимости](https://maikuolan.github.io/Compatibility-Charts/).*

#### <a name="PROTECT_MULTIPLE_DOMAINS"></a>Могу ли я использовать одну установку phpMussel для защиты нескольких доменов?

Да. phpMussel инсталляций не привязаны к определенным домены, и поэтому может использоваться для защиты нескольких доменов. В общем, мы ссылаемся на phpMussel инсталляций, защищающие только один домен, как «однодоменные инсталляций», и мы ссылаемся на phpMussel инсталляций, защищающие несколько доменов и/или поддоменов, как «многодоменные инсталляций». Если Вы используете многодоменную инсталляция, и необходимо использовать разные файлы сигнатур для разных доменов, или необходимо настроить phpMussel по-разному для разных доменов, это можно сделать. После загрузки файла конфигурации (`config.ini`), phpMussel проверит наличие «файл переопределения конфигурации» специфичные для запрашиваемого домена или поддомена (`xn----7sbaabjijgdno9cdqkbchu3o.tld.config.ini`), и если он будет найден, любые значений конфигурации, определенные в файл переопределения конфигурации, будет использоваться для экземпляра выполнения вместо значений конфигурации, определенных конфигурационным файлом. Конфигурация переопределяет файлы, идентичные конфигурационному файлу, и на Ваше усмотрение, Может содержать все директивы конфигурации, доступные для phpMussel, или какой бы небольшой подсекция требуется, при необходимости. Имена для конфигурация переопределяет файлов соответствуют домену для которого они предназначены (так, например, если Вам нужен файл переопределения конфигурации для домена, `http://www.some-domain.tld/`, его файл переопределения конфигурации должен иметь имя `some-domain.tld.config.ini`, и должен быть помещен в `vault`, вместе с файлом конфигурации, `config.ini`). Доменные имена извлекаются из заголовка `HTTP_HOST` запроса; «www» игнорируется.

#### <a name="PAY_YOU_TO_DO_IT"></a>Я не хочу возиться с установкой этого и заставить его работать с моим сайтом; Могу я просто заплатить вам за все это?

Может быть. Это рассматривается в каждом конкретном случае. Расскажите, что вам нужно, что Вы предлагаете, и мы расскажем вам, можем ли мы помочь.

#### <a name="HIRE_FOR_PRIVATE_WORK"></a>Могу ли я нанять вас или любого из разработчиков этого проекта для частной работы?

*См. Выше.*

#### <a name="SPECIALIST_MODIFICATIONS"></a>Мне нужны модификации специалиста, настройки и т.д; Вы можете помочь?

*См. Выше.*

#### <a name="ACCEPT_OR_OFFER_WORK"></a>Я разработчик, веб-дизайнер, или программист. Могу ли я принять или предложить работу, связанную с этим проектом?

Да. Наша лицензия не запрещает это.

#### <a name="WANT_TO_CONTRIBUTE"></a>Я хочу внести свой вклад в проект; Я могу сделать это?

Да. Вклады в проект очень приветствуются. Для получения дополнительной информации см. «CONTRIBUTING.md».

#### <a name="SCAN_DEBUGGING"></a>Как получить доступ к конкретным сведениям о файлах при их сканировании?

Вы можете сделать это, назначив массив для использования для этой цели, прежде чем указывать phpMussel для их сканирования.

В приведенном ниже примере, Для этой цели назначается `$Foo`. После сканирования `/путь/к/файлу/...`, подробная информация о файлах, содержащихся в `/путь/к/файлу/...`, будет содержаться в `$Foo`.

```PHP
<?php
require 'phpmussel/loader.php';

$phpMussel['Set-Scan-Debug-Array']($Foo);

$Results = $phpMussel['Scan']('/путь/к/файлу/...');

var_dump($Foo);
```

Массив многомерен, состоящий из элементов, представляющих каждый сканируемый файл, и подэлементы представляют данные об этих файлах. Эти подэлементы следующие:

- Filename (`string`)
- FromCache (`bool`)
- Depth (`int`)
- Size (`int`)
- MD5 (`string`)
- SHA1 (`string`)
- SHA256 (`string`)
- CRC32B (`string`)
- 2CC (`string`)
- 4CC (`string`)
- ScanPhase (`string`)
- Container (`string`)
- † FileSwitch (`string`)
- † Is_ELF (`bool`)
- † Is_Graphics (`bool`)
- † Is_HTML (`bool`)
- † Is_Email (`bool`)
- † Is_MachO (`bool`)
- † Is_PDF (`bool`)
- † Is_SWF (`bool`)
- † Is_PE (`bool`)
- † Is_Not_HTML (`bool`)
- † Is_Not_PHP (`bool`)
- ‡ NumOfSections (`int`)
- ‡ PEFileDescription (`string`)
- ‡ PEFileVersion (`string`)
- ‡ PEProductName (`string`)
- ‡ PEProductVersion (`string`)
- ‡ PECopyright (`string`)
- ‡ PEOriginalFilename (`string`)
- ‡ PECompanyName (`string`)
- Results (`int`)
- Output (`string`)

*† - Не предоставляется кешированными результатами (предоставляется только для новых результатов сканирования).*

*‡ - Предоставляется только при сканировании файлов PE.*

Необязательно, этот массив можно уничтожить, используя следующее:

```PHP
$phpMussel['Destroy-Scan-Debug-Array']($Foo);
```

#### <a name="CRON_TO_UPDATE_AUTOMATICALLY"></a>Могу ли я использовать cron для автоматического обновления?

Да. API встроен в фронтенд для взаимодействия со обновления страница через внешние скрипты. Имеется отдельный скрипт: «[Cronable](https://github.com/Maikuolan/Cronable)». Он может использоваться вашим cron manager или cron scheduler для автоматического обновления этого и других поддерживаемых пакетов (этот скрипт предоставляет собственную документацию).

#### <a name="SCAN_NON_ANSI"></a>Может ли phpMussel сканировать файлы без имен ANSI?

Допустим, есть каталог, который вы хотите отсканировать. В этом каталоге у вас есть файлы с именами, отличными от ANSI.
- `Пример.txt`
- `一个例子.txt`
- `例です.txt`

Предположим, что вы используете режим CLI или API phpMussel для сканирования.

При использовании PHP < 7.1.0, в некоторых системах, phpMussel не будет видеть эти файлы при попытке сканирования каталога и, следовательно, не сможет сканировать эти файлы. Вероятно, вы увидите те же результаты, что и при сканировании пустого каталога:

```
 Sun, 01 Apr 2018 22:27:41 +0800 Начало работы.
 Sun, 01 Apr 2018 22:27:41 +0800 Готово.
```

Дополнительно, при использовании PHP < 7.1.0, сканирование файлов по отдельности приводит к таким результатам:

```
 Sun, 01 Apr 2018 22:27:41 +0800 Начало работы.
 > Проверить 'X:/directory/Пример.txt' (FN: b831eb8f):
 -> Неверный файл!
 Sun, 01 Apr 2018 22:27:41 +0800 Готово.
```

Или эти:

```
 Sun, 01 Apr 2018 22:27:41 +0800 Начало работы.
 > X:/directory/??????.txt не файл или каталог.
 Sun, 01 Apr 2018 22:27:41 +0800 Готово.
```

Это связано с тем, как PHP обрабатывал имена файлов, отличных от ANSI, до PHP 7.1.0. Если у вас возникла эта проблема, решение состоит в том, чтобы обновить вашу установку PHP до 7.1.0 или новее. В PHP >= 7.1.0, имена файлов, которые не являются ANSI, обрабатываются лучше, и phpMussel должен иметь возможность правильно сканировать файлы.

Для сравнения, результаты при попытке сканирования каталога с помощью PHP >= 7.1.0:

```
 Sun, 01 Apr 2018 22:27:41 +0800 Начало работы.
 -> Проверить '\Пример.txt' (FN: b2ce2d31; FD: 27cbe813):
 --> Проблемы не найдены.
 -> Проверить '\一个例子.txt' (FN: 50debed5; FD: 27cbe813):
 --> Проблемы не найдены.
 -> Проверить '\例です.txt' (FN: ee20a2ae; FD: 27cbe813):
 --> Проблемы не найдены.
 Sun, 01 Apr 2018 22:27:41 +0800 Готово.
```

И попытаться отсканировать файлы по отдельности:

```
 Sun, 01 Apr 2018 22:27:41 +0800 Начало работы.
 > Проверить 'X:/directory/Пример.txt' (FN: b831eb8f; FD: 27cbe813):
 -> Проблемы не найдены.
 Sun, 01 Apr 2018 22:27:41 +0800 Готово.
```

#### <a name="BLACK_WHITE_GREY"></a>Черные списки – Белые списки – Серые списки – Каковы они и как их использовать?

Термины передают различные значения в разных контекстах. В phpMussel существуют три контекста, в которых используются эти термины: Ответ размер файла, ответ тип файла, и серые списки сигнатуры.

Для достижения желаемого результата при минимальных затратах на обработку, есть некоторые простые вещи, которые phpMussel может проверить до фактического сканирования файлов, такие как размер, имя и расширение файла. Например; Если файл слишком велик, или если его расширение указывает тип файла, который мы не хотим разрешать на наших веб-сайтах, мы можем немедленно пометить файл и не нужно его сканировать.

Ответ размер файла: Так реагирует phpMussel, когда файл превышает указанный предел. Никаких фактических списков не задействован, но файл может считаться эффективно занесенным в черный список, белый список, или серый список, в зависимости от его размера. Существуют две отдельные опциональные директивы конфигурации для указания предела и желаемого ответа соответственно.

Ответ тип файла: Так реагирует phpMussel на расширение файла. Существуют три отдельные опциональные директивы конфигурации, позволяющие явно указывать, какие расширения должны быть занесены в черный список, белый список, или серый список. Файл может считаться эффективно занесенным в черный список, белый список, или серый список, если его расширение соответствует любому из указанных расширений соответственно.

В этих двух контекстах, включение в белый список означает, что оно не должно сканироваться или пометить; включение в черный список означает, что оно должно быть пометито (и поэтому нам не нужно сканировать его); и включение в серый список означает, требуется дальнейший анализ, чтобы определить, следует ли его пометить (то есть, он должен быть отсканирован).

Серые списки сигнатуры: Список сигнатурей, которые следует по существу игнорировать (это кратко упоминается ранее в документации). Когда срабатывает сигнатуры в серый список, phpMussel продолжает работать через свои сигнатуры и не предпринимает особых действий в отношении сигнатуры на серый список. Нет черного списка сигнатур, потому что подразумеваемое поведение то же самое как нормальное поведение для инициированных сигнатурей в любом случае, и нет белого списка сигнатур, потому что подразумеваемое поведение не имеет особого смысла в отношении того, как работает phpMussel и функциональность, которая уже существует.

Серый список: Полезен, если вам нужно разрешить проблемы, вызванные конкретной сигнатурой, без отключения или удаления всего файла сигнатуры.

#### <a name="CHANGE_COMPONENT_SORT_ORDER"></a>Когда я активирую или деактивирую файлы сигнатуры на странице обновлений, он сортирует их по алфавиту в конфигурации. Могу ли я изменить способ сортировки?

Да. Если вам нужно заставить некоторые файлы выполнить в определенном порядке, вы можете добавить некоторые произвольные данные до их имен в директиве конфигурации, где они указаны, разделенные двоеточием. Когда страница обновлений впоследствии сортирует файлы снова, эти добавленные произвольные данные будут влиять на порядок сортировки, в результате чего они должны выполняться в том порядке, в котором вы хотите, без необходимости переименовывать их.

Например, предполагая конфигурационную директиву с файлами, перечисленными ниже:

`file1.php,file2.php,file3.php,file4.php,file5.php`

Если вы хотите, чтобы `file3.php` выполнялся первым, вы могли бы добавить что-то вроде `aaa:` перед именем файла:

`file1.php,file2.php,aaa:file3.php,file4.php,file5.php`

Затем, если новый файл, `file6.php`, активирован, когда страница обновлений снова сортирует их все, это должно закончиться следующим образом:

`aaa:file3.php,file1.php,file2.php,file4.php,file5.php,file6.php`

Такая же ситуация, когда файл деактивирован. Наоборот, если вы хотите, чтобы файл выполнялся последним, вы могли бы добавить что-то вроде `zzz:` перед именем файла. В любом случае вам не нужно будет переименовывать указанный файл.

---


### 11. <a name="SECTION11"></a>ЛЕГАЛЬНАЯ ИНФОРМАЦИЯ

#### 11.0 ПРЕАМБУЛА РАЗДЕЛА

Этот раздел документации предназначен для описания возможных юридических соображений, касающихся использования и реализации пакета, и предоставления некоторой базовой связанной информации. Это может быть важно для некоторых пользователей в качестве средства обеспечения соответствия любым юридическим требованиям, которые могут существовать в странах, в которых они работают, и некоторым пользователям, возможно, придется корректировать свои политики веб-сайта в соответствии с этой информацией.

Прежде всего, поймите, что я (автор пакета) не квалифицированный юрист любого рода. Поэтому я не имею юридической силы для предоставления юридических консультаций. Кроме того, в некоторых случаях, точные законодательные требования могут различаться между различными странами и юрисдикциями, и эти различные юридические требования могут иногда противоречить (таких как, например, в случае стран, которые поддерживают права на [неприкосновенность частной жизни](https://ru.wikipedia.org/wiki/%D0%9D%D0%B5%D0%BF%D1%80%D0%B8%D0%BA%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C_%D1%87%D0%B0%D1%81%D1%82%D0%BD%D0%BE%D0%B9_%D0%B6%D0%B8%D0%B7%D0%BD%D0%B8), и [право быть забытым](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B0%D0%B2%D0%BE_%D0%BD%D0%B0_%D0%B7%D0%B0%D0%B1%D0%B2%D0%B5%D0%BD%D0%B8%D0%B5), по сравнению с странами, которые предпочитают [расширенное хранение данных](https://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%BA%D0%BE%D0%BD_%D0%AF%D1%80%D0%BE%D0%B2%D0%BE%D0%B9)). Учтите также, что доступ к пакету не ограничивается конкретными странами или юрисдикциями, и, следовательно, пользовательская база пакетов, вероятно, будет географически разнообразной. При рассмотрении этих вопросов, я не в состоянии заявить, что это означает быть «юридически совместимым» для всех пользователей, во всех отношениях. Однако я надеюсь, что приведенная здесь информация поможет вам самим принять решение о том, что вы должны сделать, чтобы оставаться юридически совместимым в контексте пакета. Если у вас есть какие-либо сомнения относительно информации, или если вам нужна дополнительная помощь и рекомендации с юридической точки зрения, Я бы рекомендовал обратиться к квалифицированному юристу.

#### 11.1 ОТВЕТСТВЕННОСТЬ

В соответствии с уже заявленной лицензией на пакет, пакет предоставляется без каких-либо гарантий. Это включает (но не ограничивается) всю сферу ответственности. Пакет предоставляется вам для вашего удобства, в надежде, что он будет полезен, и что он принесет вам определенную пользу. Однако, независимо от того, используете ли вы или реализуете пакет, это ваш собственный выбор. Вы не обязаны использовать или внедрять пакет, но когда вы это делаете, вы несете ответственность за это решение. Ни я, ни другие участники пакета не несут юридическую ответственность за последствия решений, которые вы принимаете, независимо от того, являются ли они прямыми, косвенными, подразумеваемыми или нет.

#### 11.2 ТРЕТЬИ ЛИЦА

В зависимости от его точной конфигурации и реализации пакет может передавать и обмениваться информацией с третьими лицами в некоторых случаях. Эта информация может быть определена как «[персональные данные](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D1%81%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5)» (PII/ПИИ) в некоторых контекстах, в некоторых юрисдикциях.

Как эта информация может использоваться этими третьими лицами, зависит от различных политик, установленных этими третьими лицами, и выходит за рамки этой документации. Однако, во всех таких случаях обмен информацией с этими третьими лицами может быть отключен. Во всех таких случаях, если вы решите включить его, вы несете ответственность за исследование любых проблем, которые могут возникнуть в отношении конфиденциальности, безопасности и использования PII/ПИИ этими третьими лицами. Если существуют какие-либо сомнения, или если вы неудовлетворены действиями этих третьих сторон в отношении PII/ПИИ, лучше всего отключить весь обмен информацией с этими третьими лицами.

В целях прозрачности тип информации, совместно используемой, и с кем, описан ниже.

##### 11.2.0 ВЕБ ФОНТЫ

Некоторые пользовательские темы, а также стандартный «UI» (пользовательский интерфейс) для фронтенд phpMussel и страница «Загрузка Отказана» могут использовать веб фонты по эстетическим соображениям. Веб фонты отключен по умолчанию, но когда он включен, происходит прямая связь между браузером пользователя и сервисом, на котором размещаются веб-сайты. Это может потенциально включать в себя передачу информации, такой как IP-адрес пользователя, пользовательский агент, операционная система и другие данные, доступные для запроса. Большинство этих веб фонтов размещены службой [Google Fonts](https://fonts.google.com/).

*Соответствующие директивы конфигурации:*
- `general` -> `disable_webfonts`

##### 11.2.1 СКАНЕР URL

URL-адреса, найденные в файлах, могут быть переданы API hpHosts или API Google Safe Browsing, в зависимости от того, как настроен пакет. В случае API hpHosts, это поведение включено по умолчанию. Для правильной работы API Google Safe Browsing требуется использовать ключи API, поэтому по умолчанию он отключен.

*Соответствующие директивы конфигурации:*
- `urlscanner` -> `lookup_hphosts`
- `urlscanner` -> `google_api_key`

##### 11.2.2 VIRUS TOTAL

Когда phpMussel сканирует загрузку файла, хэши этих файлов могут использоваться совместно с API Total Virus, в зависимости от того, как настроен пакет. Планируется также возможность совместного использования файлов в определенный момент в будущем, но эта функция не поддерживается пакетом в настоящее время. API Virus Total требуется ключ API для правильной работы, и поэтому отключен по умолчанию.

Информация (включая файлы и связанные метаданные файлов), отправленные в Virus Total, также могут быть отправлены их партнерам, аффилированным и другим в исследовательских целях. Это более подробно описано в их политике конфиденциальности.

*Видеть: [Privacy Policy &ndash; VirusTotal](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy).*

*Соответствующие директивы конфигурации:*
- `virustotal` -> `vt_public_api_key`

#### 11.3 ЖУРНАЛОВ

Журналов (альтернативно: регистрация, логгинг) – Это важная часть phpMussel по ряду причин. Без регистрируются может быть трудно диагностировать ложные-срабатывания, чтобы точно определить, насколько эффективный phpMussel в любом конкретном контексте, и может быть трудно определить, где его недостатки могут быть, и какие изменения могут потребоваться для его конфигурации или сигнатуры соответственно, чтобы он продолжал функционировать по назначению. Несмотря на это, регистрация может быть нежелательна для всех пользователей и остается полностью необязательной. Несмотря на это, регистрация может быть нежелательна для всех пользователей и остается полностью необязательной. В phpMussel регистрация по умолчанию отключена. Чтобы включить его, phpMussel должен быть настроен соответствующим образом.

Дополнительно, ли ведение журнала разрешено законом, и в какой степени (например, типы информации, которые могут быть зарегистрированы, как долго, и при каких обстоятельствах), может варьироваться в зависимости от юрисдикции и контекста, в котором реализуется phpMussel (например, если вы работаете как индивидуальный лицо, корпоративный лицо, если вы работаете на коммерческой или некоммерческой основе). Поэтому это может быть полезно для вас внимательно прочитать этот раздел.

phpMussel может выполнять несколько типов ведения журнала. Различные типы ведения журнала включают различные типы информации по разным причинам.

##### 11.3.0 СКАНИРОВАНИЕ ЖУРНАЛОВ

Когда включено в конфигурации пакета, phpMussel хранит журналы файлов, которые он сканирует. Этот тип ведения журнала доступен в двух разных форматах:
- Человекочитаемые лог-файлы.
- Сериализованные лог-файлы.

Записи в человекочитаемые лог-файлы обычно выглядят примерно так (в качестве примера):

```
Mon, 21 May 2018 00:47:58 +0800 Начало работы.
> Проверить 'ascii_standard_testfile.txt' (FN: ce76ae7a; FD: 7b9bfed5):
-> Обнаружено phpMussel-Testfile.ASCII.Standard!
Mon, 21 May 2018 00:48:04 +0800 Готово.
```

Запись журнала сканирования обычно включает следующую информацию:
- Дата и время сканирования файла.
- Имя сканируемого файла.
- CRC32b хеши имени и содержимого файла.
- Что было обнаружено в файле (если что-то было обнаружено).

*Соответствующие директивы конфигурации:*
- `general` -> `scan_log`
- `general` -> `scan_log_serialized`

Когда эти директивы остаются пустыми, этот тип ведения журнала останется отключенным.

##### 11.3.1 ЗАБЛОКИРОВАННЫЕ ЗАГРУЗКИ

Когда включено в конфигурации пакета, phpMussel сохраняет журналы заблокированных загрузок.

Записи в этом типе файла журнала обычно выглядят примерно так (в качестве примера):

```
Дата: Mon, 21 May 2018 00:47:56 +0800
IP-адрес: 127.0.0.1
== Результаты сканирования (почему помечены) ==
Обнаружено phpMussel-Testfile.ASCII.Standard (ascii_standard_testfile.txt)!
== Реконструкция хэш-сигнатур ==
3ed8a00c6c498a96a44d56533806153c:666:ascii_standard_testfile.txt
Помещен на карантин в «/vault/quarantine/0000000000-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.qfu».
```

Запись обычно включает следующую информацию:
- Дата и время, когда загрузка была заблокирована.
- IP-адрес, из которого произошла загрузка.
- Причина, по которой файл был заблокирован (что было обнаружено).
- Имя файла заблокировано.
- MD5 и размер файла заблокированы.
- Был ли файл помещен в карантин и под каким внутренним именем.

*Соответствующие директивы конфигурации:*
- `general` -> `scan_kills`

##### 11.3.2 ФРОНТЕНД ЖУРНАЛОВ

Этот тип ведения журнала связан с попытками входа в фронтенд и возникает только тогда, когда пользователь пытается войти в фронтенд (при условии, что фронтенд включен).

Эти записи журнала содержат IP-адрес пользователя, пытающегося войти в систему, дату и время совершения попытки, и результаты попытки (успешно вошел в систему или не смог войти в систему). Обычно они выглядят примерно так (в качестве примера):

```
x.x.x.x - Day, dd Mon 20xx hh:ii:ss +0000 - "admin" - Вошли в систему.
```

*Соответствующие директивы конфигурации:*
- `general` -> `frontend_log`

##### 11.3.3 ВРАЩЕНИЕ ЖУРНАЛА

Возможно, вы захотите очистить журналы через определенный промежуток времени или, возможно, потребуется сделать это по закону (то есть, количество времени, которое законно допустимо для вас сохранять журналы, может быть ограничено законом). Вы можете достичь этого, включив маркеры даты/времени в имена ваших файлов журналов в соответствии с настройками вашего пакета (например, `{yyyy}-{mm}-{dd}.log`), и затем разрешить вращение журнала (поворот журнала позволяет выполнять некоторые действия на лог-файлах при превышении указанных пределов).

Например: Если мне было необходимо закончить журналы через 30 дней, я мог бы указать `{dd}.log` в именах моих лог-файлов (`{dd}` представляет дни), установить значение `log_rotation_limit` в 30, и установить значение `log_rotation_action` в `Delete`.

И наоборот, если вам необходимо сохранять журналы в течение длительного периода времени, вы можете либо не использовать поворот журнала вообще, либо вы можете установить значение `log_rotation_action` в `Archive`, чтобы сжать лог-файлы, тем самым уменьшив общий объем занимаемого ими дискового пространства.

*Соответствующие директивы конфигурации:*
- `general` -> `log_rotation_limit`
- `general` -> `log_rotation_action`

##### 11.3.4 УСЕЧЕНИЕ ЖУРНАЛА

Также возможно обрезать отдельные лог-файлы, если они превышают определенный размер, если это то, что вы хотите/нуждаетесь сделать.

*Соответствующие директивы конфигурации:*
- `general` -> `truncate`

##### 11.3.5 ПСЕВДОНИМИЗАЦИЯ IP-АДРЕСА

Во-первых, если вы не знакомы с термином, «псевдонимизация» относится к обработке персональных данных таким образом, что она не может быть идентифицирована ни с каким конкретным объектом данных без дополнительной информации, и при условии, что такая дополнительная информация поддерживается отдельно и подлежит техническим и организационным мерам для обеспечения того, чтобы личные данные не могли быть идентифицированы ни одному физическому лицу.

В некоторых случаях вам может быть юридически требуется анонимизировать или псевдонимизировать любого PII/ПИИ, собранного, обработанного, или сохраненного. Хотя эта концепция существует уже довольно давно, GDPR/DSGVO особенно упоминает и специально поощряет «псевдонимизация».

phpMussel может псевдонимизировать IP-адреса при входе в журналы, если это то, что вы хотите/нуждаетесь сделать. Когда phpMussel псевдонимизирует IP-адреса, при входе в журналы, окончательный октет адресов IPv4, и все после второй части адресов IPv6 представлено символом «x» (эффективно округляя адреса IPv4 до начального адреса 24-й подсети, в которую они входят, и адреса IPv6 на начальный адрес 32-й подсети, в которую они входят).

*Соответствующие директивы конфигурации:*
- `legal` -> `pseudonymise_ip_addresses`

##### 11.3.6 СТАТИСТИКА

phpMussel по желанию может отслеживать статистику, такую как общее количество файлов, отсканированных и заблокированных с определенного момента времени. Эта функция отключена по умолчанию, но можно включить с помощью конфигурации пакета. Тип отслеживаемой информации не должен рассматриваться как PII/ПИИ.

*Соответствующие директивы конфигурации:*
- `general` -> `statistics`

##### 11.3.7 ШИФРОВАНИЕ

phpMussel не шифрует свой кеш или какую-либо информацию журнала. [Шифрование](https://ru.wikipedia.org/wiki/%D0%A8%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5) кеша и журналов могут быть введены в будущем, но в настоящее время нет конкретных планов. Если вы обеспокоены тем, что несанкционированные сторонние лица получают доступ к частям phpMussel, которые могут содержать PII/ПИИ или конфиденциальную информацию, такую как ее кеш или журналы, я бы рекомендовал, чтобы phpMussel не был установлен в общедоступном месте (например, установить phpMussel за пределами стандартного каталога `public_html` или его эквивалента, доступного большинству стандартных веб-серверов) и я рекомендую применять соответствующие ограничительные разрешения для каталога установки (в частности, для каталога «vault»). Если этого недостаточно для решения ваших проблем, настройте phpMussel таким образом, чтобы типы информации, вызывающие ваши проблемы, не собирались или не регистрировались в первую очередь (например, путем отключения ведения журнала).

#### 11.4 КУКИ

Когда пользователь успешно входит в фронтенд, phpMussel устанавливает [куки](https://ru.wikipedia.org/wiki/Cookie), чтобы иметь возможность запоминать пользователя для последующих запросов (то есть, куки используются для аутентификации пользователя в сеансе фронтенд). На странице входа в систему предупреждения куки отображаются на видном месте, предупреждающее пользователя о том, что куки будет установлен, если они участвуют в соответствующем действии. Куки не установлены ни в одном другом месте в кодовой базе.

*Соответствующие директивы конфигурации:*
- `general` -> `disable_frontend`

#### 11.5 МАРКЕТИНГ И РЕКЛАМА

phpMussel не собирает и не обрабатывает какую-либо информацию для маркетинговых или рекламных целей и не продает и не получает прибыль от любой собранной или занесенной в журнал информации. phpMussel не коммерческим предприятием и не имеет отношения к каким-либо коммерческим интересам, поэтому делать это не имеет смысла. Это имело место с самого начала проекта и по-прежнему имеет место сегодня. Кроме того, делать эти вещи было бы контрпродуктивным для духа и намеченной цели проекта в целом, и до тех пор, пока я продолжаю поддерживать проект, никогда не произойдет.

#### 11.6 ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ

В некоторых случаях вам может быть юридически необходимо четко отображать ссылку на вашу политику конфиденциальности на всех страницах и разделах вашего сайта. Это может быть важно как средство обеспечения того, чтобы пользователи были хорошо информированы о ваших точных правилах конфиденциальности, типах PII/ПИИ, которые вы собираете, и о том, как вы собираетесь их использовать. Чтобы иметь возможность включить такую ссылку на странице phpMussel «Загрузка Отказана», предоставляется директива конфигурации для указания URL-адреса вашей политики конфиденциальности.

*Соответствующие директивы конфигурации:*
- `legal` -> `privacy_policy`

#### 11.7 GDPR/DSGVO

«Общее Регулирование Защиты Данных» – Это регламент Европейского Союза, который вступает в силу с 25 Мая 2018 года. Основная цель регулирования – Дать контроль гражданам и жителям ЕС в отношении их личных данных, и унифицировать регулирование в ЕС относительно конфиденциальности и личных данных.

Регулирование содержит конкретные положения, касающиеся обработки «[личной идентифицируемой информации](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D1%81%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5)» (PII/ПИИ) любых «субъектов данных», (любое идентифицированное или идентифицируемое физическое лицо) из или в пределах ЕС. Чтобы соответствовать регулированию, «предприятия» (согласно определению, указанным в регулирование), и любые соответствующие системы и процессы должны реализовать «конфиденциальность по дизайну» по умолчанию, должны использовать максимально возможные настройки конфиденциальности, должны обеспечивать необходимые гарантии для любой сохраненной или обработанной информации (включая, но не ограничиваясь, внедрение псевдонимизированный или полную анонимизированный данных), должны четко и недвусмысленно объявлять типы собираемых ими данных, как они обрабатывают его, по каким причинам, как долго они его сохраняют, и делится ли они этими данными с любыми третьими лицами, типами данных, совместно используемыми с третьими лицами, как, почему, и т.д.

Данные не могут быть обработаны, если нет законных оснований для этого, в соответствии с определением правила. Как правило, это означает, что для обработки данных субъекта данных на законной основе, это должно выполняться в соответствии с юридическими обязательствами, или только после того, как явное, хорошо информированное, однозначное согласие было получено от субъекта данных.

Поскольку аспекты регулирования могут развиваться во времени, чтобы избежать распространения устаревшей информации, лучше узнать о регулировании из авторитетного источника, а не просто включать соответствующую информацию в документацию к пакету (которые в конечном итоге могут устареть, поскольку регулирование развивается).

Некоторые рекомендуемые ресурсы для получения дополнительной информации:
- [Новый европейский регламент по защите данных – последствия для российских организаций](https://www.buzko.legal/content-ru/general-data-protection-regulation)
- [GDPR — новые правила обработки персональных данных в Европе для международного IT-рынка](https://habr.com/company/digitalrightscenter/blog/344064/)
- [Общий регламент по защите данных](https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%89%D0%B8%D0%B9_%D1%80%D0%B5%D0%B3%D0%BB%D0%B0%D0%BC%D0%B5%D0%BD%D1%82_%D0%BF%D0%BE_%D0%B7%D0%B0%D1%89%D0%B8%D1%82%D0%B5_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85)
- [REGULATION (EU) 2016/679 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32016R0679)

---


Последнее обновление: 23 Сентябрь 2019 (2019.09.23).
