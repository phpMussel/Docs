## phpMusselのドキュメンテーション（日本語）。

### 目次
- １.[序文](#SECTION1)
- ２.[インストール方法](#SECTION2)
- ３.[使用方法](#SECTION3)
- ４.[フロントエンドの管理](#SECTION4)
- ５.[ＣＬＩ（コマンドライン・インターフェイス）](#SECTION5)
- ６.[本パッケージに含まれるファイル](#SECTION6)
- ７.[コンフィギュレーション（設定オプション）](#SECTION7)
- ８.[シグネチャ（署名）フォーマット](#SECTION8)
- ９.[適合性問題](#SECTION9)
- １０.[よくある質問（ＦＡＱ）](#SECTION10)
- １１.[法律情報](#SECTION11)

*翻訳についての注意：エラーが発生した場合（例えば、​翻訳の間の不一致、​タイプミス、​等等）、​READMEの英語版が原本と権威のバージョンであると考えられます。​誤りを見つけた場合は、​それらを修正するにご協力を歓迎されるだろう。​*

---


### １.<a name="SECTION1"></a>序文

phpMussel（ピー・エイチ・ピー・マッスル）をご利用頂き、​ありがとうございます。​phpMusselは、​ClamAV をはじめとしたシグネチャを利用して、​システムにアップロードされるファイルを対象して、​トロイ型のウィルスやマルウェア等を検出するようデザインされたPHPスクリプトです。

[PHPMUSSEL](https://phpmussel.github.io/)著作権２０１３とＧＮＵ一般公衆ライセンスv2を超える権利について：​[Caleb M (Maikuolan)](https://github.com/Maikuolan)著。

本スクリプトはフリーウェアです。​フリーソフトウェア財団発行のＧＮＵ一般公衆ライセンス・バージョン２（またはそれ以降のバージョン）に従い、​再配布ならびに加工が可能です。​配布の目的は、​役に立つことを願ってのものですが、​『保証はなく、​また商品性や特定の目的に適合するのを示唆するものでもありません』。​『LICENSE.txt』にある『GNU General Public License』（一般ライセンス）を参照して下さい。​以下のURLからも閲覧できます：
- <https://www.gnu.org/licenses/>。
- <https://opensource.org/licenses/>。

作成のインスピレーションと本スクリプトが利用するシグネチャについて[ClamAV](https://www.clamav.net/)に感謝の意を表したいと思います。​この２つがなければ、​本スクリプトは存在しえないか、​あるいは極めて限られた利用価値しかもたないと言ってよいでしょう。

本プロジェクトファイルのホスト先であるSourceForgeとBitbucketとGitHub、​phpMusselが利用するシグネチャの提供先である：​[PhishTank](https://www.phishtank.com/)、​[NLNetLabs](https://nlnetlabs.nl/)、​[Malware.Expert](https://malware.expert/) 他、​本プロジェクトを支援して下さった全ての方々に感謝の意を表したいと思います。

本ドキュメントならびに関連パッケージは以下のＵＲＬからダウンロードできます。
- [GitHub](https://github.com/phpMussel/phpMussel)。
- [Bitbucket](https://bitbucket.org/Maikuolan/phpmussel)。
- [SourceForge](https://sourceforge.net/projects/phpmussel/)。

---


### ２.<a name="SECTION2"></a>インストール方法

#### 2.0 手動インストール（ウェブサーバー編）

１） 本項を読んでいるということから、​アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。​ホストあるいはＣＭＳに`/public_html/phpmussel/`のようなディレクトリを作り、​ローカルマシンからそこにコンテンツをアップロードするのが次のステップです。​アップロード先のディレクトリ名や場所については、​安全でさえあれば、​もちろん制約などはありませんので、​自由に決めて下さい。

２） `config.ini`に`config.ini.RenameMe`の名前を変更します（`vault`の内側に位置する）。​オプションの修正のため（初心者には推奨できませんが、​経験が豊富なユーザーには強く推奨します）、​それを開いて下さい（本ファイルはphpMusselが利用可能なディレクティブを含んでおり、​それぞれのオプションについての機能と目的に関した簡単な説明があります）。​セットアップ環境にあわせて、​適当な修正を行いファイルを保存して下さい。

３） コンテンツ（phpMussel本体とファイル）を先に定めたディレクトリにアップロードします。​（`*.txt`や`*.md`ファイルはアップロードの必要はありませんが、​大抵は全てをアップロードしてもらって構いません）。

４） `vault`ディレクトリは「７５５」にアクセス権変更します（問題がある場合は、​「７７７」を試すことができます；これは、​しかし、​安全ではありません）。​コンテンツをアップロードしたディレクトリそのものは、​通常特に何もする必要ありませんが、​過去にパーミッションで問題があった場合、​CHMODのステータスは確認しておくと良いでしょう。​（デフォルトでは「７５５」が一般的です）。​要するに：パッケージが正しく動作するためには、ＰＨＰは「vault」ディレクトリ内でファイルを読み書きできる必要があります。​ＰＨＰは「vault」ディレクトリに書き込めない場合、多くのことが（アップデイト、ロギング、など）可能になりません。​ＰＨＰは「vault」ディレクトリから読み込めない場合、パッケージはまったく動作しません。​最適なセキュリティのためには、「vault」ディレクトリは公にアクセス可能であってはいけません（「vault」ディレクトリが公にアクセス可能な場合、「config.ini」や「frontend.dat」に含まれる情報などの機密情報は潜在的な攻撃者にさらされる可能性があります）。

５） あなたが必要とするシグネチャをインストールしてください。 参照：​[シグネチャ・インストール](#INSTALLING_SIGNATURES)。

６） 次に、​システム内あるいはＣＭＳにphpMusselをフックします。​方法はいくつかありますが、​最も容易なのは、​`require`や`include`でスクリプトをシステム内またはＣＭＳのコアファイルの最初の部分に記載する方法です。​（コアファイルとは、​サイト内のどのページにアクセスがあっても必ずロードされるファイルのことです）。​一般的には、​`/includes`や`/assets`や`/functions`のようなディレクトリ内のファイルで、​`init.php`、​`common_functions.php`、​`functions.php`といったファイル名が付けられています。​実際にどのファイルなのかは、​見つけてもうらう必要があります。​よく分からない場合は、​phpMusselサポートフォーラムを参照するか、​またはGitHubのでphpMusselの問題のページ、​あるいはお知らせください（ＣＭＳ情報必須）。​私自身を含め、​ユーザーの中に類似のＣＭＳを扱った経験があれば、​何かしらのサポートを提供できます。​コアファイルが見つかったなら、​「`require`か`include`を使って」以下のコードをファイルの先頭に挿入して下さい。​ただし、​クォーテーションマークで囲まれた部分は`loader.php`ファイルの正確なアドレス（HTTPアドレスでなく、​ローカルなアドレス。​前述のvaultのアドレスに類似）に置き換えます。

`<?php require '/user_name/public_html/phpmussel/loader.php'; ?>`

ファイルを保存して閉じ、​再アップロードします。

-- 他の手法 --

Apacheウェブサーバーを利用していて、​かつ`php.ini`を編集できるようであれば、​`auto_prepend_file`ディレクティブを使って、​ＰＨＰリクエストがあった場合にはいつもphpMusselを先頭に追加するようにすることも可能です。​以下に例を挙げます。

`auto_prepend_file = "/user_name/public_html/phpmussel/loader.php"`

あるいは、​`.htaccess`において：

`php_value auto_prepend_file "/user_name/public_html/phpmussel/loader.php"`

７） これでインストールは完了ですが、​念のために、​テストを行いましょう。​不正ファイルアップロード保護機能をテストするには、​パッケージ内の`_testfiles`に含まれているテスト・ファイルをブラウザを使った通常の方法でアップロードします。​（テスト・ファイルがトリガーするようにするためには、`phpmussel*.*db`シグネチャ・ファイルを`active`コンフィグレーション・ディレクティブに含めたことを確認してください）。​問題がなければ、​phpMusselからアップロードをブロックしたとのメッセージが表示され、​そうでない場合は何かが正常に機能していません。​また、​もし何かしら特殊な機能を使っている、​ないしは他のタイプのスキャニングも使っているようであれば、​相互に影響があるかないかもチェックしておく方が良いでしょう。

#### 2.1 手動インストール（ＣＬＩ編）

１） 本項を読んでいるということから、​アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。​phpMusselの保存場所が決まったら、​次へ進んで下さい。

２） phpMusselを使うには、​ＰＨＰがホストマシンにインストールされている必要があります。​もし、​まだであれば、​各種ＰＨＰインストーラーのどれを使っても構いませんので、​インストールして下さい。

３） オプションの修正のため（初心者には推奨できませんが、​経験が豊富なユーザーには強く推奨します）。​`vault`内の`config.ini`を開いて下さい。​本ファイルはphpMusselが利用可能なディレクティブを含んでおり、​それぞれのオプションについての機能と目的に関した簡単な説明があります。​セットアップ環境にあわせて、​適当な修正を行いファイルを保存して下さい。

４） オプションですが、​バッチファイルを作成することにより、​phpMusselのＣＬＩモードでの使用を容易にすることができます。​バッチファイルはＰＨＰとphpMusselを自動的にロードするものです。​まず、​Notepadか Notepad++のようなテキストエディタを開いて下さい。​そして、​インストールしたＰＨＰの`php.exe`の絶対パス、​半角スペース、​`loader.php`の絶対パスをタイプして、​拡張子「.bat」でファイルを目につくところに保存します。​このファイルをダブルクリックすることでphpMusselを起動することができます。

５） あなたが必要とするシグネチャをインストールしてください。 参照：​[シグネチャ・インストール](#INSTALLING_SIGNATURES)。

６） テストを行いましょう。​パッケージ内の`_testfiles`をphpMusselでスキャンしてみて下さい。

#### 2.2 COMPOSERを使用してインストールする

[phpMusselはPackagistに登録されています](https://packagist.org/packages/phpmussel/phpmussel)。​Composerを使い慣れている場合は、​Composerを使用してphpMusselをインストールできます （但し、あなたはコンフィギュレーション、CHMODパーミッション、シグネチャとフックを準備する必要があります。​「手動インストール（ウェブサーバー編）」の手順２、４、５と６を参照してください）。

`composer require phpmussel/phpmussel`

#### <a name="INSTALLING_SIGNATURES"></a>2.3 シグネチャ・インストール

`v1.0.0`以降、シグネチャはphpMusselパッケージには含まれていません。​特定の脅威を検出するためには、phpMusselによってシグネチャが必要です。​シグネチャをインストールする主な方法は３つあります。

1. フロントエンドのアップデート・ページを使用して自動的にインストールします。
2. 「SigTool」を使用してシグネチャを生成し、手動でインストールします。
3. 「phpMussel/Signatures」からシグネチャをダウンロードし、手動でインストールします。

##### 2.3.1 フロントエンドのアップデート・ページを使用して自動的にインストールします。

まず、フロントエンドが有効になっていることを確認する必要があります。 *参照：[フロントエンドの管理](#SECTION4)。*

次に、フロントエンドのアップデート・ページに移動し、必要なシグネチャ・ファイルを見つける、その後、ページに用意されているオプションを使用して、インストールし、アクティブ化します。

##### 2.3.2 「SigTool」を使用してシグネチャを生成し、手動でインストールします。

*参照：[SigToolドキュメンテーション](https://github.com/phpMussel/SigTool#documentation)。*

##### 2.3.3 「phpMussel/Signatures」からシグネチャをダウンロードし、手動でインストールします。

まず、[phpMussel/Signatures](https://github.com/phpMussel/Signatures)に行く。​リポジトリには、​さまざまなＧＺ圧縮シグネチャ・ファイルが含まれています。​それらをインストールするには、​必要なファイルをダウンロードして解凍し、​解凍したファイルを`/vault/signatures`ディレクトリにコピーします。​それらをアクティブにするには、​コピーしたファイルの名前をphpMussel設定の`active`ディレクティブに列挙します。

---


### ３.<a name="SECTION3"></a>使用方法

#### 3.0 使用方法（ウェーブサーバー編）

phpMusselは特別な使用環境を必要としないスクリプトです。​一度インストールされれば、​充分に機能します。

デフォルトでは、​アップロードされたファイルのスキャンは自動的に行うように設定されています。​従って基本的に何もすることはありません。

ですが、​特定のファイル、​ディレクトリ、​アーカイブをスキャンするよう設定することも可能です。​`config.ini`を適切に設定し直して下さい（クリーンアップは無効でなくてはなりません）。​その後phpMusselがフックされているＰＨＰファイル内において、​以下のコードを使用します。

`$phpMussel['Scan']($what_to_scan, $output_type, $output_flatness);`

- `$what_to_scan` には、​文字列あるいは（多次元）配列を代入することができます。​どのファイル（一つないしは複数）あるいはディレクトリ（一つないしは複数）をスキャンすべきか指定します。
- `$output_type` はブーレアンで、​スキャン結果のフォーマットを指定できます。​`false`は結果を整数型で返します。​`true`（真）は結果をテキスト形式で返します。​どちらを選択しても、​スキャン後にグローバル変数によって結果にアクセスすることが可能です。​`$output_type`はオプションでデフォルト設定は`false`（偽）になっています。​次に、整数結果について説明します。

| 結果 | 説明 |
|---|---|
| ー４ | 暗号化のため、データをスキャンできませんでした。 |
| ー３ | phpMusselシグネチャ・ファイルで問題が発生したことを示します。 |
| ​ー２ | スキャン中に破損データを検出したためスキャン失敗。 |
| ー１ | ＰＨＰがスキャンに必要な拡張子あるいはアドオンがないためにスキャン失敗。 |
| ０ | スキャンの対象が存在しないこと。 |
| ​１ | 対象のスキャンを完了しかつ問題がないこと。 |
| ​２ | 対象のスキャンを完了しかつ問題を検出したことを意味します。 |

- `$output_flatness` はブーレアンで、​スキャン結果を配列で返すか、​文字列で返すかを指定します（対象が複数の場合）。​`false`（偽）は配列、​`true`（真）は文字列での返り値となります。​`$output_flatness`はオプションでデフォルト設定は`false`（偽）です。

例：

```PHP
 $results = $phpMussel['Scan']('/user_name/public_html/my_file.html', true, true);
 echo $results;
```

の場合、​返り値は：

```
 Wed, 16 Sep 2013 02:49:46 +0000 開始。
 > チェック '/user_name/public_html/my_file.html':
 -> 問題は検出されませんでした。
 Wed, 16 Sep 2013 02:49:47 +0000 完了。
```

phpMusselがどのようなシグネチャを使ったか等の詳細な情報については、​本ファイルのセクション『[シグネチャ（署名）フォーマット](#SECTION8)』を参照して下さい。

誤検出や新種の疑わしきものに遭遇した、​あるいはシグネチャに関することについては何でもお知らせ下さい。​そうすれば、​即時対応でき、​必要な修正を行うことができます。 *（参照する：​[「偽陽性」とは何ですか？​](#WHAT_IS_A_FALSE_POSITIVE)）。*

phpMusselに含まれるシグネチャを無効にするには（通常除かれるべきではないと考えられるものがブロックされてしまうような場合）、​それらの名前をグレーリスト・ファイルに追加する（`/vault/greylist.csv`）、カンマで区切られた。

*また見てください： [ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？](#SCAN_DEBUGGING)*

#### 3.1 使用方法（ＣＬＩ編）

本READMEファイルの「手動インストール（ＣＬＩ編）」を参照して下さい。

なお、​phpMusselを通常のウィルスソフトと混同しないで下さい。​アクティブメモリーを監視してウィルスを即時検出するものではありません（phpMusselは、​オンデマンドスキャナです；phpMusselは、​オンアクセススキャナではありません）。​指定されたファイルのみをスキャンし（また、​ファイルのアップロード）、​含まれるウィルスを検出します。

---


### ４.<a name="SECTION4"></a>フロントエンドの管理

#### 4.0 フロントエンドは何です。

フロントエンドは、​phpMusselのインストールを維持、​管理、​更新するための便利で簡単な方法を提供します。​ログページを使用してログ・ファイルを表示、​共有、​ダウンロードすることができます、​コンフィギュレーションページでコンフィギュレーションを変更できます、​アップデートページを使用してコンポーネントをインストールおよびアンインストールできます、​そして、​ファイル・マネージャーを使用してvault「ボールト」内のファイルをアップロード、​ダウンロード、​および変更することができます。

不正アクセスを防止するため、​フロントエンドはデフォルトで無効になっています​（不正アクセスがウェブサイトとそのセキュリティに重大な影響を与える可能性があります）。​それを可能にするための指示は、​このパラグラフの下に含まれています。

#### 4.1 フロントエンドを有効にする方法。

１） `config.ini`の中にある`disable_frontend`ディレクティブを探します、​それを「`false`」に設定します（デフォルトでは「`true`」です）。

２） ブラウザから`loader.php`にアクセスしてください（例えば、​`http://localhost/phpmussel/loader.php`）。

３） デフォルトのユーザー名とパスワードでログインする（admin/password）。

注意：あなたが初めてログインした後、​フロントエンドへの不正アクセスを防ぐために、​あなたはすぐにユーザー名とパスワードを変更する必要があります！​これは非常に重要です、​なぜなら、​フロントエンドから任意のＰＨＰコードをあなたのウェブサイトにアップロードすることができるからです。

また、最適なセキュリティを実現するには、すべてのフロントエンド・アカウントに対して「二要素認証」を有効にすることを強くお勧めします（下記の手順）。

#### 4.2 フロントエンドの使い方。

フロントエンドの各ページには、​目的の説明とその使用方法の説明があります。​詳しい説明や特別な支援が必要な場合は、​サポートにお問い合わせください。​また、​デモを提供するYouTube上で利用可能な動画もあります。

#### 4.3 ２ＦＡ（二要素認証）

２ＦＡ「二要素認証」を有効にすることで、フロントエンドをより安全にすることができます。​２ＦＡを使用するアカウントにログインすると、そのアカウントに関連付けられた電子Ｅメール・アドレスに電子Ｅメールが送信されます。​このＥメールには「２ＦＡコード」が含まれています。​このアカウントを使用してログインできるように、ユーザーはこの２ＦＡコードとユーザー名とパスワードを入力する必要があります。​つまり、アカウントのパスワードでは、ハッカーや潜在的な攻撃者がそのアカウントにログインするのに十分ではありません。​セッションに関連付けられた２ＦＡコードを受信して利用するには、そのアカウントに関連付けられた電子Ｅメールアドレスにアクセスする必要があります。

まず、２ＦＡを有効にするには、フロントエンドのアップデイト・ページを使用して、PHPMailerコンポーネントをインストールします。​phpMusselは、電子Ｅメールを送信するために、PHPMailerを利用します。​注意：phpMussel自体はPHP >= 5.4.0と互換性がありますが、PHPMailerにはPHP >= 5.5.0が必要です。​したがって、PHP 5.4ユーザーはphpMusselフロントエンドに２ＦＡを有効にすることはできません。

PHPMailerをインストールしたら、phpMusselコンフィギュレーション・ページまたはコンフィギュレーション・ファイルを使用して、PHPMailerのコンフィギュレーション・ディレクティブを設定する必要があります。​これらのコンフィギュレーション・ディレクティブの詳細については、このドキュメントのコンフィギュレーション・セクションに記載されています。​PHPMailerコンフィギュレーション・ディレクティブを設定したら、`enable_two_factor`を`true`に設定します。​２ＦＡが有効にされている。

次に、phpMusselがそのアカウントでログインする際に２ＦＡコードを送信する場所を知るように、電子Ｅメール・アドレスをアカウントに関連付ける必要があります。​これを行うには、電子Ｅメール・アドレスをアカウントのユーザー名として使用する（例えば、`foo@bar.tld`）か、電子Ｅメール・アドレスを通常どおり電子Ｅメールを送信する場合と同じ方法でユーザー名の一部として含めます（例えば、`Foo Bar <foo@bar.tld>`）。

注意：不正なアクセスからvaultを保護することは特に重要です（たとえば、サーバーのセキュリティを強化し、パブリック・アクセス許可を制限する）。​コンフィギュレーション・ファイル（あなたのvaultに保存されています）の不正なアクセスが送信SMTPコンフィギュレーションを公開する可能性があります（SMTPユーザー名とパスワードを含む）。​２ＦＡを有効にする前に、vaultが適切に保護されていることを確認する必要があります。​あなたがこれを行うことができない場合は、少なくとも、この目的のために専用の新しい電子Ｅメール・アカウントを作成する必要があります（公開されたSMTPコンフィギュレーションに関連するリスクを軽減するため）。

---


### ５.<a name="SECTION5"></a>ＣＬＩ（コマンドライン・インターフェイス）

phpMusselはウィンドウズベースのシステムでは、​ＣＬＩモードで対話式のファイルスキャナーとしても機能します。​詳細についてはインストール方法（ＣＬＩ編）を参照して下さい。

ＣＬＩプロンプトにて`c`とタイプしエンターを押せば、​利用可能なＣＬＩコマンドのリストが表示されます。

また、​興味のある人のために、​ＣＬＩモードでphpMusselを使用する方法のためのビデオチュートリアルは、​ここで提供されています：
- <https://youtu.be/H-Pa740-utc>

---


### ６.<a name="SECTION6"></a>本パッケージに含まれるファイル

```
https://github.com/phpMussel/phpMussel>v2
│   .gitattributes
│   .gitignore
│   .travis.php
│   .travis.yml
│   Changelog-v2.txt
│   composer.json
│   CONTRIBUTING.md
│   crowdin.yml
│   LICENSE.txt
│   loader.php
│   PEOPLE.md
│   README.md
│   SECURITY.md
│   web.config
│
├───.github
│       ISSUE_TEMPLATE.md
│
├───vault
│   │   .htaccess
│   │   channels.yaml
│   │   cli.php
│   │   components.dat
│   │   config.ini.RenameMe
│   │   config.php
│   │   config.yaml
│   │   event_handlers.php
│   │   frontend.php
│   │   frontend_functions.php
│   │   functions.php
│   │   greylist.csv
│   │   lang.php
│   │   plugins.dat
│   │   shorthand.yaml
│   │   signatures.dat
│   │   template_custom.html
│   │   template_default.html
│   │   themes.dat
│   │   upload.php
│   │
│   ├───cache
│   ├───classes
│   │   │   ArchiveHandler.php
│   │   │   CompressionHandler.php
│   │   │   TemporaryFileHandler.php
│   │   │
│   │   └───Maikuolan
│   │           Cache.php
│   │           ComplexStringHandler.php
│   │           DelayedIO.php
│   │           Demojibakefier.php
│   │           Events.php
│   │           L10N.php
│   │           NumberFormatter.php
│   │           YAML.php
│   │
│   ├───fe_assets
│   │       frontend.css
│   │       frontend.html
│   │       icons.php
│   │       pips.php
│   │       scripts.js
│   │       _2fa.html
│   │       _accounts.html
│   │       _accounts_row.html
│   │       _cache.html
│   │       _config.html
│   │       _config_row.html
│   │       _files.html
│   │       _files_edit.html
│   │       _files_rename.html
│   │       _files_row.html
│   │       _home.html
│   │       _login.html
│   │       _logs.html
│   │       _nav_complete_access.html
│   │       _nav_logs_access_only.html
│   │       _quarantine.html
│   │       _quarantine_row.html
│   │       _siginfo.html
│   │       _siginfo_row.html
│   │       _statistics.html
│   │       _updates.html
│   │       _updates_row.html
│   │       _upload_test.html
│   │
│   ├───lang
│   │       lang.ar.fe.yaml
│   │       lang.ar.yaml
│   │       lang.bn.fe.yaml
│   │       lang.bn.yaml
│   │       lang.de.fe.yaml
│   │       lang.de.yaml
│   │       lang.en.fe.yaml
│   │       lang.en.yaml
│   │       lang.es.fe.yaml
│   │       lang.es.yaml
│   │       lang.fr.fe.yaml
│   │       lang.fr.yaml
│   │       lang.hi.fe.yaml
│   │       lang.hi.yaml
│   │       lang.id.fe.yaml
│   │       lang.id.yaml
│   │       lang.it.fe.yaml
│   │       lang.it.yaml
│   │       lang.ja.fe.yaml
│   │       lang.ja.yaml
│   │       lang.ko.fe.yaml
│   │       lang.ko.yaml
│   │       lang.lv.fe.yaml
│   │       lang.lv.yaml
│   │       lang.nl.fe.yaml
│   │       lang.nl.yaml
│   │       lang.no.fe.yaml
│   │       lang.no.yaml
│   │       lang.pl.fe.yaml
│   │       lang.pl.yaml
│   │       lang.pt.fe.yaml
│   │       lang.pt.yaml
│   │       lang.ru.fe.yaml
│   │       lang.ru.yaml
│   │       lang.sv.fe.yaml
│   │       lang.sv.yaml
│   │       lang.th.fe.yaml
│   │       lang.th.yaml
│   │       lang.tr.fe.yaml
│   │       lang.tr.yaml
│   │       lang.ur.fe.yaml
│   │       lang.ur.yaml
│   │       lang.vi.fe.yaml
│   │       lang.vi.yaml
│   │       lang.zh-tw.fe.yaml
│   │       lang.zh-tw.yaml
│   │       lang.zh.fe.yaml
│   │       lang.zh.yaml
│   │
│   ├───plugins
│   ├───quarantine
│   └───signatures
│           switch.dat
│
└───_testfiles
        ascii_standard_testfile.txt
        coex_testfile.rtf
        exe_standard_testfile.exe
        general_standard_testfile.txt
        graphics_standard_testfile.gif
        html_standard_testfile.html
        md5_testfile.txt
        ole_testfile.ole
        pdf_standard_testfile.pdf
        pe_sectional_testfile.exe
        swf_standard_testfile.swf
```

---


### ７.<a name="SECTION7"></a>コンフィギュレーション（設定オプション）

以下は`config.ini`設定ファイルにある変数ならびにその目的と機能のリストです。

```
Configuration (v2)
│
├───general
│       cleanup
│       scan_log
│       scan_log_serialized
│       scan_kills
│       error_log
│       truncate
│       log_rotation_limit
│       log_rotation_action
│       timezone
│       time_offset (v1: timeOffset)
│       time_format (v1: timeFormat)
│       ipaddr
│       enable_plugins
│       forbid_on_block
│       delete_on_sight
│       lang
│       lang_override
│       numbers
│       quarantine_key
│       quarantine_max_filesize
│       quarantine_max_usage
│       quarantine_max_files
│       honeypot_mode
│       scan_cache_expiry
│       disable_cli
│       disable_frontend
│       max_login_attempts
│       frontend_log (v1: FrontEndLog)
│       disable_webfonts
│       maintenance_mode
│       default_algo
│       statistics
│       disabled_channels
│
├───signatures
│       active (v1: Active)
│       fail_silently
│       fail_extensions_silently
│       detect_adware
│       detect_joke_hoax
│       detect_pua_pup
│       detect_packer_packed
│       detect_shell
│       detect_deface
│       detect_encryption
│
├───files
│       max_uploads
│       filesize_limit
│       filesize_response
│       filetype_whitelist
│       filetype_blacklist
│       filetype_greylist
│       check_archives
│       filesize_archives
│       filetype_archives
│       max_recursion
│       block_encrypted_archives
│       max_files_in_archives
│
├───attack_specific
│       chameleon_from_php
│       can_contain_php_file_extensions
│       chameleon_from_exe
│       chameleon_to_archive
│       chameleon_to_doc
│       chameleon_to_img
│       chameleon_to_pdf
│       archive_file_extensions
│       block_control_characters
│       corrupted_exe
│       decode_threshold
│       scannable_threshold
│       allow_leading_trailing_dots
│       block_macros
│
├───compatibility
│       ignore_upload_errors
│       only_allow_images
│
├───heuristic
│       threshold
│
├───virustotal
│       vt_public_api_key
│       vt_suspicion_level
│       vt_weighting
│       vt_quota_rate
│       vt_quota_time
│
├───urlscanner
│       lookup_hphosts
│       google_api_key
│       maximum_api_lookups
│       maximum_api_lookups_response
│       cache_time
│
├───legal
│       pseudonymise_ip_addresses
│       privacy_policy
│
├───template_data
│       theme
│       magnification (v1: Magnification)
│       css_url
│
├───PHPMailer
│       event_log (v1: EventLog)
│       skip_auth_process (v1: SkipAuthProcess)
│       enable_two_factor (v1: Enable2FA)
│       host (v1: Host)
│       port (v1: Port)
│       smtp_secure (v1: SMTPSecure)
│       smtp_auth (v1: SMTPAuth)
│       username (v1: Username)
│       password (v1: Password)
│       set_from_address (v1: setFromAddress)
│       set_from_name (v1: setFromName)
│       add_reply_to_address (v1: addReplyToAddress)
│       add_reply_to_name (v1: addReplyToName)
│
└───supplementary_cache_options
        enable_apcu
        enable_memcached
        enable_redis
        enable_pdo
        memcached_host
        memcached_port
        redis_host
        redis_port
        redis_timeout
        pdo_dsn
        pdo_username
        pdo_password
```

#### "general" （全般、カテゴリー）
全般的な設定。

##### "cleanup" （クリーンアップ）
- 初回アップロード後に変数とキャッシュの設定をクリアするか否かについてのスクリプトです。​`false`(偽） = いいえ；​`true`（真） = はい 「Default/デフォルト設定」。​初回アップロードスキャニング以外で使用することがなければ、​`true`（真）としメモリーの使用量を最小にします。​使用するのであれば、​`false`（偽）とし、​メモリーに不要な重複データを再ロードするのを防ぎます。​通常は`true`（真）。​に設定しますが、​初回アップロードスキャニングに対してしか使用できないことを覚えておいて下さい。
- ＣＬＩモードでは影響しません。

##### "scan_log" （スキャン・ログ）
- 全スキャニング結果を記録するファイルのファイル名。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

##### "scan_log_serialized" （スキャン・ログ・シリアライズド）
- 全スキャニング結果を記録するファイルのファイル名（シリアル化形式を利用）。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

##### "scan_kills" （スキャン・キルズ）
- ブロックしたか削除したアップロードの全てを記録するファイのファイル名。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

*有用な先端：​あなたがしたい場合は、​ログ・ファイルの名前に日付/時刻情報を付加することができます、​名前にこれらを含めることで:完全な年のため`{yyyy}`、​省略された年のため`{yy}`、​月`{mm}`、​日`{dd}`、​時間`{hh}`。​*

*例：*
- *`scan_log='scan_log.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_log_serialized='scan_log_serialized.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_kills='scan_kills.{yyyy}-{mm}-{dd}-{hh}.txt'`*

##### "error_log" （エラー・ログ）
- 検出された致命的でないエラーを記録するためのファイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

##### "truncate" （トランケート）
- ログ・ファイルが一定のサイズに達したら切り詰めますか？​値は、​ログ・ファイルが切り捨てられる前に大きくなる可能性があるＢ/ＫＢ/ＭＢ/ＧＢ/ＴＢ単位の最大サイズです。​デフォルト値の０ＫＢは切り捨てを無効にします （ログ・ファイルは無期限に拡張できます）。​注：個々のログ・ファイルに適用されます。​ログ・ファイルのサイズは一括して考慮されません。

##### "log_rotation_limit" （ログ・ローテーション・リミット）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望の制限を指定することができます。​値「0」は、ログ・ローテーションを無効にします。

##### "log_rotation_action" （ログ・ローテーション・アクション）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望のアクションを指定できます。 「Delete」 = 最も古いログ・ファイルを削除して、制限を超過しないようにします。 「Archive」 = 最初にアーカイブしてから、最も古いログ・ファイルを削除して、制限を超過しないようにします。

*技術的な説明：この文脈では、「最も古い」とは「最近変更されていない」という意味です。*

##### "timezone" （タイムゾーン）
- これは、phpMusselが日付/時刻操作に使用するタイムゾーンを指定するために使用されます。​あなたがそれを必要としないなら、それを無視してください。​可能な値はＰＨＰによって決定されます。​しかし、​その代わりに、​一般的にタイムゾーンディレクティブ（あなたの`php.ini`ファイルで）を調整ーることをお勧めします、​でも時々（といった、​限ら共有ホスティングプロバイダでの作業時）これは何をすることは必ずしも可能ではありません、​したがって、​このオプションは、​ここで提供されています。

##### "time_offset" （タイム・オフセット）
- *v1: "timeOffset"*
- お使いのサーバーの時刻は、​ローカル時刻と一致しない場合、​あなたのニーズに応じて、​時間を調整するために、​あなたはここにオフセットを指定することができます。​しかし、​その代わりに、​一般的にタイムゾーンディレクティブ（あなたの`php.ini`ファイルで）を調整ーることをお勧めします、​でも時々（といった、​限ら共有ホスティングプロバイダでの作業時）これは何をすることは必ずしも可能ではありません、​したがって、​このオプションは、​ここで提供されています。​オフセット分であります。
- 例（１時間を追加します）：`time_offset=60`

##### "time_format" （タイム・フォーマット）
- *v1: "timeFormat"*
- phpMusselで使用される日付表記形式。​Default（デフォルト設定） = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

##### "ipaddr" （アイピー・アドレス）
- 接続要求のＩＰアドレスをどこで見つけるべきかについて（Cloudflareのようなサービスに対して有効）。​Default（デフォルト設定） = REMOTE_ADDR。​注意：あなたが何をしているのか、​分からない限り、​これを変更しないでください。

「ipaddr」の推奨値です：

値 | 使用
---|---
`HTTP_INCAP_CLIENT_IP` | Incapsulaリバース・プロキシ。
`HTTP_CF_CONNECTING_IP` | Cloudflareリバース・プロキシ。
`CF-Connecting-IP` | Cloudflareリバース・プロキシ（代替；上記がうまくいかない場合）。
`HTTP_X_FORWARDED_FOR` | Cloudbricリバース・プロキシ。
`X-Forwarded-For` | [Squidリバース・プロキシ](http://www.squid-cache.org/Doc/config/forwarded_for/)。
*サーバー・コンフィグレーションによって定義されます。​* | [Nginxリバース・プロキシ](https://www.nginx.com/resources/admin-guide/reverse-proxy/)。
`REMOTE_ADDR` | リバース・プロキシはありません（デフォルト値）。

##### "enable_plugins" （イネーブル・プラグインす）
- プラグインのサポートを有効にしますか？​`false` = いいえ；​`true` = はい 「Default/デフォルト設定」。

##### "forbid_on_block" （フォービッド・オン・ブロック）
- アップロードファイルがブロックされたメッセージと共に、​phpMusselから４０３ヘッダーを送るべきか、​通常の２００でよいかどうかについて。​`false`（偽） = いいえ（２００） 「Default/デフォルト設定」；​`true`（真） = はい（４０３）。

##### "delete_on_sight" （デリート・オン・サイト）
- このディレクティブを有効にすると、​検知基準（シグネチャでも何でも）にあったアップロードファイルは直ちに削除されます。​クリーンと判断されたファイルはそのままです。​アーカイブの場合、​問題のファイルが一部であってもアーカイブ全てが削除の対象となります。​アップロードファイルのスキャンにおいては、​本ディレクティブを有効にすることは必須ではありません。​なぜならＰＨＰはスクリプト実行後に自動的にキャッシュの内容を破棄するからです。​言い換えれば、​ファイルが移動されたか、​コピーされたか、​削除されない限り、​ＰＨＰはサーバーにアップロードしたファイルを残しておくことは通常ありません。​このディレクティブはセキュリティーに念を入れる目的で設置されています。​ＰＨＰは稀に予測外の振る舞いをすることがあるからです。​`false`（偽） = スキャニング後、​ファイルはそのまま（デフォルト設定）。​`true`（真） = スキャニング後、​クリーンでなければ直ちに削除。

##### "lang" （ラング）
- phpMusselのデフォルト言語を設定します。

##### "lang_override" （ラング・オーバーライド）
- 可能な限り「HTTP_ACCEPT_LANGUAGE」に従ってローカライズしますか？ True = はい（Default/デフォルルト）。 False = いいえ。

##### "numbers" （ナンバーズ）
- 数値の表示方法を指定します。

現在サポートされている値：

値 | これを生産する | 説明
---|---|---
`NoSep-1` | `1234567.89`
`NoSep-2` | `1234567,89`
`Latin-1` | `1,234,567.89` | デフォルト値。
`Latin-2` | `1 234 567.89`
`Latin-3` | `1.234.567,89`
`Latin-4` | `1 234 567,89`
`Latin-5` | `1,234,567·89`
`China-1` | `123,4567.89`
`India-1` | `12,34,567.89`
`India-2` | `१२,३४,५६७.८९`
`India-3` | `૧૨,૩૪,૫૬૭.૮૯`
`India-4` | `੧੨,੩੪,੫੬੭.੮੯`
`India-5` | `೧೨,೩೪,೫೬೭.೮೯`
`India-6` | `౧౨,౩౪,౫౬౭.౮౯`
`Arabic-1` | `١٢٣٤٥٦٧٫٨٩`
`Arabic-2` | `١٬٢٣٤٬٥٦٧٫٨٩`
`Arabic-3` | `۱٬۲۳۴٬۵۶۷٫۸۹`
`Arabic-4` | `۱۲٬۳۴٬۵۶۷٫۸۹`
`Bengali-1` | `১২,৩৪,৫৬৭.৮৯`
`Burmese-1` | `၁၂၃၄၅၆၇.၈၉`
`Khmer-1` | `១.២៣៤.៥៦៧,៨៩`
`Lao-1` | `໑໒໓໔໕໖໗.໘໙`
`Thai-1` | `๑,๒๓๔,๕๖๗.๘๙`
`Thai-2` | `๑๒๓๔๕๖๗.๘๙`

*注意：これらの値は、パッケージを超えては関連しません。​また、サポートされる値は将来変更される可能性があります。*

##### "quarantine_key" （クオランティン・キ―）
- phpMusselは、​必要とあれば、​phpMusselのヴォルト内で独立してフラグ付ファイルのアップロードを検疫することができます。​一般的なphpMusselのユーザーは、​ウェブサイトやホスティング環境の保護ができれば充分と考えており、​フラグ付のようなものにさらなる分析を加えようまでの要求はないようですので、​無効で構いません。​ですが詳細に分析してマルウェアに備えたいユーザーは有効にすると良いでしょう。​フラグ付ファイルのアップロードの検疫は誤検出のデバッグに役立つことがあります。​検疫機能を無効にするには、​`quarantine_key`ディレクティブを空にしておくか、​空でない場合はディレクティブ内のコンテンツを消去して下さい。​有効にするには、​デイレクティブに何らかの値を入れて下さい。​`quarantine_key`は検疫機能における重要なセキュリティー要素であり、​検疫機能内に保存されたデータの執行を各種の攻撃から守っています。​`quarantine_key`はパスワードと同様に考えて下さい。​長い方がより安全と言えます。​最も効果的な使用法は`delete_on_sight`との併用です。

##### "quarantine_max_filesize" （クオランティン・マックス・ファイルサイズ）
- 検疫されるファイルサイズの上限。​この値より大きなファイルは検疫されません。​クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、​メモリーが無駄に消費されるのを防ぐ意味で重要です。​デフォルト設定は２ＭＢです。

##### "quarantine_max_usage" （クオランティン・マックス・ユーセッジ）
- 検疫のために利用する最大メモリー量。​全メモリー量が使用されると、​この範囲内に収まるよう古いファイルが削除の対象となります。​クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、​メモリーが無駄に消費されるのを防ぐ意味で重要です。​デフォルト設定は６４ＭＢです。

##### "quarantine_max_files" （クオランティン・マックス・ファイル数）
- 検疫に存在できるファイルの最大数。​隔離ファイルに新しいファイルが追加されると、この数を超えた場合、残りのファイルがこの数を超えなくなるまで古いファイルが削除されます。​デフォルト設定は１００です。

##### "honeypot_mode" （ハニーポット・モード）
- ハニーポットモードが有効になっていると、​phpMusselはアップロードされてきた全てのファイルを例外なく検疫します。​シグネチャにマッチするかどうかは問題としません。​スキャニングや分析もなされません。​phpMusselをウィルス/マルウェアのリサーチに利用と考えているユーザーにとって有益と言えるでしょう。​ただし、​アップロードファイルのスキャニングという点からは、​あまり推奨できませんし、​ハニーポット・モードを本来の目的以外に使用することもお勧めできません。​デフォルト設定では無効です。​`false`（偽） = Disabled/無効（Default/デフォルト）；​`true`（真） = Enabled/有効。

##### "scan_cache_expiry" （スキャン・キャッシュ・エクスパイヤリー）
- phpMusselはスキャニング結果をどれくらいの期間キャッシュすべきか？​秒単位で、​デフォルトは２１，６００秒（６時間）となっています。​０にするとキャッシュ無効になります。

##### "disable_cli" （ディスエイブル・シーエルアイ）
- ＣＬＩモードを無効にするか？​ＣＬＩモード（シーエルアイ・モード）はデフォルトでは有効になっていますが、​テストツール（PHPUnit等）やＣＬＩベースのアプリケーションと干渉しあう可能性が無いとは言い切れません。​ＣＬＩモードを無効にする必要がなければ、​このデレクティブは無視してもらって結構です。​`false`（偽） = ＣＬＩモードを有効にします（Default/デフォルルト）；​`true`（真） = ＣＬＩモードを無効にします。

##### "disable_frontend" （ディスエイブル・フロントエンド）
- フロントエンドへのアクセスを無効にするか？​フロントエンドへのアクセスは、​phpMusselをより管理しやすくすることができます。​前記、​それはまた、​潜在的なセキュリティリスクになる可能性があります。​バックエンドを経由して管理することをお勧めします、​しかし、​これが不可能な場合、​フロントエンドへのアクセスが提供され。​あなたがそれを必要としない限り、​それを無効にします。​`false`（偽） = フロントエンドへのアクセスを有効にします；​`true`（真） = フロントエンドへのアクセスを無効にします（Default/デフォルルト）。

##### "max_login_attempts" （マクス・ログイン・アテンプト）
- ログイン試行の最大回数（フロントエンド）。​Default（デフォルト設定） = ５。

##### "frontend_log" （フロントエンド・ログ）
- *v1: "FrontEndLog"*
- フロントエンド・ログインの試みを記録するためのファイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

##### "disable_webfonts" （ディスエイブル・ウェブフォンツ）
- ウェブフォンツを無効にしますか？ True = はい（Default/デフォルルト）。 False = いいえ。

##### "maintenance_mode" （メンテナンス・モード）
- メンテナンス・モードを有効にしますか？ True = はい。 False = いいえ（Default/デフォルルト）。​フロントエンド以外のすべてを無効にします。​ＣＭＳ、フレームワークなどを更新するときに便利です。

##### "default_algo" （ディフォールト・アルゴ）
- 将来のすべてのパスワードとセッションに使用するアルゴリズムを定義します。​オプション：​PASSWORD_DEFAULT（Default/デフォルルト）、​PASSWORD_BCRYPT、​PASSWORD_ARGON2I ​（ＰＨＰ >= 7.2.0 が必要）。

##### "statistics" （スタティスティックス/統計）
- phpMussel使用統計を追跡しますか？ True = はい。 False = いいえ（Default/デフォルルト）。

##### "disabled_channels" （ディセーブルド・チャネルズ）
- これは、要求を送信するときにphpMusselが特定のチャネルを使用しないようにするために使用できます​（例えば、更新時、コンポーネント・メタデータの取得時、など）。

#### "signatures" （シグネチャーズ、カテゴリ）
シグネチャの設定。

##### "active" （アクティブ）
- *v1: "Active"*
- カンマで区切られたアクティブなシグネチャ・ファイルのリスト。

*注意：*
- *シグネチャ・ファイルは、アクティブ化する前に、まず、インストールする必要があります。*
- *テスト・ファイルを正しく機能するには、シグネチャ・ファイルを、まず、インストールしてアクティブ化する必要があります。*
- *このディレクティブの値はキャッシュされています。​変更した後、変更を有効にするためにキャッシュを削除する必要があるかもしれません。*

##### "fail_silently" （フェイル・サイレントリー）
- シグネチャ・ファイルがない、​あるいは破損している場合に、​phpMusselがそれをリポートすべきか否か？​`fail_silently`が無効ならば、​問題はリポートされ、​有効であれば、​問題は無視されたスキャニングレポートが作成されます。​クラッシュするというような害がなければ、​デフォルト設定のままにしておくべきです。​`false`（偽） = Disabled/無効; `true`（真） = Enabled/有効 （Default/デフォルト）。

##### "fail_extensions_silently" （フェイル・エクステンションズ・サイレントリー）
- 拡張子がない場合にphpMusselがそれをレポートすべきか否か？​`fail_extensions_silently`が無効の場合、​拡張子なしはスキャニング時にレポートされ、​有効の場合は無視され問題は報告されません。​このディレクティブを無効にすることは、​セキュリティーを向上させるかもしれませんが、​誤検出も増加する恐れがあります。​`false`（偽） = Disabled/無効; `true`（真） = Enabled/有効（Default/デフォルト）。

##### "detect_adware" （ディテクト・アドウェア）
- phpMusselはアドウェア検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_joke_hoax" （ディテクト・ジョーク・ホークス）
- phpMusselは悪戯/偽造やマルウェア/ウィルス検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_pua_pup" （ディテクト・PUA・PUP）
- phpMusselはPUAs/PUPs検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_packer_packed" （ディテクト・パッカー・パックト）
- phpMusselはパッカーやパックデータ検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_shell" （ディテクト・シェル）
- phpMusselはshellスクリプト検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_deface" （ディテクト・ディフェーサ）
- phpMusselは改ざんやディフェーサー検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "detect_encryption" （ディテクト・エンクリプション）
- phpMusselは暗号化ファイルを検出してブロックする必要がありますか？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

#### "files" （ファイルズ、​カテゴリー）
ファイル取扱い設定。

##### "max_uploads" （マックス・アップローズ）
- 一度にスキャンできるアップロードファイル数の上限で、​これを超えるとスキャンを中断し、​ユーザーにその旨を知らせ、​論理攻撃からの保護として機能します。​システムやＣＭＳがDDoS攻撃にあい、​phpMusselがオーバーロードしてＰＨＰプロセスに支障をきたすことがないようにするためです。​推奨数は１０ですが、​ハードウェアのスピードによっては、​これ以上/以下がよいということもあるでしょう。​この数は、​アーカイブのコンテンツは含まないことを覚えておいて下さい。

##### "filesize_limit" （ファイルサイズ・リミット）
- ファイルサイズ上限の単位はＫＢです。​６５５３６＝６４ＭＢ（Default/デフォルト）；​0 = リミットしません（上限なし、​常にグレイリスト化）、​正の数値であれば何でも構いません。​ＰＨＰの設定でメモリーに制限があったり、​アップロードファイルサイズの上限が設定されている場合に有効的です。

##### "filesize_response" （ファイルサイズ・レスポンス）
- 上限サイズを超えるファイルをどう処理するかについてです。​`false`（偽）=ホワイトリストして「Whitelist」。`true`（真）=ブラックリストして「Blacklist」（Default/デフォルト）。

##### "filetype_whitelist" （ファイルタイプ・ホワイトリスト）、​"filetype_blacklist" （ファイルタイプ・ブラックリスト）、​"filetype_greylist" （ファイルタイプ・グレーリスト）
- システムが特定タイプのファイルのみアップロードを許可する、​あるいは拒絶する場合は、​ファイルタイプを適切にホワイトリスト、​ブラックリスト、​グレーリストにて分類しておくと、​ファイルタイプによって弾かれるファイルはスキャンをスキップできるため、​スピードアップに繋がります。​フォーマットはＣＳＶ（カンマ区切り）です。​リストによらず全てをスキャンしたい場合は、​変数は空白のままとし、​ホワイトリスト/ブラックリスト/グレーリストを無効にします。
- プロセスの論理的順序:
 - ファイルタイプがホワイトリストに記載されていれば、​スキャンせず、​ブロックせず、​ブラックリストおよびグレイリストに対してチェックを行いません。
 - ファイルタイプがブラックリストに記載されていれば、​スキャンすることなく、​直ちににブロックし、​グレーリストに対してチェックを行いません。
 - グレーリストが空、​あるいはグレーリストが空でなくかつそのファイルタイプがあれば、​通常通りスキャンしブロックするか否かを判断します。​グレーリストが空でなくかつそのファイルタイプが含まれていなければ、​ブラックリストと同様の扱いをすることになり、​スキャンなしにブロックします。

##### "check_archives" （チェック・アーカイブズ）
- アーカイブのコンテンツに対してチェックを試みるか否かについてです。 `false`（偽） = チェックしない; `true`（真） = チェックする（Default/デフォルト）。

フォーマット | 読めるです | 再帰的に読めるです | 暗号化が検出可能です | ノート
---|---|---|---|---
Zip | ✔️ | ✔️ | ✔️ | [ｌｉｂｚｉｐ](https://secure.php.net/manual/en/zip.requirements.php)が必要です（通常で、それはすでにＰＨＰに束ねるされています）。 追加サポート（ｚｉｐ形式を使用します）： ✔️ ＯＬＥオブジェクトの検出。 ✔️ オフィス・マクロの検出。
Tar | ✔️ | ✔️ | ➖ | 特別な要件はありません。フォーマットは暗号化をサポートしていません。
Rar | ✔️ | ✔️ | ✔️ | [ｒａｒ](https://pecl.php.net/package/rar)拡張モジュールが必要です（この拡張モジュールがインストールされていない場合、phpMusselはｒａｒファイルを読むことができません）。
Phar | ❌ | ❌ | ❌ | ｐｈａｒファイルの読み込みサポートはv1.6.0で削除されました。セキュリティ上の問題のため、再度追加されません。

*誰かが、他のアーカイブ・フォーマットを読むためのサポートを実装するのを助けることができれば、そのような援助は歓迎されるだろう。*

##### "filesize_archives" （ファイルサイズ・アーカイブズ）
- ファイルサイズのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？​`false` = いいえ（ただグレーリストすべて）; `true` = はい 「Default/デフォルト設定」。

##### "filetype_archives" （ファイルタイプ・アーカイブズ）
- ファイルタイプのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？​`false` = いいえ（ただグレーリストすべて） 「Default/デフォルト設定」; `true` = はい。

##### "max_recursion" （マックス・リカーション）
- アーカイブに対する最大再帰深さです。​デフォルト＝３。

##### "block_encrypted_archives" （ブロック・エンクリプティッド・アーカイブズ）
- 暗号化されたアーカイブを検出しブロックするか否か？​phpMusselは暗号化されたアーカイブをスキャンすることはできないので、​アーカイブの暗号化によってphpMussel、​アンチウィルススキャナー等をかいくぐろうとする攻撃者がいるかもしれません。​暗号化されたアーカイブをブロックすることにより、​このようなリスクを回避することができます。​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

##### "max_files_in_archives" （マックス・ファイルズ・イン・アーカイブズ）
- スキャンを中止する前にアーカイブ内からスキャンするファイルの最大数。​デフォルト＝０（上限なし）。

#### "attack_specific" （アタック・スペシフィック、​カテゴリー）
アタックースペシフィック　ディレクティブ。

カメレオン攻撃検出。 `false`（偽） = オフ。 `true`（真） = オン。

##### "chameleon_from_php" （カメレオン・フロム・ピーエイチピー）
- ファイルでもなくＰＨＰアーカイブとも認識できないファイル中のＰＨＰヘッダーを探します。

##### "can_contain_php_file_extensions" （キャン・コンテイン・ＰＨＰ・ファイル・エクステンションズ）
- カンマで区切られたＰＨＰコードを含むことができるファイル拡張子のリスト。​ＰＨＰカメレオン攻撃検出が有効になっている場合、このリストにない拡張子を持つＰＨＰコードを含むファイルは、ＰＨＰカメレオン攻撃として検出されます。

##### "chameleon_from_exe" （カメレオン・フロム・ＥＸＥ）
- 実行ファイルでもなく実行ファイルのアーカイブとも認識できないファイル中の実行ヘッダーや不正なヘッダーの実行ファイルを探します。

##### "chameleon_to_archive" （カメレオン・トゥ・アーカイブ）
- ヘッダーが正しくないアーカイブを探します（ＢＺ/ＢＺＩＰ２、ＧＺ/ＧＺＩＰ、ＬＺＦ、ＲＡＲ、ＺＩＰをサポート）。

##### "chameleon_to_doc" （カメレオン・トゥ・ドク）
- ヘッダーが正しくないオフィスドキュメントを探します（DOC、​DOT、​PPS、​PPT、​XLA、​XLS、​WIZをサポート）。

##### "chameleon_to_img" （カメレオン・トゥ・アイエムジー）
- ヘッダーが正しくない画像ファイルを探します（BMP、​DIB、​PNG、​GIF、​JPEG、​JPG、​XCF、​PSD、​PDD、​WEBPをサポート）。

##### "chameleon_to_pdf" （カメレオン・トゥ・ピーディーエフ）
- ヘッダーが正しくないPDFファイルを探します。

##### "archive_file_extensions" （アーカイブ・ファイル・エクステンション）
- 認識可能なアーカイブファイルエクステンションです（フォーマットはＣＳＶ；​問題があった場合にのみ追加あるいは取り除くべきです。​不用意に取り除くと誤検出の原因となる可能性があります。​反対に不用意に追加すると、​アタックースペシフィック検出から追加したものをホワイトリスト化してしまいます。​充分に注意に上、​変更して下さい。​なお、​コンテントレベルにおいてアーカイブを分析することが出来るか否かには影響しません）。​デフォルトでは最も一般なフォーマットをリストしていますが、​意図的に包括的にはしていません。

##### "block_control_characters" （ブロック・コントロール・キャラクターズ）
- 制御文字を含んだファイルをブロックするか否か（改行以外）？​についてです（[\x00-\x08\x0b\x0c\x0e\x1f\x7f]）。​もし、​テキストのみをアップロードするなら、​このオプションを有効にして、​さらにプロテクションを強化できます。​テキスト以外もアップロード対象であれば、​有効にすると誤検出の原因になりえます。​`false`（偽） = ブロックしない（Default/デフォルト）；​`true`（真） = ブロックする。

##### "corrupted_exe" （コラプティッド・ＥＸＥ）
- 破損ファイルとエラー解析。​`false`（偽） = 無視する；​`true`（真） = ブロックする（Default/デフォルト）。​破損の可能性があるPEファイルをブロックし検出するか否か？​についてです。​ＰＥファイルの一部が破損し、​正しく分析できないことは珍しくなく、​ウィルス感染をみるバロメーターになります。​ＰＥファイル内のウィルスを検出するアンチウィルスプログラムは、​ＰＥファイルの解析を行いますが、​ウィルスを作る側では、​ウィルスが検出されないようそれを避けようとするものだからです。

##### "decode_threshold" （デコード・スレッシュホールド）
- デコード・コマンドが検出されるべき生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。​デフォルト＝５１２ＫＢ。​ゼロあるいは値なし（null）はしきい値を無効化します（ファイルサイズによる制限を取り除きます）。

##### "scannable_threshold" （スキャナブル・スレッシュホールド）
- phpMusselが読みスキャンしてよい生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。​デフォルト＝３２ＭＢ。​ゼロあるいは値なし（null）はしきい値を無効化します。​値は、​サーバーやウェブサイトでアップロードされるファイルの平均ファイルサイズより大きく、​filesize_limitディレクティブより小さく設定すべきです。​また`php.ini`設定によってＰＨＰに割り当てられたメモリーのおおよそ5分の１を超えるべきではありません。​このディレクティブはphpMusselがメモリーを使い過ぎないようにするためのものです。​（一定のサイズ以上のファイルはスキャンできなくなることもあります）。

##### "allow_leading_trailing_dots" （アラウ・リーディング・トレーリング・ドッツ）
- ファイル名に先頭と末尾のドットを使用できますか？​これは、ファイルを隠すためや、ディレクトリ・トラバーサルを許可するようにシステムを騙すために使用されることがあります。​`false`（偽）=許可しない（Default/デフォルト）。`true`（真）=許可します。

##### "block_macros" （ブロック・マクローズ）
- マクロを含むファイルをブロックしようとしていますか？​ドキュメントやスプレッドシートには実行可能なマクロが含まれている可能性があります。​`false`（偽） = ブロックしない（Default/デフォルト）；​`true`（真） = ブロックする。

#### "compatibility" （コンパーティブリティ、カテゴリ）
phpMusselの互換性ディレクティブ。

##### "ignore_upload_errors" （イグノア・アップロード・エラーズ）
- システム上でphpMusselの機能に修正が必要でない限りはこのディレクティブは通常無効です。​無効に設定すると、​`$_FILES` array()に要素の存在を検知したとき、​その要素が表すファイルのスキャンが開始され、​要素が空白か無であればphpMusselはエラーメッセージを返します。​これは本来phpMusselがあるべき姿です。​しかしＣＭＳにおいては、​$_FILESの空要素は普通に発生するものであり、​正常なphpMusselの挙動が正常なＣＭＳの挙動を阻害する恐れがあります。​このような場合は、​本オプションを有効にして、​phpMusselが空要素をスキャンしてエラーメッセージを返すのを避け、​要求のあったページへスムーズに進むことができるようにします。​`false`（偽）=ＯＦＦ「オフ」です。`true`（真）=ＯＮ「オン」です。

##### "only_allow_images" （オンリー・アロウ・イメージ）
- システムあるいはＣＭＳに画像ファイルのアップロードのみを許可するのであれば、​このディレクティブは有効にすべきであり、​そうでなければ無効とします。​有効にすると、​画像と特定できないファイルはスキャンすることなしにブロックしますので、​プロセス時間の短縮とメモリーの節約が期待できます。​`false`（偽） = OFF （オフ）；​`true`（真） = ON （オン） です。

#### "heuristic" （ヒューリスティック、カテゴリ）
ヒューリスティック・ディレクティブズ。

##### "threshold" （スレッシュホールド）
- phpMusselには、​このファイルは疑わしく危険性が高いと判断するシグネチャがあります。​しきい値は、​アップロードされているファイルの危険性の最大値であり、​これを超えるとマルウェアと判断されます。​ここにおける危険性の定義とは、​疑わしいと特定されたものの総数です。​デフォルトでは３に設定されています。​これより低いと誤検出の可能性が増え、​大きすぎると、​誤検出は減るものの危険性のあるファイルが検出されない可能性が増加してしまいます。​特に問題がなければ、​デフォルト値のままにしておくことお勧めします。

#### "virustotal" （ウィルストータル、カテゴリ）
VirusTotal.comディレクティブズ。

##### "vt_public_api_key" （ヴィティ・パブリック・エイピーアイ・キー）
- オプションですが、​phpMusselはVirus Total APIを使ってファイルをスキャンすることができます。​ウィルス、​トロイの木馬、​マルウェア、​その他の攻撃に対して非常に効果的に機能します。​デフォルトではVirus Total APIを使ったスキャニングは無効になっています。​有効にするには、​Virus TotalのAPIキーが必要です。​メリットが極めて大きいため、​有効にすることを強く推奨します。​Virus Total APIの使用にあたっては、​Virus Totalのドキュメンテーションにある通り、​利用規定ならびにガイドラインを遵守しなくてはなりません。​この統合機能を使用するためには：
 - Virus TotalとAPIのサービス規定を読み同意すること。​[サービス規定はこちらから](https://www.virustotal.com/en/about/terms-of-service/)。
 - 最低でもVirus Total Public APIドキュメンテーションの前文を読み理解すること（「VirusTotal Public API v2.0」以降、「Contents」前まで）。​Virus Total Public APIの[ドキュメンテーションはこちらから](https://www.virustotal.com/en/documentation/public-api/)。

注意：Virus Total API使用したスキャニングが無効になっている場合、​このカテゴリー（`virustotal`）のディレクティブを参照する必要はありません。​無効であれば、​どれも機能しません。​Virus Total APIキーを取得するには、​Virus Totalのサイトのページ右上にあるリンク「コミュニティに参加」をクリックして、​必要事項を記入しサインアップします。​インストラクションに従ってパブリックAPIキーを取得した後、​`config.ini`設定ファイルの`vt_public_api_key`ディレクティブのそれをコピー＆ペーストして下さい。

##### "vt_suspicion_level" （ヴィティ・サスピション・レベル）
- デフォルト設定では、​phpMusselがVirus Total APIを使ってスキャンするファイル（疑がわしいもの）には制限があります。​`vt_suspicion_level`ディレクティブを編集することのより、​この制限を変更することが可能です。
- `0`：​phpMusselのシグネチャを使ってスキャンした結果、​ヒューリスティックな重みがあると判断された場合にのみ、​疑わしいファイルと結論付けられます。​すなわちVirus Total APIは、​phpMusselが危険性を察知はしたが完全にそうとは言い切れず、​したがってブロックもせず、​フラグを付けることもしなかった時のセカンドオピニオンです。
- `1`：​phpMusselのシグネチャを使ってスキャンした結果、​実行ファイルと思われる（PEファイル、​Mach-O ファイル、​ELF/Linuxファイル等）、​ないしは実行可能なデータを含んだフォーマット（マクロ、​DOC/DOCXファイル、​アーカイブRAR/ZIPファイル等)があれば、​ヒューリスティックな重みがあるとして疑わしいファイルと結論付けられます。​これはデフォルト設定であり、​推奨レベルでもあります。​Virus Total APIは、​phpMusselが危険性なしと判断し、​したがってブロックもせず、​フラグを付けることもしなかった時のセカンドオピニオンです。
- `2`：​ファイルは全て疑わしいものとされ、​Virus Total APIを使ってスキャンされます。​API割り当てを使い切る恐れがあるため、​推奨は控えますが、​状況によっては適切と言えるでしょう（例えば、​ウェブマスターやホストマスターがアップロードされる内容を信頼できない状況等）。​この警戒レベルでは、​通常ブロック/フラグも対象にならないファイルも全てVirus Total APIを使ってスキャンされます。​したがって、​Virus Total APIの割り当てを早々に消費してしまうこともあり得、​またAPI割り当てを使い切れば、​phpMusselはVirus Total APIの使用を中止します（警戒レベルに関係なく）。

注意：phpMusselによってブラックリスト化、​ホワイトリスト化されたファイルはVirus Total APIを使ったスキャンの対象にはなりません。​これらは既に善悪が結論付けられたものであり、​Virus Total APIで再びスキャンする必要性はないためです。​phpMusselが、​Virus Total APIを利用するのは、​phpMussel自身が危険性の有無について判断しかねる状況においての補助と言えます。

##### "vt_weighting" （ヴィティ・ウェイティング）
- phpMusselがVirus Total APIを使ったスキャニング結果を検出として扱うか、​検出の重み付けとして扱うべきか？​複数のエンジン（Virus Totalのように）を使用したスキャニングは、​検出率の向上（より多くのマルウェアが検出）をもたらす一方で誤検出の増加も招くため、​このディレクティブが存在します。​したがって、​スキャニング結果は、​決定的判断ではなく信頼スコアとして利用した方が適当なケースもあります。​値が０の場合、​Virus Total APIを使ったスキャンは検出として扱われ、​Virus Totalのエンジンがマルウェアとフラグを付けたファイルは、​phpMusselもマルウェアと判断します。​その他の値の場合は結果は検出の重み付けとなり、​スキャンされたファイルがマルウェアかどうかphpMusselが判断するための信頼スコア（あるいは検出の重み付け）となります（値はマルウェアと判断するための最小信頼スコア、​あるいは重み）。​デフォルト値は０です。

##### "vt_quota_rate" （ヴィティ・クォータ・レート） と "vt_quota_time" （ヴィティ・クォータ・タイム）
- Virus Total APIのドキュメンテーションによると「１分間のタイムフレームの間にリクエストは最大４回」の上限があります。​ハニークライアントやハニーポット等のオートメーションを使用し、​リポートを受け取るだけでなく、​VirusTotal にリソースを提供していれば、​上限は引き上げられます。​phpMussel のデフォルトでは最大４回を遵守していますが、​前述の事情から、​この２つのディレクトリを準備し、​状況に合わせて変更できるようになっています。​制限に達してしまうといった不都合や問題がない限りデフォルト値を変更することは勧められませんが、​値を小さくすることが適当なケースもあります。​上限はタイムフレーム`vt_quota_time`（ヴィティ・クォータ・タイム）「分内に」`vt_quota_rate`（ヴィティ・クォータ・レート）で設定します。

#### "urlscanner" （ユーアールエルスキャナー、カテゴリ）
phpMusselにはURLスキャナーがビルトインされていて、​スキャンされたファイルやデータ内の悪質なURLを検出することができます。

注意：URLスキャナーが無効の場合、​このカテゴリー（`urlscanner`）を参照する必要はありません。

URLスキャナーAPIルックアップ設定。

##### "lookup_hphosts" （ルックアップ・エイチピーホスツ）
- Trueにすると、​APIの[hpHosts](https://hosts-file.net/)ルックアップが有効になります。​hpHostsはAPIルックアップを実行するのに API鍵を必要としません。

##### "google_api_key" （グーグル・エーピーアイ・キー）
- 必要なAPI鍵が定義されれば、​APIのGoogle Safe Browsing APIルックアップが有効になります。​Google Safe Browsing APIルックアップスに必要なAPI鍵は、​[から取得することができます](https://console.developers.google.com/)。
- 注意：Google Safe Browsing APIルックアップはまだ完成していないので、​将来的な利用を想定しています。

##### "maximum_api_lookups" （マクシマム・エーピーアイ・ルックアップス）
- スキャン反復におけるAPIルックアップの最大回数。​APIルックアップの度にスキャン反復の時間が積み重なってしまうので、​スキャン処理の速度向上のため、​制限を設けたいと考えるかもしれません。​０は制限なしを意味します。​デフォルトは１０です。

##### "maximum_api_lookups_response" （マクシマム・エーピーアイ・ルックアップス・レスポンス）
- APIルックアップの回数制限を超えた時の対応です。​`false`（偽）=何もしない/処理を継続する（Default/デフォルト）；​`true`（真） = ファイルにフラグを付ける/ブロックする。

##### "cache_time" （キャッシュ・タイム）
- APIルックアップの結果をどれくらいキャッシュするか（秒単位です）？​デフォルトは３６００秒（一時間）。

#### "legal" （リーガル、カテゴリ）
法律要件に関するコンフィギュレーション。

*法律要件とこれがコンフィギュレーション要件に与える影響の詳細については、ドキュメントの「[法律情報](#SECTION11)」セクションを参照してください。*

##### "pseudonymise_ip_addresses" （プセユードニマイズ・アイピー・アドレセズ）
- ログ・ファイルを書き込むときにＩＰアドレス偽名化するか「プセユードニマイズ」？ True = はい（Default/デフォルルト）。 False = いいえ。

##### "privacy_policy" （プライバシー・ポリシー）
- 生成されたページのフッターに表示される関連プライバシー・ポリシーのアドレス。​ＵＲＬを指定するか、無効にしたい場合は空白のままにして下さい。

#### "template_data" （テンプレート・データ、カテゴリ）
テンプレートとテーマ用のディレクティブ/変数。

テンプレートのデータは、​ユーザーに向けてアップロード拒否のメッセージをＨＴＭＬ形式でアウトプットする際に使用されます。​カスタムテーマを使っている場合は`template_custom.html`を使用して、​そうでない場合は`template.html`を使用してＨＴＭＬアウトプットが生成されます。​設定ファイル内にあるこのセクション用の変数は、​ＨＴＭＬアウトプットのために解析され、​で囲まれた変数名は対応する変数データに置き換えられます。​例えば`foo="bar"`とすると、​ＨＴＭＬアウトプット内の`<p>{foo}</p>`は`<p>bar</p>`となります。

##### "theme" （シーム/テーマ）
- phpMusselに使用するデフォルトテーマ。

##### "magnification" （マグニフィケーション）
- *v1: "Magnification"*
- フォントの倍率。​Default/デフォルルト = １。

##### "css_url" （シーエスエス・ユーアールエル）
- カスタムテーマ用のテンプレートファイルは、​外部ＣＳＳプロパティーを使っています。​一方、​デフォルトテーマは内部ＣＳＳです。​カスタムテーマを適用するためには、​ＣＳＳファイルのパブリック ＨＴＴＰアドレスを"css_url"変数を使って指定して下さい。​この変数が空白であれば、​デフォルトテーマが適用されます。

#### "PHPMailer" （ピー・エイチ・ピー・メーラー、カテゴリ）
PHPMailerコンフィギュレーション。

現在、phpMusselはフロントエンドの２ＦＡ（二要素認証）にのみPHPMailerを使用しています。​フロントエンドを使用しない場合、またはフロントエンドに２ＦＡ（二要素認証）を使用しない場合は、これらのディレクティブを無視できます。

##### "event_log" （イベント・ログ）
- *v1: "EventLog"*
- PHPMailerに関連してすべてのイベントを記録するためのファイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

##### "skip_auth_process" （スキップ・オス・プロセス）
- *v1: "SkipAuthProcess"*
- このディレクティブを`true`に設定すると、PHPMailerはSMTP経由で電子Ｅメールを送信する際に通常発生する認証プロセスをスキップします。​このプロセスをスキップすると、送信ＥメールがＭＩＴＭ攻撃にさらされる可能性があるため、これは避けるべきです。​しかし、PHPMailerがSMTPサーバに接続できない場合、このプロセスが必要な場合があります。

##### "enable_two_factor" （イネーブル２ＦＡ）
- *v1: "Enable2FA"*
- このディレクティブは、フロントエンド・アカウントに２ＦＡを使用するかどうかを決定します。

##### "host" （ホスト）
- *v1: "Host"*
- 送信Ｅメールに使用するＳＭＴＰホスト。

##### "port" （ポート）
- *v1: "Port"*
- 送信Ｅメールに使用するポート番号。​Default/デフォルルト = 587。

##### "smtp_secure" （ＳＭＴＰセキュア）
- *v1: "SMTPSecure"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに使用するプロトコル（ＴＬＳまたはＳＳＬ）。

##### "smtp_auth" （ＳＭＴＰオス）
- *v1: "SMTPAuth"*
- このディレクティブは、ＳＭＴＰセッションを認証するかどうかを決定します（通常はそれをそのまま残すべきです）。

##### "username" （ユーザーネーム）
- *v1: "Username"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに使用するユーザー名。

##### "password" （パスワード）
- *v1: "Password"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに使用するパスワード。

##### "set_from_address" （セット・フロム・アドレス）
- *v1: "setFromAddress"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに引用する送信者アドレス。

##### "set_from_name" （セット・フロム・ネーム）
- *v1: "setFromName"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに引用する送信者名。

##### "add_reply_to_address" （アッド・リプライ・アドレス）
- *v1: "addReplyToAddress"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに引用する返信アドレス。

##### "add_reply_to_name" （アッド・リプライ・ネーム）
- *v1: "addReplyToName"*
- ＳＭＴＰ経由で電子Ｅメールを送信するときに引用する返信名。

#### "supplementary_cache_options" （サプレメンタリー・キャッシュ・オプションズ、カテゴリ）
補足キャッシュ・オプション。

*現在のところ、これは非常に実験的なものであり、予想通りに動作しない可能性があります！​今のところ、無視することをお勧めします。*

##### "enable_apcu" （イネーブル・ＡＰＣｕ）
- キャッシュに「APCu」を使用するかどうかを指定します。 Default/デフォルルト = False。

##### "enable_memcached" （イネーブル・メムキャッシュト）
- キャッシュに「Memcached」を使用するかどうかを指定します。 Default/デフォルルト = False。

##### "enable_redis" （イネーブル・レディス）
- キャッシュに「Redis」を使用するかどうかを指定します。 Default/デフォルルト = False。

##### "enable_pdo" （イネーブル・ＰＤＯ）
- キャッシュに「PDO」を使用するかどうかを指定します。 Default/デフォルルト = False。

##### "memcached_host" （メムキャッシュ・ホスト）
- Memcachedのホスト値。 Default/デフォルルト = 「localhost」。

##### "memcached_port" （メムキャッシュ・ポート）
- Memcachedのポート値。 Default/デフォルルト = 「11211」。

##### "redis_host" （レディス・ホスト）
- Redisのホスト値。 Default/デフォルルト = 「localhost」。

##### "redis_port" （レディス・ポート）
- Redisのポート値。 Default/デフォルルト = 「6379」。

##### "redis_timeout" （レディス・タイムアウト）
- Redisのタイムアウト値。 Default/デフォルルト = 「2.5」。

##### "pdo_dsn"
- PDOのDSN値。 Default/デフォルルト = 「`mysql:dbname=phpmussel;host=localhost;port=3306`」。

##### "pdo_username" （ＰＤＯ・ユーザーネーム）
- PDOのユーザー名。

##### "pdo_password" （ＰＤＯ・パスワード）
- PDOのパスワード。

---


### ８.<a name="SECTION8"></a>シグネチャ（署名）フォーマット

*参照：*
- *[「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)*

phpMusselシグネチャ・ファイルの最初の9バイト（`[x0-x8]`）は`phpMussel`であり、​「マジック・ナンバー」（magic number）として機能します（それらをシグネチャ・ファイルとして識別するために）。​シグネチャ・ファイルではないファイルを誤って使用するのを防ぐのに役立ちます。​次のバイト（`[x9]`）は、シグネチャ・ファイルのタイプを識別する。​シグネチャ・ファイルを正しく解釈できるようにするためにこれを知っておく必要があります。​次のタイプのシグネチャ・ファイルが認識されます。

タイプ | バイト | 説明
---|---|---
`General_Command_Detections` | `0?` | ＣＳＶ（カンマ区切りの値）のシグネチャ・ファイル。​シグネチャは１６進数でエンコードされた文字列です。​ここの​シグネチャには、名前やその他の詳細はありません（検出する文字列のみ）。
`Filename` | `1?` | ファイル名の​シグネチャ。
`Hash` | `2?` | ハッシュ・シグネチャ。
`Standard` | `3?` | ファイルコンテンツで直接動作する​シグネチャ・ファイル。
`Standard_RegEx` | `4?` | ファイルコンテンツで直接動作する​シグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`Normalised` | `5?` | ＡＮＳＩ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。
`Normalised_RegEx` | `6?` | ＡＮＳＩ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`HTML` | `7?` | ＨＴＭＬ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。
`HTML_RegEx` | `8?` | ＨＴＭＬ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`PE_Extended` | `9?` | ＰＥメタデータで動作するシグネチャ・ファイル（ＰＥのセクション・メタデータでは使用できません）。
`PE_Sectional` | `A?` | ＰＥセクション・メタデータで動作するシグネチャ・ファイル。
`Complex_Extended` | `B?` | phpMusselによって生成された拡張メタデータに基づいてさまざまなルールで動作するシグネチャ・ファイル。
`URL_Scanner` | `C?` | ＵＲＬで動作するシグネチャ・ファイル。

次のバイト（`[x10]`）は改行（`[0A]`）であり、phpMusselのシグネチャ・ファイルのヘッダを終えます。

その後の各空でない行は、​シグネチャまたは規則です。​各シグネチャまたは規則は１行を占有します。​サポートされているシグネチャ形式は以下のとおりです。

#### *ファイル名シグネチャ*
ファイル名シグネチャのフォーマットは例外なく次のようになります。

`NAME:FNRX`

NAMEはそのシグネチャを指す名前でFNRXはファイル名（エンコードされていない）にマッチする正規表現パターンです。

#### *ハッシュ・シグネチャ*
ハッシュ・シグネチャのフォーマットは例外なく次のようになります。

`HASH:FILESIZE:NAME`

HASHはファイル全体のハッシュ（通常はＭＤ５）、​FILESIZEはファイルの全サイズ、​NAMEはそのシグネチャを指す名前です。

#### *ＰＥセクショナルシグネチャ*
ＰＥセクショナルシグネチャのフォーマットは例外なく次のようになります。

`SIZE:HASH:NAME`

HASHはＰＥファイルのある部分のＭＤ５ハッシュ、​SIZEはその部分の全サイズ、​NAMEはシグネチャを指す名前です。

#### *ＰＥ拡張シグネチャ*
ＰＥ拡張シグネチャのフォーマットは例外なく次のようになります。

`$VAR:HASH:SIZE:NAME`

$VARはマッチするＰＥ変数の名前、​HASHはその変数のＭＤ５ハッシュ、​サイズは変数の全サイズ、​NAMEはそのシグネチャを指す名前です。

#### *複合拡張シグネチャ*
複合拡張シグネチャは他のシグネチャとは少し違い、​何に適合するかはそれ自身のシグネチャによって決まり、​基準は一つではありません。​適合基準は「;」により、​適合タイプ、​適合データは「:」によります。​したがってフォーマットは、​$変数１:何らかのデータ;$変数２:SOMEDATA;何らかのデータのようになります。

`$variable1:SOMEDATA;$variable2:SOMEDATA;SignatureName`

#### *その他*
その他のシグネチャのフォーマットです。

`NAME:HEX:FROM:TO`

NAMEはそのシグネチャを指す名前、​HEXは与えられたシグネチャにより適合を見るファイルの１６進法にエンコードされたセグメントです。 FROMとTOはオプション・パラメータで、​データソースのどこからどこまでチェックするかを示します（メール機能ではサポートしていません）。

#### *正規表現*
ＰＨＰが正規表現と判断し処理するフォーマットであれば、​phpMusselとシグネチャによって間違いなく処理されます。​しかし念のため、​シグネチャを基礎とする正規表現を新規に作成する場合は細心の注意を払って下さい。​絶対的な自信がない状況では、​思いもしないエラーが発生しかねません。​正規表現ステートメントが解析されているコンテキストを完全に理解していないならば、​phpMusselのコードを見て下さい。​パターンは全て（ファイル名、​アーカイブ・メタデータ、​ＭＤ５パターンを除く）１６進法でエンコードされなければならない点に注意(上記のパターン構文も)です！

---


### ９.<a name="SECTION9"></a>適合性問題

#### ＰＨＰとＰＣＲＥ
- phpMusselが正しく動作するためにはＰＨＰとＰＣＲＥが必要です。​どちらか一方でも欠けると正常に機能しません。​システムにＰＨＰとＰＣＲＥの両方がインストールされていることをphpMusselダウンロード前に確認して下さい。

#### アンチウィルスソフトウェアとの互換性

phpMusselは大概のウィルススキャンソフトウェアに対して互換性があります。​しかし、​過去にはユーザーから非互換性の報告があったのも確かです。​以下の情報はVirusTotal.comによるものであり、​phpMusselに対しアンチウィルスプログラムによって報告された誤検出を記載しています。​phpMusselと使用中のアンチウィルスソフトウェアの互換性問題が記載通りに必ず発生する、​あるいは発生しないことを保証するものではありませんが、​もしアンチウィルスソフトウェアとphpMusselの動作に顕著な矛盾が認められるようなら、​使用にあたってどちらか一方を無効にするなどの対策を検討すべきでしょう。

以下の情報は、​2018年10月9日にアップデートされ、​本稿執筆時におけるphpMussel最新マイナーバージョン（v1.5.0-v1.6.0）の現況です。

*この情報は、メインパッケージにのみ適用されます。​結果は、インストールされたシグネチャ・ファイル、プラグイン、およびその他の周辺コンポーネントに基づいて異なる場合があります。*

| スキャナ | 結果 |
|---|---|
| Bkav | リポート "VEX.Webshell" |

---


### １０.<a name="SECTION10"></a>よくある質問（ＦＡＱ）

- [「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)
- [「偽陽性」とは何ですか？](#WHAT_IS_A_FALSE_POSITIVE)
- [シグネチャはどれくらいの頻度でアップデイトされますか？](#SIGNATURE_UPDATE_FREQUENCY)
- [phpMusselを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！](#ENCOUNTERED_PROBLEM_WHAT_TO_DO)
- [5.4.0より古いＰＨＰバージョンでphpMussel（v2より前）を使用したいと思います；​手伝ってくれますか？](#MINIMUM_PHP_VERSION)
- [7.2.0より古いＰＨＰバージョンでphpMussel（v2の場合）を使用したいと思います；​手伝ってくれますか？](#MINIMUM_PHP_VERSION_V2)
- [複数のドメインを保護するために１つのphpMusselインストールを使用できますか？](#PROTECT_MULTIPLE_DOMAINS)
- [私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？](#PAY_YOU_TO_DO_IT)
- [あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？](#HIRE_FOR_PRIVATE_WORK)
- [私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？](#SPECIALIST_MODIFICATIONS)
- [私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？](#ACCEPT_OR_OFFER_WORK)
- [私はプロジェクトに貢献したい；​これはできますか？](#WANT_TO_CONTRIBUTE)
- [ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？](#SCAN_DEBUGGING)
- [Cronを使って自動的にアップデートできますか？](#CRON_TO_UPDATE_AUTOMATICALLY)
- [phpMusselは、ＡＮＳＩ以外の名前のファイルをスキャンできますか？](#SCAN_NON_ANSI)
- [ブラックリスト – ホワイトリスト – グレーリスト – 彼らは何ですか？私はどのように使用しますか？](#BLACK_WHITE_GREY)
- [アップデート・ページでシグネチャ・ファイルを有効または無効にすると、コンフィギュレーションに英数字でソートされます。​彼らのソート方法を変更することはできますか？](#CHANGE_COMPONENT_SORT_ORDER)

#### <a name="WHAT_IS_A_SIGNATURE"></a>「シグネチャ」とは何ですか？

phpMusselのコンテキストでは、​「シグネチャ」とは、​私たちが探しているものを特定するデータを指します（ウイルス、​トロイの木馬など）。​このデータは、​通常、​ファイルのチェックサム、​ハッシュ、​または他の同様に識別するインジケータです。​通常、​ラベルや追加のコンテキストを提供するためのその他のデータが含まれています。

#### <a name="WHAT_IS_A_FALSE_POSITIVE"></a>「偽陽性」とは何ですか？

一般化された文脈で簡単に説明、​条件の状態をテストするときに、​結果を参照する目的で、​用語「偽陽性」（*または：偽陽性のエラー、​虚報；* 英語：​*false positive*; *false positive error*; *false alarm*）の意味は、​結果は「陽性」のようです、​しかし結果は間違いです（即ち、​真の条件は「陽性/真」とみなされます、​しかしそれは本当に「陰性/偽」です）。​「偽陽性」は「泣く狼」に類似していると考えることができます（その状態は群の近くに狼がいるかどうかである、​真の条件は「偽/陰性」です、​群れの近くに狼がないからです、​しかし条件は「真/陽性」として報告されます、​羊飼いが「狼！​狼！​」を叫んだからです）、​または、​医療検査に類似、​患者が誤って診断されたとき。

いくつかの関連する用語は、​「真陽性」、​「真陰性」、​と「偽陰性」です。​これらの用語が示す意味：​「真陽性」の意味は、​テスト結果と真の条件が真です（即ち、​「陽性」です）。​「真陰性」の意味は、​テスト結果と真の条件が偽です（即ち、​「陰性」です）。​「真陽性」と「真陰性」は「正しい推論」とみなされます。​「偽陽性」の反対は「偽陰性」です。​「偽陰性」の意味は、​テスト結果が偽です（即ち、​「陰性」です）、​しかし、​真の条件が本当に真です（即ち、​「陽性」です）；​両方テスト結果と真の条件、​が「真/陽性」すべきであるはずです。

phpMusselの文脈で、​これらの用語は、​phpMusselのシグネチャとそれらがブロックするファイルを指します。​phpMusselが誤ってファイルをブロックすると（例えば、​不正確なシグネチャ、​時代遅れのシグネチャなどによる）、​我々はこのイベント「偽陽性」のを呼び出します。​phpMusselがファイルをブロックできなかった場合（例えば、​予期せぬ脅威、​シグネチャの欠落などによる）、​我々はこのイベント「不在検出」のを呼び出します（「偽陰性」のアナログです）。

これは、​以下の表に要約することができます。

&nbsp; | phpMusselは、​ファイルをブロック必要がありません | phpMusselは、​ファイルをブロック必要があります
---|---|---
phpMusselは、​ファイルをブロックしません | 真陰性（正しい推論） | 不在検出（それは「偽陰性」と同じです）
phpMusselは、​ファイルをブロックします | __偽陽性__ | 真陽性（正しい推論）

#### <a name="SIGNATURE_UPDATE_FREQUENCY"></a>シグネチャはどれくらいの頻度でアップデイトされますか？

アップデイト頻度は、​シグネチャ・ファイルによって異なります。​phpMusselのシグネチャ・ファイルのすべてのメンテナーが頻繁にアップデイトを試みる、​しかし、​私たちの皆様には、​他にもさまざまなコミットメントがあり、​私たちはプロジェクトの外で生活しており、​と誰も財政的に補償されていない、​したがって、​正確なアップデイトスケジュールは保証されません。​一般に、​十分な時間があればシグネチャがアップデイトされます。​あなたが何かを提供できるのであれば、​援助は常に高く評価されます。

#### <a name="ENCOUNTERED_PROBLEM_WHAT_TO_DO"></a>phpMusselを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！

- あなたは最新のソフトウェアバージョンを使用していますか？​あなたは最新のシグネチャ・ファイルバージョンを使用していますか？​そうでない場合は、​まずすべてをアップデイトしてください。​問題が解決しないかどうかをチェックしてください。​それが続く場合は、​読んでください。
- あなたはドキュメンテーションをチェックしましたか？​もしそうでなければ、​そうしてください。​ドキュメンテーションを使用して問題を解決できない場合は、​引き続き読んでください。
- **[イシュー・ページ](https://github.com/phpMussel/phpMussel/issues)** をチェックしましたか？​問題が以前に言及されているかどうかをチェックしてください。​提案、​アイデア、​ソリューションが提供されたかどうかをチェックしてください。
- 問題が解決しない場合は、​教えてください。​イシュー・ページに関する新しいディスカッションを作成する。

#### <a name="MINIMUM_PHP_VERSION"></a>5.4.0より古いＰＨＰバージョンでphpMussel（v2より前）を使用したいと思います；​手伝ってくれますか？

いいえ。 PHP >= 5.4.0 は phpMussel < v2 の最小要件です。

#### <a name="MINIMUM_PHP_VERSION_V2"></a>7.2.0より古いＰＨＰバージョンでphpMussel（v2の場合）を使用したいと思います；​手伝ってくれますか？

いいえ。 PHP >= 7.2.0 は phpMussel v2 の最小要件です。

*参照：​[互換性チャート](https://maikuolan.github.io/Compatibility-Charts/)。*

#### <a name="PROTECT_MULTIPLE_DOMAINS"></a>複数のドメインを保護するために１つのphpMusselインストールを使用できますか？

はい。​phpMusselのインストールは特定のドメインに限定されていません、​したがって、​複数のドメインを保護するために使用できます。​一般的に、​１つのドメインのみを保護するインストール、​私たちは「単一ドメイン・インストール」と呼んでいますで、​複数のドメイン/サブドメインを保護するインストール、​私たちは「マルチドメイン・インストール」と呼んでいます。​マルチドメインインストールを使用している場合で、​異なるドメインに異なるシグネチャ・ファイルセットを使用する必要がある場合や、​異なるドメインにphpMusselを異なる設定する必要があります、​これを行うことができます。​コンフィグレーション・ファイルをロードした後（`config.ini`）、​phpMusselは、​要求されたドメインの「コンフィグレーション・オーバーライド・ファイル」の存在をチェックします (`xn--48jua8kwd4hof5er493ch97b.tld.config.ini`)、​そして見つかった場合、​コンフィグレーション・オーバーライド・ファイルによって定義されたコンフィグレーション値は、​コンフィグレーション・ファイルによって定義されたコンフィグレーション値ではなく、​実行インスタンスに使用されます。​コンフィグレーション・オーバーライド・ファイルは、​コンフィグレーション・ファイルと同じです。​お客様の裁量で、​phpMusselで利用可能なすべての設定指示句の全体または必要なサブセクションを含めることができます。​コンフィグレーション・オーバーライド・ファイルは彼らが意図しているドメインに従って命名されます （そう、​例えば、​ドメイン`http://www.some-domain.tld/`にコンフィグレーション・オーバーライド・ファイルが必要な場合は、​コンフィグレーション・オーバーライド・ファイルの名前は`some-domain.tld.config.ini`にする必要があります。​通常の設定ファイルと同じ場所に保存する必要があります）。​ドメイン名は `HTTP_HOST` から来ます。​"www"は無視されます。

#### <a name="PAY_YOU_TO_DO_IT"></a>私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？

多分。​これは、​ケースバイケースで検討されています。​あなたのニーズと提供できるものを教えてください。​私たちが助けることができるかどうかを教えてあげます。

#### <a name="HIRE_FOR_PRIVATE_WORK"></a>あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？

*上記を参照。​*

#### <a name="SPECIALIST_MODIFICATIONS"></a>私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？

*上記を参照。​*

#### <a name="ACCEPT_OR_OFFER_WORK"></a>私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？

はい。​私たちのライセンスはこれを禁止していません。

#### <a name="WANT_TO_CONTRIBUTE"></a>私はプロジェクトに貢献したい；​これはできますか？

はい。​プロジェクトへの貢献は大歓迎です。​詳細については、​「CONTRIBUTING.md」を参照してください。

#### <a name="SCAN_DEBUGGING"></a>ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？

これは、​phpMusselにそれらをスキャンするように指示する前に、​この目的のために使用する配列を割り当てることによって行うことができます。

以下の例では、​この目的のために`$Foo`が割り当てられています。​`/file/path/...`をスキャンした後、​`/file/path/...`のファイルに関する情報は`$Foo`にあります。

```PHP
<?php
require 'phpmussel/loader.php';

$phpMussel['Set-Scan-Debug-Array']($Foo);

$Results = $phpMussel['Scan']('/file/path/...');

var_dump($Foo);
```

配列は多次元です。​要素はスキャンされる各ファイルを表します。​サブ要素は、​これらのファイルの詳細を表します。​サブ要素は次のとおりです。

- Filename (`string`)
- FromCache (`bool`)
- Depth (`int`)
- Size (`int`)
- MD5 (`string`)
- SHA1 (`string`)
- SHA256 (`string`)
- CRC32B (`string`)
- 2CC (`string`)
- 4CC (`string`)
- ScanPhase (`string`)
- Container (`string`)
- † FileSwitch (`string`)
- † Is_ELF (`bool`)
- † Is_Graphics (`bool`)
- † Is_HTML (`bool`)
- † Is_Email (`bool`)
- † Is_MachO (`bool`)
- † Is_PDF (`bool`)
- † Is_SWF (`bool`)
- † Is_PE (`bool`)
- † Is_Not_HTML (`bool`)
- † Is_Not_PHP (`bool`)
- ‡ NumOfSections (`int`)
- ‡ PEFileDescription (`string`)
- ‡ PEFileVersion (`string`)
- ‡ PEProductName (`string`)
- ‡ PEProductVersion (`string`)
- ‡ PECopyright (`string`)
- ‡ PEOriginalFilename (`string`)
- ‡ PECompanyName (`string`)
- Results (`int`)
- Output (`string`)

*† - キャッシュされた結果は提供されません （新しいスキャン結果にのみ提供されます）。​*

*‡ - ＰＥファイルをスキャンするときにのみ提供されます。​*

必要に応じて、​この配列は以下を使用して破棄できます。

```PHP
$phpMussel['Destroy-Scan-Debug-Array']($Foo);
```

#### <a name="CRON_TO_UPDATE_AUTOMATICALLY"></a>Cronを使って自動的にアップデートできますか？

はい。​外部スクリプトを介してアップデート・ページと対話するためのＡＰＩがフロントエンドに組み込まれています。​別のスクリプト、「[Cronable](https://github.com/Maikuolan/Cronable)」、が利用可能です。​これは「cron manager （クロン・マネージャー）」や「cron scheduler （クロン・スケジューラ）」がこれと他のサポートされているパッケージを自動的に更新するために使うことができます（このスクリプトは独自のドキュメントを提供しています）。

#### <a name="SCAN_NON_ANSI"></a>phpMusselは、ＡＮＳＩ以外の名前のファイルをスキャンできますか？

スキャンするディレクトリがあるとします。​このディレクトリには、ＡＮＳＩ以外の名前のファイルがいくつかあります。
- `Пример.txt`
- `一个例子.txt`
- `例です.txt`

ＣＬＩモードまたはphpMussel APIを使用してスキャンしているとします。

一部のシステムで PHP < 7.1.0 を使用する場合、phpMusselはディレクトリをスキャンするときにこれらのファイルを表示またはスキャンすることができません。​空のディレクトリをスキャンすると、同じ結果が表示されます。

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

さらに、 PHP < 7.1.0 を使用する場合、ファイルを個別にスキャンすると次のような結果が得られます。

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > チェック中 'X:/directory/Пример.txt' (FN: b831eb8f):
 -> 不正ファイル！
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

または、これら：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > X:/directory/??????.txtはファイルでもディレクトリでもありません。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

これは、ＡＮＳＩ以外のファイル名が PHP 7.1.0 より前にどのように処理されるかが原因です。​この問題が発生した場合、解決策はPHPのインストールを更新することです。​PHP >= 7.1.0 の場合、非ＡＮＳＩファイル名はよりよく処理され、phpMusselはファイルを適切にスキャンできるはずです。

比較のため、PHP >= 7.1.0 を使用してディレクトリをスキャンしようとしたときの結果：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 -> チェック中 '\Пример.txt' (FN: b2ce2d31; FD: 27cbe813):
 --> 問題は検出されませんでした。
 -> チェック中 '\一个例子.txt' (FN: 50debed5; FD: 27cbe813):
 --> 問題は検出されませんでした。
 -> チェック中 '\例です.txt' (FN: ee20a2ae; FD: 27cbe813):
 --> 問題は検出されませんでした。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

ファイルを個別にスキャンしようとすると、次のようになります：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > チェック中 'X:/directory/Пример.txt' (FN: b831eb8f; FD: 27cbe813):
 -> 問題は検出されませんでした。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

#### <a name="BLACK_WHITE_GREY"></a>ブラックリスト – ホワイトリスト – グレーリスト – 彼らは何ですか？私はどのように使用しますか？

これらの用語は、異なる文脈で異なる意味を伝える。​phpMusselには、これらの用語が使用される３つのコンテキストが（ファイルサイズの応答、ファイルタイプの応答、シグネチャ・グレーリスト）あります。

処理コストを最小限に抑えて希望の結果を得るために、phpMusselがファイルを実際にスキャンする前に確認できる簡単な方法がいくつかあります（例えば；ファイルのサイズ、名前、および拡張子）。​例えば；ファイルが大きすぎる場合、またはその拡張子が私たちのウェブサイトに許可したくないファイルの種類を示している場合、すぐにファイルにフラグを立てることができますし、スキャンする必要はありません。

ファイルサイズの応答は、ファイルが指定された制限を超えたときにphpMusselが応答する方法です。​実際のリストは含まれていませんが、ファイルはそのサイズに基づいて、効果的にブラックリストに載っている、ホワイトリストに載っている、またはグレイリストに載ってと考えられます。​制限と望ましい応答をそれぞれ指定するために、２つの異なる設定オプションが存在します。

ファイルタイプの応答は、phpMusselがファイルの拡張子に応答する方法です。​どの拡張がブラックリスト、ホワイトリスト、またはグリットリストにあるべきかを明示的に指定するための3つの異なる設定オプションが存在します。​拡張子が指定された拡張子のいずれかにそれぞれ一致する場合、ファイルは有効にリストされていると見なされることがあります。

この２つのコンテキストがでは、ホワイトリストに載っているはスキャンまたはフラグ付けすべきではないことを意味します、ブラックリストに載っているはフラグ付けすべきですことを意味します（したがって、それをスキャンするすべきではない）そして、グレーリストに載っているは、フラグを立てる必要があるかどうかを判断するには、さらに分析が必要ですことを意味します（したがって、スキャンする必要があります）。

シグネチャ・グレーリストは本質的に無視すべきシグネチャのリストです（これについては、前述のドキュメントで簡単に説明しています）。​シグネチャはグレーリスト上のシグネチャがトリガーされると、phpMusselは私は仕事を続け、グレーリスト上のシグネチャに関して特別な処置をとりません。​暗黙の動作はトリガされたシグネチャの通常の動作であるため、シグネチャ・ブラックリストはありません。​この文脈では必要ではないので、シグネチャ・ホワイトリストはありません。

シグネチャ・ファイル全体をディセーブルまたはアンインストールせずに特定のシグネチャによって発生した問題を解決する必要がある場合は、シグネチャ・グレーリストが役立ちます。

#### <a name="CHANGE_COMPONENT_SORT_ORDER"></a>アップデート・ページでシグネチャ・ファイルを有効または無効にすると、コンフィギュレーションに英数字でソートされます。​彼らのソート方法を変更することはできますか？

はい。​特定の順序で実行するファイルが必要な場合は、コンフィギュレーション・ディレクティブの名前の前に任意のデータを追加できます（このデータと名前を区切るためにコロンを使用します）。​その後、アップデート・ページでファイルを再度並べ替えると、この追加された任意のデータがソート順に影響します。​これにより、それらの名前を変更せずに、必要な順序で実行されます。

たとえば、次のようにファイルをコンフィギュレーション・ディレクティブがあるとします：

`file1.php,file2.php,file3.php,file4.php,file5.php`

`file3.php`を最初に実行したければ、ファイル名の前に`aaa:`のようなものを追加することができます：

`file1.php,file2.php,aaa:file3.php,file4.php,file5.php`

次に、新しいファイル`file6.php`が有効になっている場合、アップデート・ページがそれらをすべて並べ替えると、次のようになります：

`aaa:file3.php,file1.php,file2.php,file4.php,file5.php,file6.php`

ファイルが非アクティブになったときと同じ状況です。​逆に、ファイルを最後に実行したい場合は、ファイルの名前の前に`zzz:`のようなものを追加することができます。​いずれの場合でも、問題のファイルの名前を変更する必要はありません。

---


### １１.<a name="SECTION11"></a>法律情報

#### 11.0 セクション・プリアンブル

ドキュメンテーションのこのセクションは、パッケージの使用と実装に関する法律上の考慮事項を説明し、基本的な関連情報を提供することを目的としています。​これは、操作している国に存在する可能性のある法的要件の遵守を確実にする手段として、一部のユーザーにとって重要な場合があります。​一部のユーザーは、この情報に従ってウェブサイトポリシーを調整する必要があります。

まず、私（パッケージ作成者）は弁護士ではない、有資格の法律専門家でもないことを認識してください。​したがって、私は法律上のアドバイスを提供する法的資格はありません。​また、場合によっては、正確な法的要件は、国や地域によって異なる場合があります。​また、これらが競合することがあります​（例えば：[プライバシーの権利](https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%90%E3%82%B7%E3%83%BC)を享受する国と[忘れられる権利](https://ja.wikipedia.org/wiki/%E5%BF%98%E3%82%8C%E3%82%89%E3%82%8C%E3%82%8B%E6%A8%A9%E5%88%A9)の場合には、拡張されたデータ保持を望む国と比較して）。​また、パッケージへのアクセスが特定の国や管轄区域に限定されているわけではないので、パッケージのユーザーベースは地理的に多様である可能性が高いと考えてください。​これらの点を考慮して、私はすべての点で、すべてのユーザーにとって「法的に準拠する」であることが何を意味するかを述べる立場にはいません。​ただし、ここに記載されている情報が、パッケージの文脈で法的に遵守するために必要な作業を自分で決定するのに役立つことを願っています。​疑義が存続する場合、または法的な観点から追加の助けと助言が必要な場合は、有資格の法律専門家に相談することをおすすめします。

#### 11.1 責任

パッケージ・ライセンスに記載されている通り、パッケージは無保証で提供されます。​これには、すべての責任範囲が含まれます（ただしこれに限定されません）。​あなたの便宜のためにパッケージが提供されています。​それが有用であり、それがあなたのためにいくつかの利益をもたらすことが期待されます。​しかし、あなたがパッケージを使用するか実装するかは、あなた自身の選択です。​あなたはパッケージを使用するよう強制されません。​しかし、あなたが決めるところでは、あなたはその決定に責任があります。​あなたの意思決定の結果について、私と他のパッケージ寄稿者は、直接的、間接的、暗示的、またはその他の方法にかかわらず、責任を負いません。

#### 11.2 第三者

その正確なコンフィギュレーションと実装に応じて、パッケージは場合によっては第三者と通信し、情報を共有することがあります。​この情報は、いくつかの国において、状況によっては、「[個人識別情報](https://ja.wikipedia.org/wiki/%E5%80%8B%E4%BA%BA%E6%83%85%E5%A0%B1)」（ＰＩＩ）と定義することができます。

これらの第三者がこの情報をどのように使用するかは、これらの第三者によって定められたさまざまなポリシーの対象となります。​このドキュメントの範囲外です。​ただし、このような場合は、これらの第三者との情報の共有を無効にすることができます。​そのような場合は、有効にすることを選択した場合、これらの第三者によるＰＩＩのプライバシー、セキュリティ、および使用に関する懸念事項を調査することは、おあなたの責任です。​ご不明な点がある場合、またはＰＩＩに関してこれらの第三者の行為に不満がある場合は、これらの第三者との情報の共有をすべて無効にすることが最善の方法です。

透明性のために、共有される情報のタイプと、誰と、以下に記載されています。

##### 11.2.0 ウェブフォンツ

phpMusselのフロントエンドと「アップロード拒否」ページの標準「ＵＩ」（ユーザー・インターフェイス）と同様に、一部のカスタム・テーマでは、美的な理由から「webfonts」（ウェブフォンツ）が使用されることがあります。​「Webfonts」（ウェブフォンツ）はデフォルトで無効になっていますが、有効にすると、ユーザーのブラウザと「webfont service」（ウェブフォント・サービス）間の直接通信が行われます。​これは、ユーザーのＩＰアドレス、ユーザー・エージェント、オペレーティング・システム、および要求に利用可能な他の詳細などの情報を伝達することを潜在的に含むことがある。​これらのウェブフォンツのほとんどは「[Google Fonts](https://fonts.google.com/)」サービスによってホストされています。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `disable_webfonts`

##### 11.2.1 ＵＲＬスキャナ

ファイルのアップロード内に見つかったＵＲＬは、パッケージ・コンフィギュレーションに応じて、hpHosts APIまたはGoogleセーフ・ブラウジングAPIと共有できます。​hpHosts APIの場合、この動作はデフォルトで有効になっています。​Googleセーフ・ブラウジングAPIは、正常に動作するためにはAPIキーが必要です。​したがって、デフォルトでは無効になっています。

*関連するコンフィギュレーション・ディレクティブ：*
- `urlscanner` -> `lookup_hphosts`
- `urlscanner` -> `google_api_key`

##### 11.2.2 VIRUS TOTAL （ウイルス・トータル）

phpMusselがファイルのアップロードをスキャンすると、そのように設定されていると、ファイルハッシュがVirus Total APIと共有される可能性があります。​将来、ある時点でファイル全体を共有できる計画がありますが、これはまだサポートされていません。​この機能を使用するには、ＡＰＩキーが必要です。

Virus Totalと共有される情報（ファイルおよび関連するファイルのメタデータを含む）は、研究目的で、パートナー、関連会社、その他さまざまな人々と共有することもできます。​これについては、プライバシー・ポリシーで詳しく説明しています。

*見る： [Privacy Policy &ndash; VirusTotal](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy)。*

*関連するコンフィギュレーション・ディレクティブ：*
- `virustotal` -> `vt_public_api_key`

#### 11.3 ロギング

ロギングは、多くの理由からphpMusselの重要な部分です。​ロギングせずに、偽陽性が発生した場合、それを診断して解決することは困難です。​ロギングせずに、phpMusselがいかに効果的に実行されているかを確かめること、その潜在的な問題を確認すること機能させるために必要なコンフィギュレーションやシグネチャの変更を決定するのが難しいことがあります。​いずれにせよ、ロギングは一部のユーザーには望ましくなく、完全にオプションです。​phpMusselでは、デフォルトでロギングは無効になっています。​これを有効にするには、それに応じてphpMusselを設定する必要があります。

ロギングが法的に許可されているかどうか、および法的に許容される範囲で​（例えば、ログに記録される可能性があるタイプの情報、期間、および状況）、​管轄区域およびphpMusselが実施されている状況に応じて変わる可能性がある​（例えば、あなたが個人として、企業として、商業的または非商業的に動作しているかどうか）。​したがって、このセクションを注意深く読んで役に立つかもしれない。

phpMusselが実行できる複数のタイプのロギングがあります。​異なるタイプのロギングには、さまざまな理由で異なるタイプの情報が含まれます。

##### 11.3.0 スキャン・ログ

パッケージ・コンフィギュレーションで有効にすると、phpMusselはスキャンするファイルのログを保持します。​このタイプのロギングは、２つの異なる形式で使用できます：
- 人間が読めるログ・ファイル。
- シリアライズされたログ・ファイル。

人間が読めるログ・ファイルに記録されたブロック・イベントは、通常次のようになります（例として）：

```
Mon, 21 May 2018 00:47:58 +0800 開始しています。
> チェック中 'ascii_standard_testfile.txt' (FN: ce76ae7a; FD: 7b9bfed5):
-> phpMussel-Testfile.ASCII.Standardを検出しました！
Mon, 21 May 2018 00:48:04 +0800 完了。
```

スキャン・ログ・エントリには、通常、次の情報が含まれます：
- ファイルがスキャンされた日時。
- スキャンしたファイルの名前。
- ファイル名と内容の「CRC32b」ハッシュ。
- ファイル内で何が検出されたか（何かが検出された場合）。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `scan_log`
- `general` -> `scan_log_serialized`

これらのディレクティブを空のままにすると、このタイプのロギングは無効のままです。

##### 11.3.1 スキャン・キル

パッケージ・コンフィギュレーションで有効にすると、phpMusselはブロックされたアップロードのログを保持します。

「スキャン・キル」ログ・ファイルへのエントリは、通常、次のようになります（例として）：

```
日時: Mon, 21 May 2018 00:47:56 +0800
ＩＰアドレス: 127.0.0.1
== スキャン結果（なぜそれが識別されるのか） ==
phpMussel-Testfile.ASCII.Standard (ascii_standard_testfile.txt)を検出しました！
== ハッシュ・シグネチャの再構築 ==
3ed8a00c6c498a96a44d56533806153c:666:ascii_standard_testfile.txt
「/vault/quarantine/0000000000-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.qfu」として隔離。
```

「スキャン・キル」エントリには、通常、以下の情報が含まれます。
- アップロードがブロックされた日時。
- アップロード元のＩＰアドレス。
- ファイルがブロックされた理由（検出されたもの）。
- ブロックされたファイルの名前。
- ブロックされたファイルのＭＤ５とサイズ。
- ファイルが隔離されているかどうか、どのような名前が内部の使用されます。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `scan_kills`

##### 11.3.2 フロントエンド・ロギング

このロギングは、フロントエンドのログイン試行に関係します。​これは、ユーザーがフロントエンドにログインしようとするとき、およびフロントエンド・アクセスが有効な場合にのみ発生します。

フロントエンドのログ・エントリには、ログインしようとしているユーザーのＩＰアドレス、試行が行われた日時、試行の結果が含まれます（正常にログインしたか、ログインに失敗しました）。​フロントエンドのログ・エントリは通常、次のようになります（例として）。

```
x.x.x.x - Day, dd Mon 20xx hh:ii:ss +0000 - "admin" - ログインしました。
```

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `frontend_log`

##### 11.3.3 ログ・ローテーション

一定期間後にログをパージしたい場合や、法律によってログをパージする必要がある場合があります（例えば、ログを保持することが法的に許可される時間は、法律によって制限される場合があります）。​ログ・ローテーションを使用すると、指定された制限を超えるとログ・ファイルに対して何らかのアクションを実行できます。​パッケージ・コンフィギュレーションで指定されたログ・ファイルの名前に日付/時刻マーカーを含めることし（例えば、`{yyyy}-{mm}-{dd}.log`）、ログ・ローテーションを有効にするで、これを行うことができます。

例えば：法的に３０日後にログを削除する必要がある場合は、ログ・ファイルの名前に`{dd}.log`を（`{dd}`は日を表す）指定し、`log_rotation_limit`の値を`30`に設定し、`log_rotation_action`の値を`Delete`に設定することができます。

逆に、長期間ログを保持する必要がある場合は、ログ・ローテーションを無効にするか、ログ・ファイルを圧縮するために`log_rotation_action`の値を`Archive`に設定することができます（占有するディスク・スペースの総量が削減されます）。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `log_rotation_limit`
- `general` -> `log_rotation_action`

##### 11.3.4 ログ切り捨て

必要に応じて、特定のサイズを超えた個々のログ・ファイルを切り捨てることができます。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `truncate`

##### 11.3.5 ＩＰアドレス・スドニマイゼーション

まず、あなたが用語に精通していない場合：​「スドニマイゼーション」（pseudonymisation）とは、補足情報なしで特定のデータ対象に特定できないような個人データの処理を指します​（ただし、そのような補足情報は、個人データが自然人に特定されないことを保証するために、個別に維持され、技術的および組織的措置を受けるものとします）。

次のリソースは詳細情報を提供します。
- [[trust-hub.com] What is pseudonymisation?](https://www.trust-hub.com/news/what-is-pseudonymisation/)
- [[Wikipedia] Pseudonymization](https://en.wikipedia.org/wiki/Pseudonymization)

場合によっては、収集、処理、または保存されたＰＩＩに対して「アノニマイゼーション」または「スドニマイゼーション」を実施することが法的に要求されることがあります。​このコンセプトはかなり以前から存在していましたが、ＧＤＰＲ/ＤＳＶＧＯは「スドニマイゼーション」を特に言及し、奨励しています。

必要に応じて、phpMusselはＩＰアドレスを記録するときにこれを行うことができます。​ログに記録されると、ＩＰｖ４アドレスの最後のオクテット、およびＩＰｖ６アドレスの２番目の部分の後のすべてが、「x」として表される。​これは、本質的には、ＩＰｖ４アドレスを２４番目のサブネット・ファクタの最初のアドレスに丸め、ＩＰｖ６アドレスを３２番目のサブネット・ファクタの最初のアドレスに丸めます。

*関連するコンフィギュレーション・ディレクティブ：*
- `legal` -> `pseudonymise_ip_addresses`

##### 11.3.6 統計 （スタティスティックス）

phpMusselは、オプションで、特定の時間以降にスキャンおよびブロックされたファイルの総数などの統計を追跡できます。​この機能はデフォルトで無効になっていますが、パッケージ・コンフィギュレーションで有効にすることができます。​追跡される情報のタイプはＰＩＩと見なすべきではない。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `statistics`

##### 11.3.7 暗号化 （エンクリプション）

phpMusselは、キャッシュまたはログ情報を[暗号化](https://ja.wikipedia.org/wiki/%E6%9A%97%E5%8F%B7)しません。​キャッシュとログの暗号化は、将来導入される可能性がありますが、現在のところ具体的な計画はありません。​権限のない第三者によるＰＩＩへのアクセスについて（例えば、キャッシュ、ログ）：​phpMusselは、一般にアクセス可能な場所にはインストールしないことをお勧めします（例えば、ほとんどのウェブサーバーで使用できる標準の`public_html`ディレクトリの外にphpMusselをインストールする）、​そして適切に制限された権限が強制されるようにする（特に、「vault」ディレクトリ）。​懸念が残っている場合は、phpMusselを設定して、この情報が収集または記録されないようにすることができます​（例えば、ロギングを無効にするなど）。

#### 11.4 COOKIES （クッキー）

ユーザーがフロントエンドに正常にログインすると、phpMusselは後続のリクエストのためにユーザーを覚えておくために[Cookie](https://ja.wikipedia.org/wiki/HTTP_cookie)を設定します（すなわち、Cookieはユーザーをログインセッションに認証するために使用されます）。​ログイン・ページでは、Cookieの警告が目立つように表示され、関連する操作を行った場合にCookieが設定されることをユーザーに警告します。​Cookieは、コードベースの他のどの場所にも設定されていません。

*関連するコンフィギュレーション・ディレクティブ：*
- `general` -> `disable_frontend`

#### 11.5 マーケティングやアドバタイジング

phpMusselは、マーケティングやアドバタイジング目的で情報を収集または処理しません。​収集または記録された情報を販売したり、利益を得たりすることはありません。​phpMusselは商業的企業ではなく、商業的利益には関係しないので、これらのことは意味をなさないでしょう。​これは、プロジェクトの開始以来のケースであり、今日も引き続き行われています。​さらに、これらのことを行うことは、プロジェクトの精神と目的に沿ったものではなく、私がプロジェクトを維持し続ける限り、決して起こらないでしょう。

#### 11.6 プライバシー・ポリシー

場合によっては、ウェブサイトのすべてのページとセクションにプライバシー・ポリシーへのリンクを明確に表示することが法的に要求されることがあります。​これは、ユーザーが正確なプライバシー・プラクティス、収集するＰＩＩのタイプ、および使用する方法を十分に知らされていることを保証する手段として重要です。​このようなリンクをphpMusselの「アップロード拒否」ページに含めるには、プライバシー・ポリシーのＵＲＬを指定するためのコンフィギュレーション・ディレクティブが用意されています。

*関連するコンフィギュレーション・ディレクティブ：*
- `legal` -> `privacy_policy`

#### 11.7 GDPR/DSGVO

一般データ保護規制（ＧＤＰＲ）は、2018年5月25日に発効するＥＵの規制です。​規制の第一の目的は、ＥＵ市民および居住者に個人情報を管理させ、個人情報および個人情報に関するＥＵ内の規制を統一することです。

この規制には、ＥＵ（欧州連合）の「データ主体」（識別された、または識別可能な自然人）の「[個人識別情報](https://ja.wikipedia.org/wiki/%E5%80%8B%E4%BA%BA%E6%83%85%E5%A0%B1)」（ＰＩＩ）の処理に関する特定の規定が含まれています。​規制に準拠するためには、「企業」（規制によって定義されている）、関連するシステムおよびプロセスは、デフォルトで「<a href="https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%90%E3%82%B7%E3%83%BC%E3%83%90%E3%82%A4%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3">プライバシー・バイ・デザイン</a>」を実装する必要があります、最高のプライバシー設定を使用する必要があります、格納された情報または処理された情報のためにセーフガードを実装する必要があります（「スドニマイゼーション」の実装またはデータの完全な「アノニマイゼーション」を含むがこれらに限定されません）、収集するデータの種類、処理方法、理由、保持期間、および第三者とこのデータを共有するかどうかを明確かつ明白に宣言する必要があります、第三者と共有されるデータの種類、方法、理由などが含まれます。

規制によって定義されているように、合法的な根拠がない限り、データを処理することはできません。​一般的に、これは、合法的な基準でデータ対象のデータを処理するためには、法的義務を遵守しなければならないを意味します、または明示され、十分に情報があり、明白な同意がデータ対象から得られた後にのみ行われる。

規制のいくつかの側面は時間とともに変化する可能性があります。​時代遅れの情報が広がらないようにするには、関係する情報をここに入れるのではなく、正式な情報源から規制について学ぶ方が良いでしょう（ここに含まれる情報が古くなる可能性があります）。

より多くの情報を習得するための推奨リソース：
- [GDPR（EU一般データ保護規制）とは | 語句説明・適用範囲・与える影響を解説](https://boxil.jp/mag/a4605/)
- [EU一般データ保護規則](https://ja.wikipedia.org/wiki/EU%E4%B8%80%E8%88%AC%E3%83%87%E3%83%BC%E3%82%BF%E4%BF%9D%E8%AD%B7%E8%A6%8F%E5%89%87)
- [GDPR（EU一般データ保護規制）対策](https://eizone.info/gdpr/)
- [REGULATION (EU) 2016/679 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32016R0679)
- [GDPRの対象となる個人データとは](https://www.eyjapan.jp/services/advisory/column/2017-06-06.html)

---


最終アップデート：２０１９年９月２３日。
